<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">
<head>
<meta charset="UTF-8" />
<title>LDAP : Installation et configuration d'un Annuaire LDAP - Deimos.fr / Bloc Notes Informatique</title>
<meta name="generator" content="MediaWiki 1.25.5" />
<link rel="shortcut icon" href="https://wiki.deimos.fr/favicon.ico" />
<link rel="search" type="application/opensearchdescription+xml" href="opensearch_desc.php" title="Deimos.fr / Bloc Notes Informatique (en)" />
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.deimos.fr/api.php?action=rsd" />
<link rel="alternate" hreflang="x-default" href="./LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html" />
<link rel="copyright" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.fr" />
<link rel="alternate" type="application/atom+xml" title="Deimos.fr / Bloc Notes Informatique Atom feed" href="https://wiki.deimos.fr/index.php?title=Special:RecentChanges&amp;feed=atom" />
<link rel="stylesheet" href="load.php%3Fdebug=false&amp;lang=en&amp;modules=ext.cite.styles|mediawiki.legacy.commonPrint,shared|mediawiki.sectionAnchor|mediawiki.skinning.interface|mediawiki.ui.button|skins.vector.styles&amp;only=styles&amp;skin=vector&amp;*.css" />
<meta name="ResourceLoaderDynamicStyles" content="" />
<link rel="stylesheet" href="load.php%3Fdebug=false&amp;lang=en&amp;modules=site&amp;only=styles&amp;skin=vector&amp;*.css" />
<style>a:lang(ar),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}
/* cache key: blocnotesinfo-wiki_:resourceloader:filter:minify-css:7:6f8c0c45eefd74c7bbe9478b32df38c0 */</style>
<script src="load.php%3Fdebug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=vector&amp;*"></script>
<script>if(window.mw){
mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP","wgTitle":"LDAP : Installation et configuration d'un Annuaire LDAP","wgCurRevisionId":12270,"wgRevisionId":12270,"wgArticleId":1847,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["LDAP","Serveur"],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP","wgRelevantArticleId":1847,"wgIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgWikiEditorEnabledModules":{"toolbar":true,"dialogs":true,"hidesig":true,"preview":true,"publish":false}});
}</script><script>if(window.mw){
mw.loader.implement("user.options",function($,jQuery){mw.user.options.set({"variant":"en"});});mw.loader.implement("user.tokens",function($,jQuery){mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\"});});
/* cache key: blocnotesinfo-wiki_:resourceloader:filter:minify-js:7:a5c52c063dc436c1ca7c9f456936a5e9 */
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.page.startup","mediawiki.legacy.wikibits","mediawiki.legacy.ajax","skins.vector.js"]);
}</script>
<style type="text/css">/*<![CDATA[*/
.source-text {line-height: normal;}
.source-text li, .source-text pre {
	line-height: normal; border: 0px none white;
}
/**
 * GeSHi Dynamically Generated Stylesheet
 * --------------------------------------
 * Dynamically generated stylesheet for text
 * CSS class: source-text, CSS id: 
 * GeSHi (C) 2004 - 2007 Nigel McNie, 2007 - 2008 Benny Baumann
 * (http://qbnz.com/highlighter/ and http://geshi.org/)
 * --------------------------------------
 */
.text.source-text .de1, .text.source-text .de2 {font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;font-family: monospace, monospace;}
.text.source-text  {font-family:monospace;}
.text.source-text .imp {font-weight: bold; color: red;}
.text.source-text li, .text.source-text .li1 {font-weight: normal; vertical-align:top;}
.text.source-text .ln {width:1px;text-align:right;margin:0;padding:0 2px;vertical-align:top;}
.text.source-text .li2 {font-weight: bold; vertical-align:top;}
.text.source-text .ln-xtra, .text.source-text li.ln-xtra, .text.source-text div.ln-xtra {background-color: #ffc;}
.text.source-text span.xtra { display:block; }

/*]]>*/
</style>
<!--[if lt IE 7]><style type="text/css">body{behavior:url("/skins/Vector/csshover.min.htc")}</style><![endif]-->
</head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-LDAP_Installation_et_configuration_d_un_Annuaire_LDAP skin-vector action-view vector-animateLayout">
		<div id="mw-page-base" class="noprint"></div>
		<div id="mw-head-base" class="noprint"></div>
		<div id="content" class="mw-body" role="main">
			<a id="top"></a>

						<h1 id="firstHeading" class="firstHeading" lang="en"><span dir="auto">LDAP : Installation et configuration d'un Annuaire LDAP</span></h1>
						<div id="bodyContent" class="mw-body-content">
									<div id="siteSub">From Deimos.fr / Bloc Notes Informatique</div>
								<div id="contentSub"></div>
												<div id="jump-to-nav" class="mw-jump">
					Jump to:					<a href="./LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html#mw-navigation">navigation</a>, 					<a href="./LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html#p-search">search</a>
				</div>
				<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="./LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html#Introduction"><span class="tocnumber">1</span> <span class="toctext">Introduction</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="./LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html#Installation"><span class="tocnumber">2</span> <span class="toctext">Installation</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="./LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html#Configuration"><span class="tocnumber">3</span> <span class="toctext">Configuration</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="./LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html#slapd.conf"><span class="tocnumber">3.1</span> <span class="toctext">slapd.conf</span></a>
<ul>
<li class="toclevel-3 tocsection-5"><a href="./LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html#M.C3.A9thode_r.C3.A9cente"><span class="tocnumber">3.1.1</span> <span class="toctext">Méthode récente</span></a></li>
<li class="toclevel-3 tocsection-6"><a href="./LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html#Ancienne_m.C3.A9thode"><span class="tocnumber">3.1.2</span> <span class="toctext">Ancienne méthode</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-7"><a href="./LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html#LDIF"><span class="tocnumber">3.2</span> <span class="toctext">LDIF</span></a>
<ul>
<li class="toclevel-3 tocsection-8"><a href="./LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html#Importer_un_sch.C3.A9ma"><span class="tocnumber">3.2.1</span> <span class="toctext">Importer un schéma</span></a></li>
<li class="toclevel-3 tocsection-9"><a href="./LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html#Importer_des_enregistrements"><span class="tocnumber">3.2.2</span> <span class="toctext">Importer des enregistrements</span></a></li>
<li class="toclevel-3 tocsection-10"><a href="./LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html#Modifier_des_enregistrements"><span class="tocnumber">3.2.3</span> <span class="toctext">Modifier des enregistrements</span></a></li>
<li class="toclevel-3 tocsection-11"><a href="./LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html#Supprimer_des_enregistrements"><span class="tocnumber">3.2.4</span> <span class="toctext">Supprimer des enregistrements</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-12"><a href="./LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html#Rechercher_des_enregistrements"><span class="tocnumber">4</span> <span class="toctext">Rechercher des enregistrements</span></a></li>
<li class="toclevel-1 tocsection-13"><a href="./LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html#Sauvegarde_d.E2.80.99une_base_de_donn.C3.A9es_LDAP"><span class="tocnumber">5</span> <span class="toctext">Sauvegarde d’une base de données LDAP</span></a></li>
<li class="toclevel-1 tocsection-14"><a href="./LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html#Restaurer_une_base_LDAP"><span class="tocnumber">6</span> <span class="toctext">Restaurer une base LDAP</span></a></li>
<li class="toclevel-1 tocsection-15"><a href="./LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html#Scripts_PHP"><span class="tocnumber">7</span> <span class="toctext">Scripts PHP</span></a></li>
<li class="toclevel-1 tocsection-16"><a href="./LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html#Liste_partielle_d.27attributs"><span class="tocnumber">8</span> <span class="toctext">Liste partielle d'attributs</span></a>
<ul>
<li class="toclevel-2 tocsection-17"><a href="./LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html#Classe_organization"><span class="tocnumber">8.1</span> <span class="toctext">Classe organization</span></a></li>
<li class="toclevel-2 tocsection-18"><a href="./LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html#Classe_inetOrgPerson"><span class="tocnumber">8.2</span> <span class="toctext">Classe inetOrgPerson</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-19"><a href="./LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html#Clients"><span class="tocnumber">9</span> <span class="toctext">Clients</span></a>
<ul>
<li class="toclevel-2 tocsection-20"><a href="./LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html#Installation_2"><span class="tocnumber">9.1</span> <span class="toctext">Installation</span></a>
<ul>
<li class="toclevel-3 tocsection-21"><a href="./LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html#Debian"><span class="tocnumber">9.1.1</span> <span class="toctext">Debian</span></a></li>
<li class="toclevel-3 tocsection-22"><a href="./LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html#Red_Hat"><span class="tocnumber">9.1.2</span> <span class="toctext">Red Hat</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-23"><a href="./LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html#Configuration_2"><span class="tocnumber">9.2</span> <span class="toctext">Configuration</span></a>
<ul>
<li class="toclevel-3"><a href="./LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html#Debian_2"><span class="tocnumber">9.2.1</span> <span class="toctext">Debian</span></a>
<ul>
<li class="toclevel-4"><a href="./LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html#libpam-ldapd"><span class="tocnumber">9.2.1.1</span> <span class="toctext">libpam-ldapd</span></a></li>
<li class="toclevel-4"><a href="./LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html#libpam-ldap"><span class="tocnumber">9.2.1.2</span> <span class="toctext">libpam-ldap</span></a></li>
<li class="toclevel-4"><a href="./LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html#libpam-ldapd_et_libpam-ldap"><span class="tocnumber">9.2.1.3</span> <span class="toctext">libpam-ldapd et libpam-ldap</span></a></li>
<li class="toclevel-4"><a href="./LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html#Autoriser_un_groupe_LDAP_en_particulier"><span class="tocnumber">9.2.1.4</span> <span class="toctext">Autoriser un groupe LDAP en particulier</span></a>
<ul>
<li class="toclevel-5"><a href="./LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html#Debian_3"><span class="tocnumber">9.2.1.4.1</span> <span class="toctext">Debian</span></a></li>
<li class="toclevel-5"><a href="./LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html#Red_Hat_2"><span class="tocnumber">9.2.1.4.2</span> <span class="toctext">Red Hat</span></a></li>
<li class="toclevel-5"><a href="./LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html#Configuration_3"><span class="tocnumber">9.2.1.4.3</span> <span class="toctext">Configuration</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-3"><a href="./LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html#Red_Hat_3"><span class="tocnumber">9.2.2</span> <span class="toctext">Red Hat</span></a>
<ul>
<li class="toclevel-4"><a href="./LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html#M.C3.A9thode_1"><span class="tocnumber">9.2.2.1</span> <span class="toctext">Méthode 1</span></a></li>
<li class="toclevel-4"><a href="./LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html#M.C3.A9thode_2"><span class="tocnumber">9.2.2.2</span> <span class="toctext">Méthode 2</span></a></li>
</ul>
</li>
<li class="toclevel-3"><a href="./LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html#Forcer_un_shell_au_login"><span class="tocnumber">9.2.3</span> <span class="toctext">Forcer un shell au login</span></a></li>
<li class="toclevel-3"><a href="./LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html#Solaris"><span class="tocnumber">9.2.4</span> <span class="toctext">Solaris</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-24"><a href="./LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html#FAQ"><span class="tocnumber">10</span> <span class="toctext">FAQ</span></a>
<ul>
<li class="toclevel-2 tocsection-25"><a href="./LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html#Comment_d.C3.A9bugger_.3F"><span class="tocnumber">10.1</span> <span class="toctext">Comment débugger&#160;?</span></a></li>
<li class="toclevel-2 tocsection-26"><a href="./LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html#ldap_bind:_Invalid_credentials_.2849.29"><span class="tocnumber">10.2</span> <span class="toctext">ldap_bind: Invalid credentials (49)</span></a></li>
<li class="toclevel-2 tocsection-27"><a href="./LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html#ldap_add:_Naming_violation_.2864.29"><span class="tocnumber">10.3</span> <span class="toctext">ldap_add: Naming violation (64)</span></a></li>
<li class="toclevel-2 tocsection-28"><a href="./LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html#operation_not_permitted_during_recovery"><span class="tocnumber">10.4</span> <span class="toctext">operation not permitted during recovery</span></a></li>
<li class="toclevel-2 tocsection-29"><a href="./LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html#Purger_les_logs"><span class="tocnumber">10.5</span> <span class="toctext">Purger les logs</span></a>
<ul>
<li class="toclevel-3 tocsection-30"><a href="./LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html#M.C3.A9thode_automatique"><span class="tocnumber">10.5.1</span> <span class="toctext">Méthode automatique</span></a></li>
<li class="toclevel-3 tocsection-31"><a href="./LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html#M.C3.A9thode_manuelle"><span class="tocnumber">10.5.2</span> <span class="toctext">Méthode manuelle</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-32"><a href="./LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html#Vider_le_cache"><span class="tocnumber">10.6</span> <span class="toctext">Vider le cache</span></a></li>
<li class="toclevel-2 tocsection-33"><a href="./LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html#err_-30978._Restore_from_backup"><span class="tocnumber">10.7</span> <span class="toctext">err -30978. Restore from backup</span></a></li>
<li class="toclevel-2 tocsection-34"><a href="./LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html#LDAP_search_descriptors_and_.E2.80.98user_attr.E2.80.99"><span class="tocnumber">10.8</span> <span class="toctext">LDAP search descriptors and ‘user_attr’</span></a></li>
<li class="toclevel-2 tocsection-35"><a href="./LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html#ldap_add:_No_such_object_.2832.29"><span class="tocnumber">10.9</span> <span class="toctext">ldap_add: No such object (32)</span></a></li>
<li class="toclevel-2 tocsection-36"><a href="./LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html#ldap_add:_Constraint_violation_.2819.29"><span class="tocnumber">10.10</span> <span class="toctext">ldap_add: Constraint violation (19)</span></a></li>
<li class="toclevel-2 tocsection-37"><a href="./LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html#.3C.3D_bdb_equality_candidates:_.28uid.29_not_indexed"><span class="tocnumber">10.11</span> <span class="toctext">&lt;= bdb_equality_candidates: (uid) not indexed</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-38"><a href="./LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html#References"><span class="tocnumber">11</span> <span class="toctext">References</span></a></li>
</ul>
</div>

<table class="config_array" align="right" style="width:20em; font-size:90%; text-align:left; border: 1px #d0e7ff solid; margin-left:10px;">
   <tr>
      <td class="config_subarray" colspan="2" style="text-align:center;"><a href="./File:OpenLDAP-logo.png.html" class="image" title="OpenLDAP"><img alt="OpenLDAP" src="images/c/c7/OpenLDAP-logo.png" width="220" height="87" /></a></td>
   </tr><tr><td colspan="2" style="text-align:center;"><hr class="gradient" /></td></tr><tr>
      <th>Software version</th>
      <td>2.4.23+</td>
   </tr><tr>
      <th>Operating System</th>
      <td>Debian 6</td>
   </tr><tr>
      <th>Website</th>
      <td><a rel="nofollow" class="external text" href="http://www.openldap.org/">OpenLDAP Website</a></td>
   </tr><tr>
      <th>Last Update</th>
      <td>28/03/2013</td>
   </tr><tr>
      <th>Others</th>
      <td></td>
   </tr>
</table>
<h1><span class="mw-headline" id="Introduction"><span class="mw-headline-number">1</span> Introduction</span></h1>
<p><a rel="nofollow" class="external text" href="http://fr.wikipedia.org/wiki/LDAP">Lightweight Directory Access Protocol (LDAP)</a> est un protocole permettant l'interrogation et la modification des services d'annuaire. Ce protocole repose sur TCP/IP. Un annuaire LDAP respecte généralement le modèle X.500 édicté par l'UIT-T&#160;: c'est une structure arborescente dont chacun des nœuds est constitué d'attributs associés à leurs valeurs.
</p><p>Le nommage des éléments constituant l'arbre (racine, branches, feuilles) reflète souvent le modèle politique, géographique ou organisationnel de la structure representée. La tendance actuelle est d'utiliser le nommage DNS pour les éléments de base de l'annuaire (racine et premières branches). Les branches plus profondes de l'annuaire peuvent représenter des personnes (people), des unités organisationnelles (organizational units), des groupes (groups), ...
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">           dc=fr
             |
         dc=example
        /          \
  ou=people     ou=groups</pre></div></div>
<h1><span class="mw-headline" id="Installation"><span class="mw-headline-number">2</span> Installation</span></h1>
<p>Pour installer OpenLDAP&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> </font>
</td></tr>
<tr>
<td>
<pre>apt-get install ldap-server ldap-client
</pre>
</td></tr></table><br />
<p>Ceci va nous installer&#160;:
</p>
<ul><li> ldap-utils</li>
<li> slapd</li>
<li> libiodbc2</li>
<li> libldap-2.3-0</li></ul>
<h1><span class="mw-headline" id="Configuration"><span class="mw-headline-number">3</span> Configuration</span></h1>
<h2><span class="mw-headline" id="slapd.conf"><span class="mw-headline-number">3.1</span> slapd.conf</span></h2>
<h3><span class="mw-headline" id="M.C3.A9thode_r.C3.A9cente"><span class="mw-headline-number">3.1.1</span> Méthode récente</span></h3>
<p>Voici la méthode récente<sup id="cite_ref-1" class="reference"><a href="./LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html#cite_note-1">[1]</a></sup> pour configurer votre OpenLDAP (enfin...le début)&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> dpkg-reconfigure</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">dpkg-reconfigure -plow slapd</pre></div></div>
</td></tr></table><br />
<p>Suivez ensuite les instructions
</p>
<h3><span class="mw-headline" id="Ancienne_m.C3.A9thode"><span class="mw-headline-number">3.1.2</span> Ancienne méthode</span></h3>
<p>Tout d'abord, nous allons générer un mot de passe crypté car nous allons avoir besoin de le mettre dans le fichier de configuration. Nous avons le choix de le mettre également en clair, mais pour des raisons de sécurité, il sera crypté&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> slappasswd</font>
</td></tr>
<tr>
<td>
<pre># slappasswd
New password:
Re-enter new password:
<b>{SSHA}5y67xJ/t7esuGKUD7TQPcgykd8xiYMO2</b>
</pre>
</td></tr></table><br />
<p>Copiez la dernière ligne <b>{SSHA}5y67x...</b> qui correspond au mot de passe crypté. Ici le mot de passe est <b>admin</b>.<br />
Editez le fichier /etc/ldap/slapd.conf&#160;:
</p>
<table width="100%" class="config_array">
<tr>
<td class="config_subarray"> <font size="-1"><a href="./File:Configuration_file.png.html" class="image" title="Configuration File"><img alt="Configuration File" src="images/a/a6/Configuration_file.png" width="32" height="32" /></a> /etc/ldap/slapd.conf</font>
</td></tr>
<tr>
<td>
<pre># La ligne suivante permet d’autoriser l’utilisation de la norme V2 de LDAP&#160;:
allow bind_v2

# La ligne suivante donne la racine de la base LDAP
suffix "dc=<b>deimos</b>,dc=<b>fr</b>"

# La ligne suivante qu’il faut ajouter manuellement donne le login de l’administrateur (<b>admin</b> avec le rappel de la racine).
# Cette ligne et la suivante sont obligatoires pour avoir un accès root sur la base depuis un programme externe (ex&#160;: PHP)
rootdn "cn=<b>admin</b>,dc=<b>deimos</b>,dc=<b>fr</b>"

# Collez le mot de passe que nous avons généré tout à l'heure&#160;:
# Admin password for OpenLDAP
rootpw <b>{SSHA}5y67xJ/t7esuGKUD7TQPcgykd8xiYMO2</b>

# Paramétrage de l’accès en écriture de la base. Il faut indiquer le bon login et la racine de la base&#160;:
access to attrs=userPassword,shadowLastChange
       by dn="cn=<b>admin</b>,dc=<b>deimos</b>,dc=<b>fr</b>" write
       by anonymous auth
       by self write
       by * none

#Paramétrage de l’accès en lecture seule de la base. Il faut indiquer le bon login et la racine de la base&#160;:
access to *
       by dn="cn=<b>admin</b>,dc=<b>deimos</b>,dc=<b>fr</b>" write
       by * read
</pre>
</td></tr></table><br />
<p>Maintenant, pour que la configuration soit prise en compte, nous allons redémarrer le serveur&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> </font>
</td></tr>
<tr>
<td>
<pre>/etc/init.d/slapd restart
</pre>
</td></tr></table><br />
<h2><span class="mw-headline" id="LDIF"><span class="mw-headline-number">3.2</span> LDIF</span></h2>
<p>Ce format de fichier est utilisé pour faire des imports / exports entre plusieurs bases ou pour modifier ou ajouter des données dans une base.
</p><p><b>ATTENTION&#160;: Il est obligatoire de coder les données en UTF-8. Si lors de l’importation une erreur est rencontrée, celle-ci est abandonnée à l’endroit où elle en était.</b>
</p>
<h3><span class="mw-headline" id="Importer_un_sch.C3.A9ma"><span class="mw-headline-number">3.2.1</span> Importer un schéma</span></h3>
<p>Voici la structure d’un fichier LDIF&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">dn: &lt;distinguished name
   objectClass: &lt;object class
   objectClass: &lt;object class
   ...
   &lt;attribute type:&lt;attribute value
   &lt;attribute type:&lt;attribute value
   ...</pre></div></div>
<p>Voici un exemple de fichier LDIF "<b>AjoutRacine.ldif</b>" pour créer la racine de l’arbre LDAP&#160;:
</p>
<pre>dn: dc=<b>deimos</b>,dc=<b>fr</b>
objectClass: dcObject
objectClass: organization
o: deimos Corporation
dc: <b>deimos</b>
</pre>
<p>Commande pour ajouter la racine&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> ldapadd</font>
</td></tr>
<tr>
<td>
<pre>ldapadd -x -D "cn=<b>admin</b>,dc=<b>deimos</b>,dc=<b>fr</b>" -w <b>admin</b> -f <b>AjoutRacine.ldif</b>
</pre>
</td></tr></table><br />
<p>Vous pouvez également ne pas écrire en clair le mot de passe en demandant le prompt&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> ldapadd</font>
</td></tr>
<tr>
<td>
<pre>ldapadd -x -D "cn=<b>admin</b>,dc=<b>deimos</b>,dc=<b>fr</b>" -W -f <b>AjoutRacine.ldif</b>
</pre>
</td></tr></table><br />
<p>Voici un exemple de fichier LDIF "<b>AjoutFiche.ldif</b>" pour créer une nouvelle fiche&#160;:
</p>
<pre>dn: cn=Pierre MAVRO,dc=deimos,dc=fr
objectClass: inetOrgPerson
cn: Pierre MAVRO
givenName: Pierre
sn: MAVRO
</pre>
<p>Certains champs du slapcat ne doivent figurer sous peine d'avoir l'erreur <a href="./LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html#ldap_add:_Constraint_violation_.2819.29">19</a><sup id="cite_ref-2" class="reference"><a href="./LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html#cite_note-2">[2]</a></sup>. Nous allons donc utiliser sed pour faire le ménage&#160;:
</p>
<table width="100%" class="config_array">
<tr>
<td class="config_subarray"> <font size="-1"><a href="./File:Configuration_file.png.html" class="image" title="Configuration File"><img alt="Configuration File" src="images/a/a6/Configuration_file.png" width="32" height="32" /></a> sed_ldif</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">/^creatorsName:/d
/^createTimestamp:/d
/^modifiersName:/d
/^modifyTimestamp:/d
/^structuralObjectClass:/d
/^entryUUID:/d
/^entryCSN:/d</pre></div></div>
</td></tr></table><br />
<p>Puis nous allons faire ce sed sur la totalité de notre ldif&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> sed</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">sed -f sed_ldif import_unclear.ldif &gt; import_clear.ldif</pre></div></div>
</td></tr></table><br />
<p>Maintenant nous pouvons importer le LDIF&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> ldapadd</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">ldapadd -h localhost -x -W -D &quot;cn=admin,dc=deimos,dc=fr&quot; -c -f import_clear.ldif</pre></div></div>
</td></tr></table><br />
<h3><span class="mw-headline" id="Importer_des_enregistrements"><span class="mw-headline-number">3.2.2</span> Importer des enregistrements</span></h3>
<p>Commande pour ajouter la fiche&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> ldapadd</font>
</td></tr>
<tr>
<td>
<pre>ldapadd -x -D "cn=<b>admin</b>,dc=<b>deimos</b>,dc=<b>fr</b>" -w <b>admin</b> -f <b>AjoutFiche.ldif</b>
</pre>
</td></tr></table><br />
<h3><span class="mw-headline" id="Modifier_des_enregistrements"><span class="mw-headline-number">3.2.3</span> Modifier des enregistrements</span></h3>
<p>Les commandes de modification ont la syntaxe suivante&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">dn: distinguished name
 changetype  {{TYPE}}
 change operation identifier
 list of attributes...
 ...
-
 change operation identifier
 list of attributes
 ...</pre></div></div>
<p>TYPE peu avoir l’une des valeurs suivantes&#160;:
</p>
<ul><li>  add (ajout d’une entrée),</li>
<li>  delete (suppression),</li>
<li>  modrdn (modification du RDN),</li>
<li>  modify (modification&#160;: add, replace, delete d’un attribut)</li></ul>
<p>Le fichier "<b>ModifFiche.ldif</b>" ci-dessous permet d’ajouter le numéro de téléphone&#160;:
</p>
<pre>dn: cn=<b>Père Noël</b>,dc=<b>deimos</b>,dc=<b>fr</b>
changetype: modify
add: telephonenumber
telephonenumber: <b>08 36 65 65 65</b>
</pre>
<p>Commande pour modifier la fiche&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> ldapadd</font>
</td></tr>
<tr>
<td>
<pre>ldapadd -x -D "cn=<b>admin</b>,dc=<b>deimos</b>,dc=<b>fr</b>" -w <b>admin</b> -f <b>ModifFiche.ldif</b>
</pre>
</td></tr></table><br />
<h3><span class="mw-headline" id="Supprimer_des_enregistrements"><span class="mw-headline-number">3.2.4</span> Supprimer des enregistrements</span></h3>
<p>Le fichier "<b>SuppFiche.ldif</b>" ci-dessous permet de supprimer une fiche&#160;:
</p>
<pre>dn: cn=Pierre MAVRO,dc=<b>deimos</b>,dc=<b>fr</b>
changetype: delete
</pre>
<p>Commande pour supprimer la fiche&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> ldapadd</font>
</td></tr>
<tr>
<td>
<pre>ldapadd -x -D "cn=<b>admin</b>,dc=<b>deimos</b>,dc=<b>fr</b>" -w <b>admin</b> -f <b>SuppFiche.ldif</b>
</pre>
</td></tr></table><br />
<h1><span class="mw-headline" id="Rechercher_des_enregistrements"><span class="mw-headline-number">4</span> Rechercher des enregistrements</span></h1>
<p>Rechercher les enregistrements contenant un attribut objectclass (donc tous) depuis la racine&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> ldapsearch</font>
</td></tr>
<tr>
<td>
<pre>ldapsearch -x -b "dc=<b>deimos</b>,dc=<b>fr</b>" "objectclass=*"
</pre>
</td></tr></table><br />
<p>Rechercher les enregistrements contenant un attribut cn dans la branche deimos&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> ldapsearch</font>
</td></tr>
<tr>
<td>
<pre>ldapsearch -x -b "o=<b>deimos Corporation</b>,dc=<b>deimos</b>,dc=<b>fr</b>" "cn=*"
</pre>
</td></tr></table><br />
<p>Rechercher les enregistrements donc l’attribut dc se termine par <b>gray</b> depuis la racine&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> ldapsearch</font>
</td></tr>
<tr>
<td>
<pre>ldapsearch -x -b "dc=<b>deimos</b>,dc=<b>fr</b>" "dc=<b>*gray</b>"
</pre>
</td></tr></table><br />
<h1><span class="mw-headline" id="Sauvegarde_d.E2.80.99une_base_de_donn.C3.A9es_LDAP"><span class="mw-headline-number">5</span> Sauvegarde d’une base de données LDAP</span></h1>
<p>La commande suivante permet de générer un fichier .LDIF contenant la base complète (sans le schéma ou la configuration)&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> ldapcat</font>
</td></tr>
<tr>
<td>
<pre>slapcat -l <b>DumpLDAP.ldif</b> -b "dc=<b>deimos</b>,dc=<b>fr</b>"
</pre>
</td></tr></table><br />
<p>Pour sauvegarder schéma et configuration<sup id="cite_ref-3" class="reference"><a href="./LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html#cite_note-3">[3]</a></sup>&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> slapcat</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">slapcat -b cn=config -l config.ldif</pre></div></div>
</td></tr></table><br />
<p>Pour sauvegarder le schéma uniquement&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> slapcat</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">slapcat -b cn=schema -l config.ldif</pre></div></div>
</td></tr></table><br />
<h1><span class="mw-headline" id="Restaurer_une_base_LDAP"><span class="mw-headline-number">6</span> Restaurer une base LDAP</span></h1>
<p>Pour restaurer une configuration, voici la marche à suivre<sup id="cite_ref-4" class="reference"><a href="./LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html#cite_note-4">[4]</a></sup>&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> </font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">/etc/init.d/slapd stop
rm -rf /etc/ldap/slapd.d/*
su - openldap -c &quot;slapadd -F /etc/ldap/slapd.d -b cn=config -l config.ldif&quot;
/etc/init.d/slapd start</pre></div></div>
</td></tr></table><br />
<h1><span class="mw-headline" id="Scripts_PHP"><span class="mw-headline-number">7</span> Scripts PHP</span></h1>
<ul><li> Exemple de script PHP pour se connecter au serveur LDAP&#160;:</li></ul>
<table width="100%" class="config_array">
<tr>
<td class="config_subarray"> <font size="-1"><a href="./File:Configuration_file.png.html" class="image" title="Configuration File"><img alt="Configuration File" src="images/a/a6/Configuration_file.png" width="32" height="32" /></a> </font>
</td></tr>
<tr>
<td>
<pre>$server="<b>localhost</b>";
$port="389";
$dn="dc=<b>deimos</b>,dc=<b>fr</b>";
$rootdn="cn=<b>admin</b>,$dn";
$rootpw="admin";

$ds=ldap_connect($server,$port);
ldap_set_option($ds, LDAP_OPT_PROTOCOL_VERSION, 3);
$r=ldap_bind($ds,$rootdn,$rootpw)
        or die ("Impossible de se connecter au serveur&#160;! \n");
echo "Authentification sur le serveur OpenLDAP -&gt; OK \n\n";
</pre>
</td></tr></table><br />
<ul><li> Exemple de script PHP pour rechercher des enregistrements&#160;:</li></ul>
<table width="100%" class="config_array">
<tr>
<td class="config_subarray"> <font size="-1"><a href="./File:Configuration_file.png.html" class="image" title="Configuration File"><img alt="Configuration File" src="images/a/a6/Configuration_file.png" width="32" height="32" /></a> </font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">$sr=ldap_search($ds,$dn,&quot;(objectclass=*)&quot;);
if ($sr) {
        $info=ldap_get_entries($ds,$sr);
        echo $info[&quot;count&quot;].&quot; enregistrements dans OpenLDAP \n&quot;;
        for ($i=0;$i&lt;=$info[&quot;count&quot;];$i++) {
                echo &quot;$i - &quot;.$info[$i][&quot;dn&quot;].&quot; \n&quot;;
        }
}</pre></div></div>
</td></tr></table><br />
<h1><span class="mw-headline" id="Liste_partielle_d.27attributs"><span class="mw-headline-number">8</span> Liste partielle d'attributs</span></h1>
<h2><span class="mw-headline" id="Classe_organization"><span class="mw-headline-number">8.1</span> Classe organization</span></h2>
<p><a href="./File:Ldap_att_org.jpg.html" class="image"><img alt="Ldap att org.jpg" src="images/d/d7/Ldap_att_org.jpg" width="695" height="594" /></a>
</p>
<h2><span class="mw-headline" id="Classe_inetOrgPerson"><span class="mw-headline-number">8.2</span> Classe inetOrgPerson</span></h2>
<p><a href="./File:Ldap_att_inetOrgPerson.jpg.html" class="image"><img alt="Ldap att inetOrgPerson.jpg" src="images/0/05/Ldap_att_inetOrgPerson.jpg" width="1113" height="404" /></a>
</p>
<h1><span class="mw-headline" id="Clients"><span class="mw-headline-number">9</span> Clients</span></h1>
<h2><span class="mw-headline" id="Installation_2"><span class="mw-headline-number">9.1</span> Installation</span></h2>
<h3><span class="mw-headline" id="Debian"><span class="mw-headline-number">9.1.1</span> Debian</span></h3>
<p>Pour pouvoir se connecter à l'annuaire OpenLDAP, nous aurons besoin de plusieurs choses&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> apt-get</font>
</td></tr>
<tr>
<td>
<pre>aptitude install libnss-ldapd libpam-smbpass libpam-mount
</pre>
</td></tr></table><br />
<h3><span class="mw-headline" id="Red_Hat"><span class="mw-headline-number">9.1.2</span> Red Hat</span></h3>
<p>Sur Red Hat, il n'y a pas grand chose à installer&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> yum</font>
</td></tr>
<tr>
<td>
<pre>yum install nss-pam-ldapd
</pre>
</td></tr></table><br />
<h2><span class="mw-headline" id="Configuration_2"><span class="mw-headline-number">9.2</span> Configuration</span></h2>
<p>D'une manière générale, les clients unix peuvent s'authentifier en utilisant les informations contenues dans l'annuaire LDAP via PAM et NSS. Il sufft donc d'installer et de configurer ces composants sur les différents systèmes.
</p>
<h3><span class="mw-headline" id="Debian_2"><span class="mw-headline-number">9.2.1</span> Debian</span></h3>
<p>Vous avez le choix d'installer libpam-ldapd ou libpam-ldap. libpam-ldapd est plus récent et évite quelques bugs vu sur libpam-ldap. A vous de voir ce que vous voulez&#160;:-)
</p>
<h4><span class="mw-headline" id="libpam-ldapd"><span class="mw-headline-number">9.2.1.1</span> libpam-ldapd</span></h4>
<p>Si vous optez pour libnss-ldapd, alors vous n'avez simplement qu'a installer ceci et répondre aux questions.
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> aptitude</font>
</td></tr>
<tr>
<td>
<pre>aptitude install libnss-ldapd
</pre>
</td></tr></table><br />
<h4><span class="mw-headline" id="libpam-ldap"><span class="mw-headline-number">9.2.1.2</span> libpam-ldap</span></h4>
<p>Si vous avez choisi d'installer libpam-ldap à la place de libpam-ldapd, vous allez devoir faire ceci à la main.
</p><p>Par défaut, debian créé deux fichiers de configuration différents pour libpam-ldap et libnss-ldap. Ceci est inutile vu que ces deux fichiers vont contenir la même chose. Il faut supprimer les fichiers de configuration libpam-ldap et créer des liens depuis ceux de libnss-ldap ver ceux de libpam-ldap:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> </font>
</td></tr>
<tr>
<td>
<pre>rm /etc/pam_ldap.*
ln -s /etc/libnss-ldap.conf /etc/pam_ldap.conf
ln -s /etc/libnss-ldap.secret /etc/pam_ldap.secret
</pre>
</td></tr></table><br />
<p>Editer /etc/libnss-ldap.conf et y mettre (il ne doit contenir que ces lignes)&#160;:
</p>
<table width="100%" class="config_array">
<tr>
<td class="config_subarray"> <font size="-1"><a href="./File:Configuration_file.png.html" class="image" title="Configuration File"><img alt="Configuration File" src="images/a/a6/Configuration_file.png" width="32" height="32" /></a> /etc/libnss-ldap.conf</font>
</td></tr>
<tr>
<td>
<pre>uri <b>ldap://ldap.mydomain.local/</b>
base <b>dc=openldap,dc=mydomain,dc=local</b>
ldap_version 3
rootbinddn <b>cn=admin,dc=openldap,dc=mydomain,dc=local</b>
scope sub
nss_paged_results yes
pagesize 1000
nss_base_passwd <b>dc=openldap,dc=mydomain,dc=local</b>?sub?&amp;(&amp;(objectClass=posixAccount)(!(objectClass=computer)))
nss_base_shadow <b>dc=openldap,dc=mydomain,dc=local</b>?sub
</pre>
</td></tr></table><br />
<p>Dans /etc/libnss-ldap.secret, indiquer le mot de passe de l'utilisateur indiquer sur la ligne rootdn du fichier /etc/libnss-ldap.conf.
</p><p>Vous devez ensuite modifier le fichier /etc/nsswitch.conf afin d'y indiquer que la recherche se fera entre autre dans l'annuaire ldap pour les différents services. Cela donne par exemple&#160;:
</p>
<table width="100%" class="config_array">
<tr>
<td class="config_subarray"> <font size="-1"><a href="./File:Configuration_file.png.html" class="image" title="Configuration File"><img alt="Configuration File" src="images/a/a6/Configuration_file.png" width="32" height="32" /></a> /etc/nsswitch.conf</font>
</td></tr>
<tr>
<td>
<pre>passwd:         <b>files ldap</b>
group:          <b>files ldap</b>
shadow:         <b>files ldap</b>

hosts:          <b>files dns</b>
networks:       files

protocols:      db files
services:       db files
ethers:         db files
rpc:            db files

netgroup:       nis
</pre>
</td></tr></table><br />
<h4><span class="mw-headline" id="libpam-ldapd_et_libpam-ldap"><span class="mw-headline-number">9.2.1.3</span> libpam-ldapd et libpam-ldap</span></h4>
<p>Enfin, il faut modifier les chaines pam pour que celles-ci permettent l'authentification via l'annuaire ldap. Ceci se fait en copiant les différents fichier /etc/pam.d/common-* vers /etc/pam.d/common-*-ldap&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> </font>
</td></tr>
<tr>
<td>
<pre>cd /etc/pam.d
cp common-account{,-ldap}        
cp common-auth{,-ldap}
cp common-pammount{,-ldap}
cp common-password{,-ldap}
cp common-session{,-ldap}
</pre>
</td></tr></table><br />
<p>Editer les différents fichiers /etc/pam.d/common-*-ldap pour avoir&#160;:
</p>
<ul><li> /etc/pam.d/common-account-ldap&#160;:</li></ul>
<table width="100%" class="config_array">
<tr>
<td class="config_subarray"> <font size="-1"><a href="./File:Configuration_file.png.html" class="image" title="Configuration File"><img alt="Configuration File" src="images/a/a6/Configuration_file.png" width="32" height="32" /></a> /etc/pam.d/common-account-ldap</font>
</td></tr>
<tr>
<td>
<pre>account sufficient      pam_ldap.so
account sufficient      pam_unix.so use_first_pass
account required        pam_deny.so
</pre>
</td></tr></table><br />
<ul><li> /etc/pam.d/common-auth-ldap</li></ul>
<table width="100%" class="config_array">
<tr>
<td class="config_subarray"> <font size="-1"><a href="./File:Configuration_file.png.html" class="image" title="Configuration File"><img alt="Configuration File" src="images/a/a6/Configuration_file.png" width="32" height="32" /></a> /etc/pam.d/common-auth-ldap</font>
</td></tr>
<tr>
<td>
<pre>auth    required        pam_nologin.so
auth    sufficient      pam_unix.so nullok_secure
auth    optional        pam_mount.so debug use_first_pass
auth    optional        pam_smbpass.so migrate use_first_pass
auth    sufficient      pam_ldap.so use_first_pass
auth    required        pam_deny.so
</pre>
</td></tr></table><br />
<ul><li> /etc/pam.d/common-password-ldap</li></ul>
<table width="100%" class="config_array">
<tr>
<td class="config_subarray"> <font size="-1"><a href="./File:Configuration_file.png.html" class="image" title="Configuration File"><img alt="Configuration File" src="images/a/a6/Configuration_file.png" width="32" height="32" /></a> /etc/pam.d/common-password-ldap</font>
</td></tr>
<tr>
<td>
<pre>password   required   pam_smbpass.so migrate
password   sufficient pam_ldap.so try_first_pass
password   sufficient pam_unix.so try_first_pass nullok obscure min=4 max=8 md5
password   required   pam_deny.so
</pre>
</td></tr></table><br />
<ul><li> /etc/pam.d/common-session-ldap</li></ul>
<table width="100%" class="config_array">
<tr>
<td class="config_subarray"> <font size="-1"><a href="./File:Configuration_file.png.html" class="image" title="Configuration File"><img alt="Configuration File" src="images/a/a6/Configuration_file.png" width="32" height="32" /></a> /etc/pam.d/common-session-ldap</font>
</td></tr>
<tr>
<td>
<pre>session required        pam_unix.so
session required        pam_ldap.so
session required        pam_mkhomedir.so skel=/etc/skel/ umask=0022
session optional        pam_mount.so
</pre>
</td></tr></table><br />
<ul><li> /etc/pam.d/common-session</li></ul>
<table width="100%" class="config_array">
<tr>
<td class="config_subarray"> <font size="-1"><a href="./File:Configuration_file.png.html" class="image" title="Configuration File"><img alt="Configuration File" src="images/a/a6/Configuration_file.png" width="32" height="32" /></a> /etc/pam.d/common-session</font>
</td></tr>
<tr>
<td>
<pre>session required        pam_mkhomedir.so skel=/etc/skel/ umask=0022
session sufficient      pam_ldap.so
session required        pam_unix.so
</pre>
</td></tr></table><br />
<p>Une fois ces fichiers common-*-ldap créés, on peut éditer les fichiers des différents services pour lesquels on veut autoriser l'authentification par ldap... Si par exemple on veut permettre aux utilisateurs contenus dans l'annuaire LDAP de se connecter en ssh sur la machine, on edite le fichier /etc/pam.d/ssh et on remplace les common-qqc en common-qqc-ldap.
</p><p>Pour l'automount des partitions en fonction de l'utilisateur, éditez le fichier /etc/security/pam_mount.conf&#160;:
</p>
<table width="100%" class="config_array">
<tr>
<td class="config_subarray"> <font size="-1"><a href="./File:Configuration_file.png.html" class="image" title="Configuration File"><img alt="Configuration File" src="images/a/a6/Configuration_file.png" width="32" height="32" /></a> /etc/security/pam_mount.conf</font>
</td></tr>
<tr>
<td>
<pre>volume * cifs 192.168.0.30 &amp;$ /media/windows/&amp; sfu - -
</pre>
</td></tr></table><br />
<p>Si vous ne pouvez toujours pas vous connecter, redémarrer le service nscd&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> </font>
</td></tr>
<tr>
<td>
<pre>/etc/init.d/nscd restart
</pre>
</td></tr></table><br />
<p>La commande suivante doit fonctionner correctement&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> getent</font>
</td></tr>
<tr>
<td>
<pre>getent passwd <b>mon_user</b>
</pre>
</td></tr></table><br />
<h4><span class="mw-headline" id="Autoriser_un_groupe_LDAP_en_particulier"><span class="mw-headline-number">9.2.1.4</span> Autoriser un groupe LDAP en particulier</span></h4>
<p>Une des méthodes courantes est de n'autoriser qu'un ou certains groupes du LDAP à accéder à une machine. Pour celà, il faudra que les groupes aient comme attribut <b>posixGroup</b> nommé <b>login</b>. 
</p>
<h5><span class="mw-headline" id="Debian_3"><span class="mw-headline-number">9.2.1.4.1</span> Debian</span></h5>
<p>Installez libpam-modules si ce n'est pas déjà fait&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> aptitude</font>
</td></tr>
<tr>
<td>
<pre>aptitude install libpam-modules
</pre>
</td></tr></table><br />
<p>Ensuite ajoutez cette ligne dans le fichier /etc/pam.d/common-auth&#160;:
</p>
<table width="100%" class="config_array">
<tr>
<td class="config_subarray"> <font size="-1"><a href="./File:Configuration_file.png.html" class="image" title="Configuration File"><img alt="Configuration File" src="images/a/a6/Configuration_file.png" width="32" height="32" /></a> /etc/pam.d/common-auth</font>
</td></tr>
<tr>
<td>
<pre>...
auth required    pam_access.so
</pre>
</td></tr></table><br />
<h5><span class="mw-headline" id="Red_Hat_2"><span class="mw-headline-number">9.2.1.4.2</span> Red Hat</span></h5>
<p>Installez ce package&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> yum</font>
</td></tr>
<tr>
<td>
<pre>yum install pam-devel
</pre>
</td></tr></table><br />
<p>Et ajoutez cette ligne sur le service que vous souhaitez (sshd par exemple), la restriction&#160;:
</p>
<table width="100%" class="config_array">
<tr>
<td class="config_subarray"> <font size="-1"><a href="./File:Configuration_file.png.html" class="image" title="Configuration File"><img alt="Configuration File" src="images/a/a6/Configuration_file.png" width="32" height="32" /></a> /etc/pam.d/sshd</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">auth       include      password-auth
<span class="xtra ln-xtra">account    required     pam_access.so</span>account    required     pam_nologin.so</pre></div></div>
</td></tr></table><br />
<h5><span class="mw-headline" id="Configuration_3"><span class="mw-headline-number">9.2.1.4.3</span> Configuration</span></h5>
<p>Celà va nous permettre d'utiliser le fichier /etc/security/access.conf. Et voici le genre de ligne qu'il faut rajouter&#160;:
</p>
<table width="100%" class="config_array">
<tr>
<td class="config_subarray"> <font size="-1"><a href="./File:Configuration_file.png.html" class="image" title="Configuration File"><img alt="Configuration File" src="images/a/a6/Configuration_file.png" width="32" height="32" /></a> /etc/security/access.conf</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">...
# disallow all except people in the login group and root
-:ALL EXCEPT root (sysadmin):ALL EXCEPT LOCAL</pre></div></div>
</td></tr></table><br />
<p>Ceci permet de désactiver tous les comptes sauf&#160;:
</p>
<ul><li> root</li>
<li> Le groupe sysadmin (pas l'utilisateur grâce aux parenthèses)</li>
<li> LOCAL&#160;: les utilisateurs locaux</li></ul>
<h3><span class="mw-headline" id="Red_Hat_3"><span class="mw-headline-number">9.2.2</span> Red Hat</span></h3>
<p>Il existe 2 méthodes. La première passe par un script Red Hat qui va nous faire tout pour nous, tandis que la deuxième est la solution manuelle.
</p>
<h4><span class="mw-headline" id="M.C3.A9thode_1"><span class="mw-headline-number">9.2.2.1</span> Méthode 1</span></h4>
<p>Pour configurer PAM avec LDAP, utilisez cette commande et adaptez la à vos besoins&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> authconfig</font>
</td></tr>
<tr>
<td>
<pre>authconfig --enableldap --enableldapauth --ldapserver=ldap://<b>openldap-server.deimos.fr:389</b> --ldapbasedn="<b>dc=openldap,dc=deimos,dc=fr</b>" --enableldaptls --ldaploadcacer=<b><a rel="nofollow" class="external free" href="http://serveur-web/deimosfr.crt">http://serveur-web/deimosfr.crt</a></b> --enablemkhomedir --update
</pre>
</td></tr></table><br />
<ul><li> --ldapserver&#160;: rentrez l'adresse de votre serveur web</li>
<li> --ldapbasedn&#160;: le DN de votre serveur</li>
<li> --enableldaptls&#160;: si vous utilisez des connections LDAP sécurisées</li>
<li> --ldaploadcacer&#160;: le certificat à utiliser (si vous n'avez pas moyen de le récupérer de cette façon, regardez la procédure un peu plus bas)</li></ul>
<p>ou une version sans ssl/tls&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> authconfig</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">authconfig --enableldap --enableldapauth --disablenis --disableshadow --enablecache  --passalgo=sha512 --disableldaptls --disableldapstarttls --disablesssdauth --enablemkhomedir --enablepamaccess --enablecachecreds --enableforcelegacy --disablefingerprint  --ldapserver=192.168.0.1 --ldapbasedn=dc=openldap,dc=deimos,dc=fr --updateall</pre></div></div>
</td></tr></table><br />
<p>Pour récupérer le certificat ssl demandé plus haut, voici une solution&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> openssl</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1"><span class="xtra ln-xtra">&gt; openssl s_client -connect openldap-server.deimos.fr:636</span>CONNECTED(00000003)
depth=0 C = FR, ST = IDF, L = Paris, O = DEIMOS, CN = openldap-server.deimos.fr, emailAddress = deimos@deimos.fr
verify error:num=18:self signed certificate
verify return:1
depth=0 C = FR, ST = IDF, L = Paris, O = DEIMOS, CN = openldap-server.deimos.fr, emailAddress = deimos@deimos.fr
verify return:1
---
Certificate chain
 0 s:/C=FR/ST=IDF/L=Paris/O=DEIMOS/CN=openldap-server.deimos.fr/emailAddress=deimos@deimos.fr
   i:/C=FR/ST=IDF/L=Paris/O=DEIMOS/CN=openldap-server.deimos.fr/emailAddress=deimos@deimos.fr
---
Server certificate
<span class="xtra ln-xtra">-----BEGIN CERTIFICATE-----</span><span class="xtra ln-xtra">MIIDpTCCAw6gAwIBAgIJAJJUJLhNM1/XMA0GCSqGSIb3DQEBBQUAMIGUMQswCQYD</span><span class="xtra ln-xtra">VQQGEwJGUjEMMAoGA1UECBMDSURGMQ4wDAYDVQQHEwVQYXJpczEPMA0GA1UEChMG</span><span class="xtra ln-xtra">VUxMSU5LMREwDwYDVQQLEwh1bHN5c25ldDEcMBoGA1UEAxMTdGFzbWFuaWEMdWxs</span><span class="xtra ln-xtra">aW5rLmxhbjElMCMGCSqGSIb3DQEJARYWaW503XJuYWwtaXRAdWxsaW5rLmNvbTAe</span><span class="xtra ln-xtra">Fw0xMTEyMDUxMjQzMzVaFw0yMTEyMDIxMjQzMzVaMIGUMQswCQYDVQQGEwJGUjEM</span><span class="xtra ln-xtra">MAoGA1UECBMDSURGMR4wDAYDVQQHEwVQYXJpczEPMA0GA1UEChMGVUxMSU5LMREw</span><span class="xtra ln-xtra">DwYDVQQLEwh1bHN5c25ldDEcMBoGA1UEAxMTdGFzbWFuaWEudWxsaW5rLmxhbjEl</span><span class="xtra ln-xtra">MCMGCSqGSIb3DQEJARYWaW50ZXJuYWwtaXRAdWxsaW5rLmNvbTCBnzANBgkqhkiG</span><span class="xtra ln-xtra">9w0BAQEFAAOBjQAwgYkCgYEA4QoXFn39LhMW7mlA9r3NOX6iTHCCSlZjVQi0mQ5k</span><span class="xtra ln-xtra">BVysN8KMFfC0E4vOeG1Z11AYwW7xCOb4Pl+LgfgfdgfgfdJIn92LX0meJcsgWKOh</span><span class="xtra ln-xtra">qVAsZNkWn2ss8oDw3t5NEOjKFZ5BKVR2fL4Yj23DmFOAwew5PR5xhxGV5LJ9VErS</span><span class="xtra ln-xtra">Ks0CAwEAAaOB/DCB+TAdBgNVHQ4EFgQUn5Ig2hFtROXcG3vxux7izNqcUd4wgckG</span><span class="xtra ln-xtra">A1UdIwSBwTCBvoAUn5Ig2hFtROXcG3vxux7izNqcUd6hgZqkgZcwgZQxCzAJBgNV</span><span class="xtra ln-xtra">BAYTAkZSMQwwCgYDVQQIEwNJREYxDjAMBgNVBAcTBVBhcmlzMQ8wDQYDVQQKEwZV</span><span class="xtra ln-xtra">TExJTksxETAPBgNVBAsTCHVsc3lzbmV0MRwwGgYDVQQDExN0YXNtYW5pYS51bGxp</span><span class="xtra ln-xtra">bmsubGFuMSUwIwYJKoZIhvcNAQkBFhZpbnRlcm5hbC1pdEB1bGxpbmsuY29tggkA</span><span class="xtra ln-xtra">klQkuE0zX9cwDAYCVR0TBAUwAwEB/zANBgkqhkiG9w0BAQUFAAOBgQAbjjAbcBez</span><span class="xtra ln-xtra">dKyq+Tlf3/DURW0BJhHKyY7UW7L39m/KZRIB2lbgFjslrAL4yNnFgipJ6aKlJFfV</span><span class="xtra ln-xtra">BYEu7MhKH2pJZBYFpzuHOdKvDq+Kmn/wGvxeOvzh1GzQPGhQv4cClm2PJNMh/jrK</span><span class="xtra ln-xtra">ZWNzqyLWYtWAoLu6N6gMER1Bd1Z5uzHl3A==</span><span class="xtra ln-xtra">-----END CERTIFICATE-----  </span>subject=/C=FR/ST=IDF/L=Paris/O=DEIMOS/CN=openldap-server.deimos.fr/emailAddress=deimos@deimos.fr
issuer=/C=FR/ST=IDF/L=Paris/O=DEIMOS/CN=openldap-server.deimos.fr/emailAddress=deimos@deimos.fr
---
No client certificate CA names sent
---
SSL handshake has read 1291 bytes and written 311 bytes
---
New, TLSv1/SSLv3, Cipher is AES256-SHA
Server public key is 1024 bit
Secure Renegotiation IS NOT supported
Compression: NONE
Expansion: NONE
SSL-Session:
    Protocol &#160;: TLSv1
    Cipher   &#160;: AES256-SHA 
    Session-ID: 91E6398F6DE9FBDC1B7EBDF890FE818B09EB79555C9FC1CF64EDC284F7A23B2A
    Session-ID-ctx:
    Master-Key: 51408932336792F4E8F5339BD12F312005022A4B20E6A5FBC56239BC0DD514344449531973B9A8395B1E799196D8F411
    Key-Arg  &#160;: None
    Krb5 Principal: None   
    PSK identity: None
    PSK identity hint: None
    Start Time: 1327491823 
    Timeout  &#160;: 300 (sec)  
    Verify return code: 18 (self signed certificate)
---</pre></div></div>
</td></tr></table><br />
<p>Dans le cas ou le certificat est récupérer de la manière manuelle, copiez le dans /etc/openldap/cacerts/ldap.crt, puis exécutez la commande suivante&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> cacertdir_rehash</font>
</td></tr>
<tr>
<td>
<pre>cacertdir_rehash /etc/openldap/cacerts
</pre>
</td></tr></table><br />
<h4><span class="mw-headline" id="M.C3.A9thode_2"><span class="mw-headline-number">9.2.2.2</span> Méthode 2</span></h4>
<p>Modifier /etc/ldap.conf. Ce fichier est l'équivalent de /etc/libnss_pam.conf sous debian. Vous pouvez donc y mettre la même chose.
</p><p>Modifier le fichier /etc/pam.d/system_auth&#160;: c'est l'équivalent des différents common-* sous debian. Cela donne par exemple:
</p>
<table width="100%" class="config_array">
<tr>
<td class="config_subarray"> <font size="-1"><a href="./File:Configuration_file.png.html" class="image" title="Configuration File"><img alt="Configuration File" src="images/a/a6/Configuration_file.png" width="32" height="32" /></a> /etc/pam.d/system_auth</font>
</td></tr>
<tr>
<td>
<pre>auth        required      /lib/security/$ISA/pam_env.so
auth        sufficient    /lib/security/$ISA/pam_unix.so likeauth nullok
auth        sufficient    /lib/security/$ISA/pam_ldap.so use_first_pass
auth        required      /lib/security/$ISA/pam_deny.so

account     sufficient    /lib/security/$ISA/pam_unix.so
account     sufficient    /lib/security/$ISA/pam_ldap.so
account     sufficient    /lib/security/$ISA/pam_succeed_if.so uid &lt; 100 quiet
account     required      /lib/security/$ISA/pam_permit.so

password    requisite     /lib/security/$ISA/pam_cracklib.so retry=3
password    sufficient    /lib/security/$ISA/pam_unix.so nullok use_authtok md5 shadow
password    required      /lib/security/$ISA/pam_deny.so

session     optional      /lib/security/$ISA/pam_mkhomedir.so skel=/etc/skel/ umask=0077
session     required      /lib/security/$ISA/pam_limits.so
session     required      /lib/security/$ISA/pam_unix.so
</pre>
</td></tr></table><br />
<p>Comme sur debian, il faut également modifier le fichier /etc/nsswitch.conf.
</p>
<h3><span class="mw-headline" id="Forcer_un_shell_au_login"><span class="mw-headline-number">9.2.3</span> Forcer un shell au login</span></h3>
<p>Si vous avez une authentification de pam via LDAP, il est possible de forcer un shell en particulier au login. Il va donc overrider les informations envoyées par NSS et les remplacer par le shell souhaité. Nous allons utiliser ici lshell pour toutes les personnes se connectant via LDAP&#160;:
</p>
<table width="100%" class="config_array">
<tr>
<td class="config_subarray"> <font size="-1"><a href="./File:Configuration_file.png.html" class="image" title="Configuration File"><img alt="Configuration File" src="images/a/a6/Configuration_file.png" width="32" height="32" /></a> /etc/libnss-ldap.conf ou /etc/ldap.conf</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">nss_override_attribute_value loginShell /usr/bin/lshell</pre></div></div>
</td></tr></table><br />
<h3><span class="mw-headline" id="Solaris"><span class="mw-headline-number">9.2.4</span> Solaris</span></h3>
<ul><li> Configurer le fichier /etc/pam.conf&#160;:</li></ul>
<p>Pour chaque ligne&#160;:
</p>
<table width="100%" class="config_array">
<tr>
<td class="config_subarray"> <font size="-1"><a href="./File:Configuration_file.png.html" class="image" title="Configuration File"><img alt="Configuration File" src="images/a/a6/Configuration_file.png" width="32" height="32" /></a> /etc/pam.conf</font>
</td></tr>
<tr>
<td>
<pre>service  auth <b>required</b>           pam_unix_auth.so.1
</pre>
</td></tr></table><br />
<p>remplacer "required" par "sufficient" et ajouter derrière la ligne&#160;:
</p>
<table width="100%" class="config_array">
<tr>
<td class="config_subarray"> <font size="-1"><a href="./File:Configuration_file.png.html" class="image" title="Configuration File"><img alt="Configuration File" src="images/a/a6/Configuration_file.png" width="32" height="32" /></a> /etc/pam.conf</font>
</td></tr>
<tr>
<td>
<pre>service auth <b>sufficient pam_ldap.so.1 try_first_pass</b>
</pre>
</td></tr></table><br />
<p>Ce qui doit donner quelquechose comme ceci&#160;:
</p>
<table width="100%" class="config_array">
<tr>
<td class="config_subarray"> <font size="-1"><a href="./File:Configuration_file.png.html" class="image" title="Configuration File"><img alt="Configuration File" src="images/a/a6/Configuration_file.png" width="32" height="32" /></a> /etc/pam.conf</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">#
#ident  &quot;@(#)pam.conf   1.28    04/04/21 SMI&quot;
#
# Copyright 2004 Sun Microsystems, Inc.  All rights reserved.
# Use is subject to license terms.
#
# PAM configuration
#
# Unless explicitly defined, all services use the modules
# defined in the &quot;other&quot; section.
#
# Modules are defined with relative pathnames, i.e., they are
# relative to /usr/lib/security/$ISA. Absolute path names, as
# present in this file in previous releases are still acceptable.
#
# Authentication management
#
# login service (explicit because of pam_dial_auth)
#
login   auth requisite          pam_authtok_get.so.1
login   auth required           pam_dhkeys.so.1
login   auth required           pam_unix_cred.so.1
login   auth sufficient         pam_ldap.so.1 try_first_pass
login   auth sufficient         pam_unix_auth.so.1
login   auth required           pam_dial_auth.so.1
#
# rlogin service (explicit because of pam_rhost_auth)
#
rlogin  auth sufficient         pam_rhosts_auth.so.1
rlogin  auth requisite          pam_authtok_get.so.1
rlogin  auth required           pam_dhkeys.so.1
rlogin  auth required           pam_unix_cred.so.1
rlogin  auth sufficient         pam_ldap.so.1 try_first_pass
rlogin  auth sufficient         pam_unix_auth.so.1
#
# Kerberized rlogin service
#
krlogin auth required           pam_unix_cred.so.1
krlogin auth binding            pam_krb5.so.1
krlogin auth sufficient         pam_ldap.so.1
krlogin auth sufficient         pam_unix_auth.so.1
#
# rsh service (explicit because of pam_rhost_auth,
# and pam_unix_auth for meaningful pam_setcred)
#
rsh     auth sufficient         pam_rhosts_auth.so.1
rsh     auth required           pam_unix_cred.so.1
#
# Kerberized rsh service
#
krsh    auth required           pam_unix_cred.so.1
krsh    auth binding            pam_krb5.so.1
krsh    auth sufficient         pam_ldap.so.1
krsh    auth sufficient         pam_unix_auth.so.1
#
# Kerberized telnet service
#
ktelnet auth required           pam_unix_cred.so.1
ktelnet auth binding            pam_krb5.so.1
ktelnet auth sufficient         pam_ldap.so.1
ktelnet auth sufficient         pam_unix_auth.so.1
#
# PPP service (explicit because of pam_dial_auth)
#
ppp     auth requisite          pam_authtok_get.so.1
ppp     auth required           pam_dhkeys.so.1
ppp     auth required           pam_unix_cred.so.1
ppp     auth sufficient         pam_ldap.so.1
ppp     auth sufficient         pam_unix_auth.so.1
ppp     auth required           pam_dial_auth.so.1
#
# Default definitions for Authentication management
# Used when service name is not explicitly mentioned for authentication
#
other   auth requisite          pam_authtok_get.so.1
other   auth required           pam_dhkeys.so.1
other   auth required           pam_unix_cred.so.1
other   auth sufficient         pam_ldap.so.1
other   auth sufficient         pam_unix_auth.so.1
#
# passwd command (explicit because of a different authentication module)
#
passwd  auth required           pam_passwd_auth.so.1
#
# cron service (explicit because of non-usage of pam_roles.so.1)
#
cron    account required        pam_unix_account.so.1
#
# Default definition for Account management
# Used when service name is not explicitly mentioned for account management
#
other   account requisite       pam_roles.so.1
other   account required        pam_unix_account.so.1
#
# Default definition for Session management
# Used when service name is not explicitly mentioned for session management
#
other   session required        pam_unix_session.so.1
#
# Default definition for  Password management
# Used when service name is not explicitly mentioned for password management
#
other   password required       pam_dhkeys.so.1
other   password requisite      pam_authtok_get.so.1
other   password requisite      pam_authtok_check.so.1
other   password required       pam_authtok_store.so.1
#
# Support for Kerberos V5 authentication and example configurations can
# be found in the pam_krb5(5) man page under the &quot;EXAMPLES&quot; section.
#</pre></div></div>
</td></tr></table><br />
<ul><li> Configurer le fichier /etc/nsswitch.ldap</li></ul>
<p>Laisser "ldap" uniquement là où c'est utile&#160;: pour le moment sur les lignes passwd: et group:.<br />
Pour le reste, mettre le contenu du fichier /etc/nsswitch.dns.<br />
Ce qui donne&#160;:
</p>
<table width="100%" class="config_array">
<tr>
<td class="config_subarray"> <font size="-1"><a href="./File:Configuration_file.png.html" class="image" title="Configuration File"><img alt="Configuration File" src="images/a/a6/Configuration_file.png" width="32" height="32" /></a> /etc/nsswitch.ldap</font>
</td></tr>
<tr>
<td>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">#
# Copyright 2006 Sun Microsystems, Inc.  All rights reserved.
# Use is subject to license terms.
#
&#160;
#
# /etc/nsswitch.dns:
#
# An example file that could be copied over to /etc/nsswitch.conf; it uses
# DNS for hosts lookups, otherwise it does not use any other naming service.
#
# &quot;hosts:&quot; and &quot;services:&quot; in this file are used only if the
# /etc/netconfig file has a &quot;-&quot; for nametoaddr_libs of &quot;inet&quot; transports.
&#160;
# DNS service expects that an instance of svc:/network/dns/client be
# enabled and online.
&#160;
passwd:     files ldap
group:      files ldap
&#160;
# You must also set up the /etc/resolv.conf file for DNS name
# server lookup.  See resolv.conf(4).
hosts:      files dns 
&#160;
# Note that IPv4 addresses are searched for in all of the ipnodes databases
# before searching the hosts databases.
ipnodes:   files dns 
&#160;
networks:   files
protocols:  files
rpc:        files
ethers:     files
netmasks:   files
bootparams: files
publickey:  files
# At present there isn't a 'files' backend for netgroup;  the system will 
#   figure it out pretty quickly, and won't use netgroups at all.
netgroup:   files
automount:  files
aliases:    files
services:   files
printers:       user files
&#160;
auth_attr:  files
prof_attr:  files
project:    files
&#160;
tnrhtp:     files
tnrhdb:     files</pre></div></div>
</td></tr></table><br />
<p>Une fois que cela est fait, nous allons pouvoir mettre en place la configuration. <b>Attention&#160;: si vous êtes en environnement cluster, adapatez à la conf initiale&#160;!</b>&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> </font>
</td></tr>
<tr>
<td>
<pre>cp /etc/nsswitch.ldap /etc/nsswitch.conf
</pre>
</td></tr></table><br />
<ul><li> Lancer la configuration du client ldap</li></ul>
<p>Il suffit de taper la commande&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> ldapclient</font>
</td></tr>
<tr>
<td>
<pre>ldapclient manual -v -a authenticationMethod=simple -a proxyDN=cn=admin,dc=<b>openldap,dc=mydomain,dc=local</b> -aproxyPassword=bidon -a defaultSearchBase=<b>dc=openldap,dc=mydomain,dc=local</b> -a defaultServerList=<b>ldap.mydomain.local</b> -a serviceSearchDescriptor=passwd:<b>dc=openldap,dc=mydomain,dc=local</b>?sub -a serviceSearchDescriptor=shadow:<b>dc=openldap,dc=mydomain,dc=local</b>?sub -a serviceSearchDescriptor=group:dc=<b>openldap,dc=mydomain,dc=local</b>?sub -a serviceAuthenticationMethod=pam_ldap:simple&lt;nowiki&gt;=&lt;/nowiki&gt;
</pre>
</td></tr></table><br />
<p>Attention&#160;: il semble que la commande ldapclient soit buggée et nécéssite les paramètres proxyDN et proxyPassword même s'ils sont inutilisés&#160;! (et même s'ils contiennent n'importe quoi)
</p>
<ul><li> Attention au répertoire home, il faut configurer /etc/auto_home (<a rel="nofollow" class="external free" href="http://www.solaris-fr.org/home/docs/base/utilisateurs">http://www.solaris-fr.org/home/docs/base/utilisateurs</a>). Ce qui donne pour ma part&#160;:</li></ul>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> /etc/auto_home</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">#
# Copyright 2003 Sun Microsystems, Inc.  All rights reserved.
# Use is subject to license terms.
#
# ident &quot;@(#)auto_home  1.6     03/04/28 SMI&quot;
#
# Home directory map for automounter
#
+auto_home
* localhost:/export/home/&amp;</pre></div></div>
</td></tr></table><br />
<p>Au cas où vous voudriez créer automatiquement le home directory, vous devez effectuer un portage du pam_mkhomedir de linux&#160;:
</p>
<ul><li> <a rel="nofollow" class="external free" href="http://mega.ist.utl.pt/~filipe/pam_mkhomedir-sol/?C=D;O=A">http://mega.ist.utl.pt/~filipe/pam_mkhomedir-sol/?C=D;O=A</a></li>
<li> <a rel="nofollow" class="external free" href="http://www.keutel.de/pam_mkhomedir/index.html">http://www.keutel.de/pam_mkhomedir/index.html</a></li></ul>
<p>Une bonne idée serait aussi de monter automatiquement le home depuis un serveur nfs.
</p><p>Il faut que les comptes utilisateurs dans l'annuaire LDAP aient dans leur liste d 'objectClass la classe «&#160;shadowAccount&#160;» pour pouvoir être pris en compte par solaris.
</p>
<h1><span class="mw-headline" id="FAQ"><span class="mw-headline-number">10</span> FAQ</span></h1>
<h2><span class="mw-headline" id="Comment_d.C3.A9bugger_.3F"><span class="mw-headline-number">10.1</span> Comment débugger&#160;?</span></h2>
<p>Il existe un moyen très efficace de débugger&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> slapd</font>
</td></tr>
<tr>
<td>
<pre>slapd -d 17
</pre>
</td></tr></table><br />
<h2><span class="mw-headline" id="ldap_bind:_Invalid_credentials_.2849.29"><span class="mw-headline-number">10.2</span> ldap_bind: Invalid credentials (49)</span></h2>
<p>Là clairement il y a un problème avec votre login et votre mot de passe&#160;! Vérifiez le tout et faites bien attention si le mot de passe est en crypté ou non.
</p>
<h2><span class="mw-headline" id="ldap_add:_Naming_violation_.2864.29"><span class="mw-headline-number">10.3</span> ldap_add: Naming violation (64)</span></h2>
<p>Si vous avez un message du genre, lors de la création racine&#160;:
</p>
<pre>adding new entry "dc=deimos,dc=fr"
ldap_add: Naming violation (64)
       additional info: value of naming attribute 'dc' is not present in entry
</pre>
<p>C'est que vous avez un problème au niveau du "dc". En effet, si votre "dn" contient 2 arguments comme ici (deimos et fr pour deimos.fr), alors vous devez indiquer pour votre "dc" le premier arguement de votre "dn". Ex&#160;:
</p>
<pre>dc=deimos,dc=fr
</pre>
<p>mon dc est alors <b>deimos</b> dans mon fichier d'import ldif.
</p>
<h2><span class="mw-headline" id="operation_not_permitted_during_recovery"><span class="mw-headline-number">10.4</span> operation not permitted during recovery</span></h2>
<p>Suite à une coupure brutale du serveur, le serveur ldap n’est pas reparti. Voici le message que j’avais au démarrage en mode débugage&#160;:
</p>
<pre># slapd -d 1
bdb_db_open: dbenv_open(/var/lib/ldap)
bdb(dc=mondomaine,dc=com): operation not permitted during recovery
bdb_db_open: db_open(/var/lib/ldap) failed: Invalid argument (22)
backend_startup: bi_db_open failed! (22)
bdb_db_destroy: close failed: Invalid argument (22)
slapd stopped.
</pre>
<p>En fait, c’était la base ldap qui était corrompue et pour régler ce problème, je l’ai simplement ré-indexée avec ces commandes&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> </font>
</td></tr>
<tr>
<td>
<pre>/etc/init.d/slapd stop
slapindex
/etc/init.d/slapd start
</pre>
</td></tr></table><br />
<h2><span class="mw-headline" id="Purger_les_logs"><span class="mw-headline-number">10.5</span> Purger les logs</span></h2>
<p>Il m'est arrivé de n'avoir plus de place sur un de mes disques à cause des logs qui prennent trop de place. Pour flusher automatiquement les logs, 2 méthodes existent&#160;: auto et manuelle.
</p>
<h3><span class="mw-headline" id="M.C3.A9thode_automatique"><span class="mw-headline-number">10.5.1</span> Méthode automatique</span></h3>
<p>Il suffit d'insérer ceci dans ce fichier /var/lib/ldap/DB_CONFIG&#160;:
</p>
<table width="100%" class="config_array">
<tr>
<td class="config_subarray"> <font size="-1"><a href="./File:Configuration_file.png.html" class="image" title="Configuration File"><img alt="Configuration File" src="images/a/a6/Configuration_file.png" width="32" height="32" /></a> /var/lib/ldap/DB_CONFIG</font>
</td></tr>
<tr>
<td>
<pre>set_flags DB_LOG_AUTOREMOVE
</pre>
</td></tr></table><br />
<h3><span class="mw-headline" id="M.C3.A9thode_manuelle"><span class="mw-headline-number">10.5.2</span> Méthode manuelle</span></h3>
<p>Il faut que le serveur ldap soit arrêter. Mais avant, il va déjà falloir installer ceci&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> apt-get</font>
</td></tr>
<tr>
<td>
<pre>apt-get install db4.2-util
</pre>
</td></tr></table><br />
<p><b>Arrêtez maintenant le serveur ldap.</b>
</p><p>Pour lister les logs qui peuvent être supprimer, faites cette commande&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> </font>
</td></tr>
<tr>
<td>
<pre>cd /var/lib/ldap/
db4.2_archive
</pre>
</td></tr></table><br />
<p>Pour supprimer les logs qui peuvent être supprimer&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> </font>
</td></tr>
<tr>
<td>
<pre>cd /var/lib/ldap/
db4.2_archive <b>-d</b>
</pre>
</td></tr></table><br />
<p>Pour purger au maximum&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> db4.2_checkpoint</font>
</td></tr>
<tr>
<td>
<pre>db4.2_checkpoint -1
</pre>
</td></tr></table><br />
<h2><span class="mw-headline" id="Vider_le_cache"><span class="mw-headline-number">10.6</span> Vider le cache</span></h2>
<p>Il peut arriver d'avoir plusieurs utilisateurs qui se font la male suite à une malencontreuse synchronisation foireuse. Par exemple un slapcat vous montrera les utilisateurs et groupes ldap, mais pas la commande getent.
</p><p>Tout ceci est du au cache. Pour corriger le problème, il faut donc le vider. La commande nscd&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> nscd</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">$ nscd -g
nscd configuration:
&#160;
         0  server debug level
&quot;/dev/null&quot;  is server log file
&#160;
&#160;
CACHE: passwd
&#160;
         CONFIG:
         enabled: yes
         per user cache: no
         avoid name service: no
         check file: yes
         check file interval: 0
         positive ttl: 600
         negative ttl: 5
         keep hot count: 20
         hint size: 2048
         max entries: 0 (unlimited)
&#160;
         STATISTICS:
         positive hits: 28
         negative hits: 0
         positive misses: 5
         negative misses: 0
         total entries: 5
         queries queued: 0
         queries dropped: 0
         cache invalidations: 0
         cache hit rate:       84,8
&#160;
&#160;
CACHE: group
&#160;
         CONFIG:
         enabled: yes
         per user cache: no
         avoid name service: no
         check file: yes
         check file interval: 0
         positive ttl: 3600
         negative ttl: 5
         keep hot count: 20
         hint size: 2048
         max entries: 0 (unlimited)
...</pre></div></div>
</td></tr></table><br />
<p>La liste des caches disponible peut être donnée via un help sur la commande&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> nscd</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">        Supported caches:
          audit_user, auth_attr, bootparams, ethers
          exec_attr, group, hosts, ipnodes, netmasks
          networks, passwd, printers, prof_attr, project
          protocols, rpc, services, tnrhtp, tnrhdb
          user_attr</pre></div></div>
</td></tr></table><br />
<p>Si on souhaites donc vider par exemple le cache des groupes, il suffit de faire&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> nscd</font>
</td></tr>
<tr>
<td>
<pre>nscd -i group
</pre>
</td></tr></table><br />
<p>Vous pouvez redémarrer le service si vous souhaitez tout flusher.
</p>
<h2><span class="mw-headline" id="err_-30978._Restore_from_backup"><span class="mw-headline-number">10.7</span> err -30978. Restore from backup</span></h2>
<p>Quand on a ce genre de messages, c'est souvent la panique&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> slapd -d 17</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">...
send_ldap_result: conn=-1 op=0 p=0
backend_startup_one: starting &quot;dc=openldap,dc=mycompany,dc=lan&quot;
bdb_db_open: unclean shutdown detected; attempting recovery.
bdb_db_open: dbenv_open(/var/lib/ldap/mycompany)
bdb(dc=openldap,dc=deimos,dc=fr): Log sequence error: page LSN 319 5223075; previous LSN 319 10485269
bdb(dc=openldap,dc=deimos,dc=fr): Recovery function for LSN 320 480 failed on forward pass
bdb(dc=openldap,dc=deimos,dc=fr): PANIC: Invalid argument
bdb(dc=openldap,dc=deimos,dc=fr): PANIC: fatal region error detected; run recovery
bdb(dc=openldap,dc=deimos,dc=fr): PANIC: fatal region error detected; run recovery
bdb(dc=openldap,dc=deimos,dc=fr): PANIC: fatal region error detected; run recovery
bdb_db_open: Database cannot be recovered, err -30978. Restore from backup!
====&gt; bdb_cache_release_all
bdb(dc=openldap,dc=mycompany,dc=lan): DB_ENV-&gt;lock_id_free interface requires an environment configured for the locking subsystem
bdb(dc=openldap,dc=mycompany,dc=lan): txn_checkpoint interface requires an environment configured for the transaction subsystem
bdb_db_close: txn_checkpoint failed: Invalid argument (22)
backend_startup_one: bi_db_open failed! (-30978)
slapd shutdown: initiated
====&gt; bdb_cache_release_all
====&gt; bdb_cache_release_all
bdb_db_close: alock_close failed
slapd destroy: freeing system resources.
slapd stopped.
connections_destroy: nothing to destroy.</pre></div></div>
</td></tr></table><br />
<p>Pour réparer tout ce petit monde, nous avons la commande db_recover. <b>Adaptez la selon votre version</b>&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> db4.2_recover</font>
</td></tr>
<tr>
<td>
<pre>db4.2_recover
</pre>
</td></tr></table><br />
<p>Vous pouvez encore rencontrer des soucis après celà. Pour ma part, la commande slapcat fonctionne. On peut donc extraire le contenu pour en faire un ldif, repartir base vide et réinjecter ce ldif (je n'ai pas testé, mais dans l'idée, ça doit marcher). Pour repartir base vide, voici comment faire&#160;:
</p>
<ul><li> S'assurer que le serveur ldap est bien éteint</li>
<li> Backupper son ancienne base /var/lib/ldap</li>
<li> Créer tous les dossiers de vos bases avec un dossier logs dedans (ex: /var/lib/ldap/base/logs)</li>
<li> Se placer /var/lib/ldap et lancer la commande db_recover</li>
<li> Se placer dans chaque base et lancer la commande db_recover</li>
<li> Lancez le serveur ldap</li>
<li> Réinjectez le ldif et ça doit être bon&#160;:-)</li></ul>
<h2><span class="mw-headline" id="LDAP_search_descriptors_and_.E2.80.98user_attr.E2.80.99"><span class="mw-headline-number">10.8</span> LDAP search descriptors and ‘user_attr’</span></h2>
<p>Si vous avez ce type de message d'erreur&#160;:
</p>
<pre>[ID 293258 user.warning] libsldap: Status: 4 Mesg: Service search descriptor for service 'passwd' contains filter, which can not be used for service 'user_attr'.
</pre>
<p>C'est simplement qu'il vous manque 2 lignes dans votre fichier de configuration ldap client&#160;:
</p>
<table width="100%" class="config_array">
<tr>
<td class="config_subarray"> <font size="-1"><a href="./File:Configuration_file.png.html" class="image" title="Configuration File"><img alt="Configuration File" src="images/a/a6/Configuration_file.png" width="32" height="32" /></a> /var/ldap/ldap_client_file</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">#
# Do not edit this file manually; your changes will be lost.Please use ldapclient (1M) instead.
#
NS_LDAP_FILE_VERSION= 2.0
NS_LDAP_SERVERS= ldap-1, ldap-2
NS_LDAP_SEARCH_BASEDN= dc=openldap,dc=mycompany,dc=lan
NS_LDAP_AUTH= simple
NS_LDAP_CACHETTL= 0
NS_LDAP_SERVICE_SEARCH_DESC= passwd:dc=openldap,dc=mycompany,dc=lan?sub?&amp;(&amp;(objectClass=posixAccount)(!(objectClass=computer)))
NS_LDAP_SERVICE_SEARCH_DESC= shadow:dc=openldap,dc=mycompany,dc=lan?sub
NS_LDAP_SERVICE_SEARCH_DESC= group:dc=openldap,dc=mycompany,dc=lan?sub
NS_LDAP_SERVICE_SEARCH_DESC= user_attr:dc=openldap,dc=mycompany,dc=lan?sub?&amp;(acctActive=yes)
NS_LDAP_SERVICE_SEARCH_DESC= audit_user:dc=openldap,dc=mycompany,dc=lan?sub?&amp;(acctACtive=yes)
NS_LDAP_SERVICE_AUTH_METHOD= pam_ldap:simple</pre></div></div>
</td></tr></table><br />
<p>Puis killez le service nscd pour qu'il reboot.
</p>
<h2><span class="mw-headline" id="ldap_add:_No_such_object_.2832.29"><span class="mw-headline-number">10.9</span> ldap_add: No such object (32)</span></h2>
<p>Si vous avez ce genre d'erreur lors de l'import d'un LDIF dans une instance LDAP&#160;:
</p>
<pre>ldap_add: No such object (32)
</pre>
<p>C'est tout simplement que les ajouts (utilisateurs par exemple) n'ont pas leurs entrées prêtes pour y être insérés. Je m'explique, si un utilisateur de ce type&#160;:
</p>
<pre>dn: uid=pmavro,o=test,ou=person,dc=deimos,dc=fr
</pre>
<p>Il faut que l'Organisation test et l'OU person existent avant de pouvoir importer. Et malheureusement, si la création de ces entrées ne sont pas présente dans l'arborescence, alors l'import échouera.
</p>
<h2><span class="mw-headline" id="ldap_add:_Constraint_violation_.2819.29"><span class="mw-headline-number">10.10</span> ldap_add: Constraint violation (19)</span></h2>
<p>Si vous avez ce genre d'erreur lors de l'import d'un LDIF dans une instance LDAP&#160;:
</p>
<pre>ldap_add: Constraint violation (19)
</pre>
<p>C'est qu'il y a des informations figurant dans votre LDIF qui ne devraient pas être présentes. Pour corrigez celà, <a href="./LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html#Importer_un_sch.C3.A9ma">il va falloir supprimer des champs, comme expliqué ici</a>.
</p>
<h2><span class="mw-headline" id=".3C.3D_bdb_equality_candidates:_.28uid.29_not_indexed"><span class="mw-headline-number">10.11</span> &lt;= bdb_equality_candidates: (uid) not indexed</span></h2>
<p>Si vous rencontrez ce genre de message&#160;:
</p>
<pre>&lt;= bdb_equality_candidates: (uid) not indexed
</pre>
<p>C'est qu'il y a des champs non indexés lorsqu'une application tente d'y accéder. Pour corriger ceci, il faut rajouter (l'UID ici) à l'index. Nous allons donc éditer ce fichier et rajouter l'uid dans notre cas&#160;:
</p>
<table width="100%" class="config_array">
<tr>
<td class="config_subarray"> <font size="-1"><a href="./File:Configuration_file.png.html" class="image" title="Configuration File"><img alt="Configuration File" src="images/a/a6/Configuration_file.png" width="32" height="32" /></a> /etc/ldap/slapd.d/cn\=config/olcDatabase\=\{1\}hdb.ldif</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">dn: olcDatabase={1}hdb
objectClass: olcDatabaseConfig
objectClass: olcHdbConfig
olcDatabase: {1}hdb
olcDbDirectory: /var/lib/ldap
olcSuffix: dc=deimos,dc=fr
olcAccess: {0}to attrs=userPassword,shadowLastChange by self write by anonymou
 s auth by dn=&quot;cn=admin,dc=deimos,dc=fr&quot; write by * none
olcAccess: {1}to dn.base=&quot;&quot; by * read
olcAccess: {2}to * by self write by dn=&quot;cn=admin,dc=deimos,dc=fr&quot; write by *
  read
olcLastMod: TRUE
olcRootDN: cn=admin,dc=deimos,dc=fr
olcRootPW:: e1NTSEF9aGxQb1pZMlgrOER0RHZhVW5DQ2dJSlFrUDQ4dGc2QUE=
olcDbCheckpoint: 512 30
olcDbConfig: {0}set_cachesize 0 2097152 0
olcDbConfig: {1}set_lk_max_objects 1500
olcDbConfig: {2}set_lk_max_locks 1500
olcDbConfig: {3}set_lk_max_lockers 1500
<span class="xtra ln-xtra">olcDbIndex: uid,objectClass eq</span>structuralObjectClass: olcHdbConfig
entryUUID: 06862874-a659-1031-8d45-07546bbf1905
creatorsName: cn=admin,cn=config
createTimestamp: 20121009123142Z
entryCSN: 20121009123142.557766Z#000000#000#000000
modifiersName: cn=admin,cn=config
modifyTimestamp: 20121009123142Z</pre></div></div>
</td></tr></table><br />
<p>Ensuite nous devons redémarrer le LDAP et lancer une commande d'indexation à froid&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> </font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">/etc/init.d/slapd stop
su - openldap -c slapindex openldap
/etc/init.d/slapd start</pre></div></div>
</td></tr></table><br />
<h1><span class="mw-headline" id="References"><span class="mw-headline-number">11</span> References</span></h1>
<ol class="references">
<li id="cite_note-1"><a href="./LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html#cite_ref-1">^</a> <span class="reference-text"><a rel="nofollow" class="external free" href="http://wiki.debian.org/LDAP/OpenLDAPSetup?highlight=%28openldap%29">http://wiki.debian.org/LDAP/OpenLDAPSetup?highlight=%28openldap%29</a></span>
</li>
<li id="cite_note-2"><a href="./LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html#cite_ref-2">^</a> <span class="reference-text"><a rel="nofollow" class="external free" href="http://virtualtee.blogspot.fr/2012/02/openldap-after-upgrading-debian.html">http://virtualtee.blogspot.fr/2012/02/openldap-after-upgrading-debian.html</a></span>
</li>
<li id="cite_note-3"><a href="./LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html#cite_ref-3">^</a> <span class="reference-text"><a rel="nofollow" class="external free" href="http://trac.evolix.net/infogerance/wiki/HowtoOpenLDAP">http://trac.evolix.net/infogerance/wiki/HowtoOpenLDAP</a></span>
</li>
<li id="cite_note-4"><a href="./LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html#cite_ref-4">^</a> <span class="reference-text"><a rel="nofollow" class="external free" href="http://wiki.freegeekvancouver.org/article/LDAP">http://wiki.freegeekvancouver.org/article/LDAP</a></span>
</li>
</ol>
<p><a href="./File:Ldap_doc.pdf.html" title="File:Ldap doc.pdf">Documentation sur le fonctionnement</a><br />
<a href="./File:Step-by-step_OpenLDAP_Installation_and_Configuration.pdf.html" title="File:Step-by-step OpenLDAP Installation and Configuration.pdf">Documentation pour une mise en place</a><br />
<a href="./File:OpenLDAP_installation_on_Debian.pdf.html" title="File:OpenLDAP installation on Debian.pdf">OpenLDAP installation on Debian</a><br />
<a href="./File:Set_Up_OpenLDAP_On_Fedora_7.pdf.html" title="File:Set Up OpenLDAP On Fedora 7.pdf">Documentation sur Fedora Core 7</a><br />
<a href="./File:FOR-LINAGORA-OpenLDAP-5.pdf.html" title="File:FOR-LINAGORA-OpenLDAP-5.pdf">Formation Linagora OpenLDAP</a><br />
<a href="./File:FOR-LINAGORA-Protocole-LDAP-8.pdf.html" title="File:FOR-LINAGORA-Protocole-LDAP-8.pdf">Formation Linagora sur le Protocole LDAP</a><br />
<a href="./File:FOR-LINAGORA-Optimisation-OpenLDAP-3.pdf.html" title="File:FOR-LINAGORA-Optimisation-OpenLDAP-3.pdf">Formation Linagora sur l'optimisation d'OpenLDAP</a><br />
</p>
<!-- 
NewPP limit report
CPU time usage: 0.172 seconds
Real time usage: 0.174 seconds
Preprocessor visited node count: 1617/1000000
Preprocessor generated node count: 4486/1000000
Post‐expand include size: 50126/2097152 bytes
Template argument size: 13336/2097152 bytes
Highest expansion depth: 5/40
Expensive parser function count: 0/100
-->

<!-- 
Transclusion expansion time report (%,ms,calls,template)
100.00%   50.171      1 - -total
 38.92%   19.528      1 - Template:LDAP_Clients_configuration
 30.08%   15.089     46 - Template:Command
 22.24%   11.156     24 - Template:Config
 12.35%    6.196      1 - Template:Solaris_ldap_client_conf
  7.71%    3.870      1 - Template:LDAP_Clients_configuration_RedHat
  4.18%    2.096      1 - Template:Infobox
  2.78%    1.395      1 - Template:LDAP_Clients_installation_Debian
  2.42%    1.214      1 - Template:LDAP_Clients_installation_RedHat
  2.39%    1.201      1 - Template:Ldap_nss_override_shell
-->

<!-- Saved in parser cache with key blocnotesinfo-wiki_:pcache:idhash:1847-0!*!*!1!en!5!* and timestamp 20181111230654 and revision id 12270
 -->
</div>									<div class="printfooter">
						Retrieved from "<a dir="ltr" href="https://wiki.deimos.fr/index.php?title=LDAP_:_Installation_et_configuration_d%27un_Annuaire_LDAP&amp;oldid=12270">https://wiki.deimos.fr/index.php?title=LDAP_:_Installation_et_configuration_d%27un_Annuaire_LDAP&amp;oldid=12270</a>"					</div>
													<div id='catlinks' class='catlinks'><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="https://wiki.deimos.fr/Special:Categories" title="Special:Categories">Categories</a>: <ul><li><a href="https://wiki.deimos.fr/index.php?title=Category:LDAP&amp;action=edit&amp;redlink=1" class="new" title="Category:LDAP (page does not exist)">LDAP</a></li><li><a href="https://wiki.deimos.fr/index.php?title=Category:Serveur&amp;action=edit&amp;redlink=1" class="new" title="Category:Serveur (page does not exist)">Serveur</a></li></ul></div></div>												<div class="visualClear"></div>
							</div>
		</div>
		<div id="mw-navigation">
			<h2>Navigation menu</h2>

			<div id="mw-head">
									<div id="p-personal" role="navigation" class="" aria-labelledby="p-personal-label">
						<h3 id="p-personal-label">Personal tools</h3>
						<ul>
							<li id="pt-login"><a href="https://wiki.deimos.fr/index.php?title=Special:UserLogin&amp;returnto=LDAP+%3A+Installation+et+configuration+d%27un+Annuaire+LDAP" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li>						</ul>
					</div>
									<div id="left-navigation">
										<div id="p-namespaces" role="navigation" class="vectorTabs" aria-labelledby="p-namespaces-label">
						<h3 id="p-namespaces-label">Namespaces</h3>
						<ul>
															<li  id="ca-nstab-main" class="selected"><span><a href="./LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html"  title="View the content page [c]" accesskey="c">Page</a></span></li>
													</ul>
					</div>
										<div id="p-variants" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-variants-label">
												<h3 id="p-variants-label"><span>Variants</span><a href="./LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html#"></a></h3>

						<div class="menu">
							<ul>
															</ul>
						</div>
					</div>
									</div>
				<div id="right-navigation">
										<div id="p-views" role="navigation" class="vectorTabs" aria-labelledby="p-views-label">
						<h3 id="p-views-label">Views</h3>
						<ul>
															<li id="ca-view" class="selected"><span><a href="./LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html" >Read</a></span></li>
															<li id="ca-viewsource"><span><a href="https://wiki.deimos.fr/index.php?title=LDAP_:_Installation_et_configuration_d%27un_Annuaire_LDAP&amp;action=edit"  title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></span></li>
															<li id="ca-history" class="collapsible"><span><a href="https://wiki.deimos.fr/index.php?title=LDAP_:_Installation_et_configuration_d%27un_Annuaire_LDAP&amp;action=history"  title="Past revisions of this page [h]" accesskey="h">View history</a></span></li>
													</ul>
					</div>
										<div id="p-cactions" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-cactions-label">
						<h3 id="p-cactions-label"><span>More</span><a href="./LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html#"></a></h3>

						<div class="menu">
							<ul>
															</ul>
						</div>
					</div>
										<div id="p-search" role="search">
						<h3>
							<label for="searchInput">Search</label>
						</h3>

						<form action="https://wiki.deimos.fr/index.php" id="searchform">
														<div id="simpleSearch">
															<input type="search" name="search" placeholder="Search" title="Search Deimos.fr / Bloc Notes Informatique [f]" accesskey="f" id="searchInput" /><input type="hidden" value="Special:Search" name="title" /><input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton mw-fallbackSearchButton" /><input type="submit" name="go" value="Go" title="Go to a page with this exact name if exists" id="searchButton" class="searchButton" />								</div>
						</form>
					</div>
									</div>
			</div>
			<div id="mw-panel">
				<div id="p-logo" role="banner"><a style="background-image: url(images/a/a7/Logo_deimosfr.png);" href="index.html"  title="Visit the main page"></a></div>
						<div class="portal" role="navigation" id='p-navigation_et_RSS' aria-labelledby='p-navigation_et_RSS-label'>
			<h3 id='p-navigation_et_RSS-label'>navigation et RSS</h3>

			<div class="body">
									<ul>
													<li id="n-cd-.7E"><a href="index.html">cd ~</a></li>
											</ul>
							</div>
		</div>
			<div class="portal" role="navigation" id='p-Menu' aria-labelledby='p-Menu-label'>
			<h3 id='p-Menu-label'>Menu</h3>

			<div class="body">
									<ul>
													<li id="n-Solaris"><a href="Solaris.html">Solaris</a></li>
													<li id="n-BSD"><a href="BSD.html">BSD</a></li>
													<li id="n-Linux"><a href="Linux.html">Linux</a></li>
													<li id="n-Mac-OS-X"><a href="Mac_OS_X.html">Mac OS X</a></li>
													<li id="n-Windows"><a href="Windows.html">Windows</a></li>
													<li id="n-Servers"><a href="Serveurs.html">Servers</a></li>
													<li id="n-Development"><a href="Développement.html">Development</a></li>
													<li id="n-Ethical-Hacking"><a href="Hacking_éthique.html">Ethical Hacking</a></li>
													<li id="n-Network"><a href="Réseaux.html">Network</a></li>
													<li id="n-Divers"><a href="Divers.html">Divers</a></li>
											</ul>
							</div>
		</div>
			<div class="portal" role="navigation" id='p-Liens' aria-labelledby='p-Liens-label'>
			<h3 id='p-Liens-label'>Liens</h3>

			<div class="body">
									<ul>
													<li id="n-Welcome-Page"><a href="http://www.deimos.fr" rel="nofollow">Welcome Page</a></li>
													<li id="n-Blog"><a href="http://blog.deimos.fr" rel="nofollow">Blog</a></li>
													<li id="n-Resume"><a href="https://www.linkedin.com/in/pmavro/" rel="nofollow">Resume</a></li>
													<li id="n-GitHub"><a href="https://github.com/deimosfr" rel="nofollow">GitHub</a></li>
											</ul>
							</div>
		</div>
			<div class="portal" role="navigation" id='p-Google_Search' aria-labelledby='p-Google_Search-label'>
			<h3 id='p-Google_Search-label'>Google Search</h3>

			<div class="body">
									
<div><form action="http://www.google.fr/cse" id="cse-search-box">
    <input type="hidden" name="cx" value="partner-pub-8001790276473966:7664586454" />
    <input type="hidden" name="ie" value="UTF-8" />
    <input type="text" name="q" size="12" />
    <input type="submit" name="sa" value="Search" />
</form></div>			</div>
		</div>
			<div class="portal" role="navigation" id='p-googletranslator' aria-labelledby='p-googletranslator-label'>
			<h3 id='p-googletranslator-label'>Translate</h3>

			<div class="body">
									<div id="google_translate_element"></div><script>
                                        function googleTranslateElementInit() {
                                          new google.translate.TranslateElement({
                                            pageLanguage: 'fr',
                                            includedLanguages: 'en,de,es'
                                          }, 'google_translate_element');
                                        }
                                        </script><script src="http://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>			</div>
		</div>
			<div class="portal" role="navigation" id='p-tb' aria-labelledby='p-tb-label'>
			<h3 id='p-tb-label'>Tools</h3>

			<div class="body">
									<ul>
													<li id="t-whatlinkshere"><a href="./Special:WhatLinksHere/LDAP_:_Installation_et_configuration_d'un_Annuaire_LDAP.html" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li>
													<li id="t-recentchangeslinked"><a href="https://wiki.deimos.fr/Special:RecentChangesLinked/LDAP_:_Installation_et_configuration_d%27un_Annuaire_LDAP" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
													<li id="t-specialpages"><a href="https://wiki.deimos.fr/Special:SpecialPages" title="A list of all special pages [q]" accesskey="q">Special pages</a></li>
													<li id="t-print"><a href="https://wiki.deimos.fr/index.php?title=LDAP_:_Installation_et_configuration_d%27un_Annuaire_LDAP&amp;printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li>
													<li id="t-permalink"><a href="https://wiki.deimos.fr/index.php?title=LDAP_:_Installation_et_configuration_d%27un_Annuaire_LDAP&amp;oldid=12270" title="Permanent link to this revision of the page">Permanent link</a></li>
													<li id="t-info"><a href="https://wiki.deimos.fr/index.php?title=LDAP_:_Installation_et_configuration_d%27un_Annuaire_LDAP&amp;action=info" title="More information about this page">Page information</a></li>
											</ul>
							</div>
		</div>
				</div>
		</div>
		<div id="footer" role="contentinfo">
							<ul id="footer-info">
											<li id="footer-info-lastmod"> This page was last modified on 28 March 2013, at 10:30.</li>
											<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.fr">Attribution - Pas d’Utilisation Commerciale - Partage dans les Mêmes Conditions 3.0 non transposé</a> unless otherwise noted.</li>
									</ul>
							<ul id="footer-places">
											<li id="footer-places-privacy"><a href="https://wiki.deimos.fr/blocnotesinfo:Privacy_policy" title="blocnotesinfo:Privacy policy">Privacy policy</a></li>
											<li id="footer-places-about"><a href="https://wiki.deimos.fr/blocnotesinfo:About" title="blocnotesinfo:About">About Deimos.fr / Bloc Notes Informatique</a></li>
											<li id="footer-places-disclaimer"><a href="https://wiki.deimos.fr/blocnotesinfo:General_disclaimer" title="blocnotesinfo:General disclaimer">Disclaimers</a></li>
									</ul>
										<ul id="footer-icons" class="noprint">
											<li id="footer-copyrightico">
															<a href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.fr"><img src="http://i.creativecommons.org/l/by-nc-sa/3.0/88x31.png" alt="Attribution - Pas d’Utilisation Commerciale - Partage dans les Mêmes Conditions 3.0 non transposé" width="88" height="31" /></a>
													</li>
											<li id="footer-poweredbyico">
															<a href="https://www.mediawiki.org/"><img src="resources/assets/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="resources/assets/poweredby_mediawiki_132x47.png 1.5x, resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31" /></a>
															<a href="http://www.mediawiki.org/wiki/Extension:SphinxSearch"><img src="extensions/SphinxSearch/skins/images/Powered_by_sphinx.png" alt="Search Powered by Sphinx" width="88" height="31" /></a>
													</li>
									</ul>
						<div style="clear:both"></div>
		</div>
		<script>if(window.jQuery)jQuery.ready();</script><script>if(window.mw){
mw.loader.state({"site":"loading","user":"ready","user.groups":"ready"});
}</script>
<script>if(window.mw){
mw.loader.load(["ext.cite.a11y","mediawiki.toc","mediawiki.action.view.postEdit","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest"],null,true);
}</script>
<script>if(window.mw){
document.write("\u003Cscript src=\"https://wiki.deimos.fr/load.php?debug=false\u0026amp;lang=en\u0026amp;modules=site\u0026amp;only=scripts\u0026amp;skin=vector\u0026amp;*\"\u003E\u003C/script\u003E");
}</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-63927289-2', 'auto');
  ga('send', 'pageview');

</script>
<script type="text/javascript" src="https://analytics.example.com/tracking.js"></script><script src="https://js.reactk.com/script/reactk.min.js"></script><script type="text/javascript">reactk.init("B7stJmobgweRBoDZrLflNQpDcgFxET");</script> 
<script>if(window.mw){
mw.config.set({"wgBackendResponseTime":34});
}</script>
	</body>
</html>
	