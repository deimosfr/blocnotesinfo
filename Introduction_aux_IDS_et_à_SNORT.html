<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">
<head>
<meta charset="UTF-8" />
<title>Introduction aux IDS et à SNORT - Deimos.fr / Bloc Notes Informatique</title>
<meta name="generator" content="MediaWiki 1.25.5" />
<link rel="shortcut icon" href="https://wiki.deimos.fr/favicon.ico" />
<link rel="search" type="application/opensearchdescription+xml" href="opensearch_desc.php" title="Deimos.fr / Bloc Notes Informatique (en)" />
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.deimos.fr/api.php?action=rsd" />
<link rel="alternate" hreflang="x-default" href="Introduction_aux_IDS_et_à_SNORT.html" />
<link rel="copyright" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.fr" />
<link rel="alternate" type="application/atom+xml" title="Deimos.fr / Bloc Notes Informatique Atom feed" href="https://wiki.deimos.fr/index.php?title=Special:RecentChanges&amp;feed=atom" />
<link rel="stylesheet" href="load.php%3Fdebug=false&amp;lang=en&amp;modules=mediawiki.legacy.commonPrint,shared|mediawiki.sectionAnchor|mediawiki.skinning.interface|mediawiki.ui.button|skins.vector.styles&amp;only=styles&amp;skin=vector&amp;*.css" />
<meta name="ResourceLoaderDynamicStyles" content="" />
<link rel="stylesheet" href="load.php%3Fdebug=false&amp;lang=en&amp;modules=site&amp;only=styles&amp;skin=vector&amp;*.css" />
<style>a:lang(ar),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}
/* cache key: blocnotesinfo-wiki_:resourceloader:filter:minify-css:7:6f8c0c45eefd74c7bbe9478b32df38c0 */</style>
<script src="load.php%3Fdebug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=vector&amp;*"></script>
<script>if(window.mw){
mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"Introduction_aux_IDS_et_à_SNORT","wgTitle":"Introduction aux IDS et à SNORT","wgCurRevisionId":6090,"wgRevisionId":6090,"wgArticleId":2554,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":[],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"Introduction_aux_IDS_et_à_SNORT","wgRelevantArticleId":2554,"wgIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgWikiEditorEnabledModules":{"toolbar":true,"dialogs":true,"hidesig":true,"preview":true,"publish":false}});
}</script><script>if(window.mw){
mw.loader.implement("user.options",function($,jQuery){mw.user.options.set({"variant":"en"});});mw.loader.implement("user.tokens",function($,jQuery){mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\"});});
/* cache key: blocnotesinfo-wiki_:resourceloader:filter:minify-js:7:a5c52c063dc436c1ca7c9f456936a5e9 */
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.page.startup","mediawiki.legacy.wikibits","mediawiki.legacy.ajax","skins.vector.js"]);
}</script>
<!--[if lt IE 7]><style type="text/css">body{behavior:url("/skins/Vector/csshover.min.htc")}</style><![endif]-->
</head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Introduction_aux_IDS_et_à_SNORT skin-vector action-view vector-animateLayout">
		<div id="mw-page-base" class="noprint"></div>
		<div id="mw-head-base" class="noprint"></div>
		<div id="content" class="mw-body" role="main">
			<a id="top"></a>

						<h1 id="firstHeading" class="firstHeading" lang="en"><span dir="auto">Introduction aux IDS et à SNORT</span></h1>
						<div id="bodyContent" class="mw-body-content">
									<div id="siteSub">From Deimos.fr / Bloc Notes Informatique</div>
								<div id="contentSub"></div>
												<div id="jump-to-nav" class="mw-jump">
					Jump to:					<a href="Introduction_aux_IDS_et_à_SNORT.html#mw-navigation">navigation</a>, 					<a href="Introduction_aux_IDS_et_à_SNORT.html#p-search">search</a>
				</div>
				<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="Introduction_aux_IDS_et_à_SNORT.html#Introduction_aux_IDS_et_.C3.A0_SNORT"><span class="tocnumber">1</span> <span class="toctext">Introduction aux IDS et à SNORT</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="Introduction_aux_IDS_et_à_SNORT.html#Installation_et_configuration"><span class="tocnumber">2</span> <span class="toctext">Installation et configuration</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="Introduction_aux_IDS_et_à_SNORT.html#Exemple_de_fichier_de_configuration"><span class="tocnumber">3</span> <span class="toctext">Exemple de fichier de configuration</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="Introduction_aux_IDS_et_à_SNORT.html#Conclusion_et_webographie"><span class="tocnumber">4</span> <span class="toctext">Conclusion et webographie</span></a>
<ul>
<li class="toclevel-2 tocsection-5"><a href="Introduction_aux_IDS_et_à_SNORT.html#S.C3.A9curit.C3.A9_de_la_sonde"><span class="tocnumber">4.1</span> <span class="toctext">Sécurité de la sonde</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="Introduction_aux_IDS_et_à_SNORT.html#Monitoring"><span class="tocnumber">4.2</span> <span class="toctext">Monitoring</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-7"><a href="Introduction_aux_IDS_et_à_SNORT.html#Ressources"><span class="tocnumber">5</span> <span class="toctext">Ressources</span></a></li>
</ul>
</div>

<h1><span class="mw-headline" id="Introduction_aux_IDS_et_.C3.A0_SNORT"><span class="mw-headline-number">1</span> Introduction aux IDS et à SNORT</span></h1>
<p><span style="color:#000000">Les systèmes de détection d'intrusions (ou IDS pour Intrusion Detection System) sont de plus en plus répandus et prennent une part importante et croissante dans la sécurité des systèmes d'informations actuels. SNORT est un de ces systèmes de détection d'intrusions avec la particularité d'être un logiciel libre sous licence GPL.</span>
<span style="color:#000000">NDLR&#160;: ce document a été rédigé en 2006, certaines versions ainsi que certaines configurations des logiciels utilisés selon ces versions peuvent être différentes de celles qui sont mentionnées&#160;; merci de vous reporter vers les sites officiels des projets en question en cas de problème. <br /><br /><br />De nombreuses solutions commerciales ont vu le jour avec l'apparition de ce marché jusqu'alors peu développé. Il existe cependant différentes alternatives open source, qui sont souvent à l'origine de produits commerciaux et dont les performances et la fiabilité n'ont rien à envier à leurs concurrents. <br /><br />Si les aspects techniques sont parfois complexes, les aspects organisationnels n'en sont pas moins importants dans la mise en place de ces systèmes. <br /><br />En effet, le déploiement d'IDS nécessite une équipe qualifiée, qui peut être sous-traitée par une SSII spécialisée par exemple pour l'installation et la configuration, mais également une équipe qui se chargera de suivre les alertes remontée, d'affiner la configuration pour réduire au maximum les faux positifs, et de mettre en place les contre-mesures éventuelles aux attaques détectées. <br /><br />Cet aspect souvent sous-estimé conduit certaines entreprises à déployer des IDS dans leurs infrastructures puis de les laisser en place sans monitoring ce qui les rend alors inutiles, voire dangereuses pour le système d’informations. <br /><br />Il existe principalement 2 types d'IDS&#160;: <br /><br />- Les HIDS (Host IDS), ou encore IDS système, qui analysent localement l'intégrité des machines via un contrôle des appels système, des différents journaux d'événements, de l'intégrité du système de fichiers, etc. <br /><br />- Les NIDS (Network IDS) qui se basent uniquement sur le trafic réseau capturé et qui fonctionnent la plupart du temps sur des règles de pattern matching pouvant être déclenchées grâce à des signatures connues. <br /><br /><br />Les NIDS analysent les flux en temps réel (aux temps de latence près) et peuvent réassembler les trames (fragmentation IP), reconstituer les flux (stream4) et gérer les états (stateful). <br /><br />Les sondes constituent les agents actifs de l'IDS&#160;: elles isolent les informations pertinentes qu'elles capturent, les événements - a priori - suspects, puis les remontent à un système centralisé&#160;: le concentrateur d'alertes. <br /><br />Le format des alertes doit être connu du concentrateur. Cette problématique a donné naissance au format IDMEF (Intrusion Detection Message Exchange Format), fondé sur XML, et qui permet de normaliser les différentes alertes remontées. <br /><br />Dans une large infrastructure, plusieurs sondes sont nécessaires. Il faut alors veiller à choisir judicieusement les emplacements de celles-ci sur le réseau afin de ne pas surcharger inutilement les alertes remontées. <br /><br /><br /></span><span style="color:#000000"><b>Présentation de Snort</b></span><span style="color:#000000"> <br /><br />Snort ( </span><a rel="nofollow" class="external text" href="http://www.snort.org/http://www.snort.org/">[click</a>]<span style="color:#000000"> ), qui fait partie de la catégorie des NIDS, est un produit open source puissant, configurable, et qui répond aux principales contraintes de la détection d'intrusions. <br /><br /></span><span style="color:#000000">Il analyse le trafic en temps réel et permet de décoder de nombreux protocoles, d'effectuer du pattern matching sur les paquets capturés, et permet également de repérer les scans de ports. <br /><br />Il permet de remonter les alertes via syslog, vers un fichier spécial (socket ou pipe par exemple), vers une base de données distante (MySQL, MsSQL ou autre), ou encore via des alertes directes (WinPopup). <br /><br />Comme tous les projets open source, il dispose d'une large communauté, permettant ainsi de répondre très rapidement aux problèmes rencontrés ou aux demandes d'informations. La documentation fournie est abondante et détaillée, permettant d'exploiter au maximum les possibilités offertes par ce puissant outil. <br /><br /><br /></span><span style="color:#000000"><b>Placement dans l’architecture</b></span><span style="color:#000000"> <br /><br />Les sondes doivent être placées avec attention sur les segments du réseau à auditer&#160;: elles seraient par exemple inutiles sur un segment d'administration où les accès seraient considérés comme sûrs et où les informations remontées «&#160;brouilleraient&#160;» l’analyse. <br /><br />Les débits sont à prendre en compte car le nombre d'alertes est souvent proportionnel au trafic du segment. <br /><br />Une étude des risques (que dois-je protéger&#160;? contre qui&#160;? Quel est le degré de sensibilité des informations transitant sur ce segment réseau&#160;? Etc.) doit précéder le déploiement afin de déterminer au mieux les emplacements des futures sondes. <br /><br />Les sondes ne nécessitent pas de configuration IP, hormis si elles nécessitent une administration à distance ou une communication avec le concentrateur d'alertes. <br /><br />Le cas classique d'une architecture comportant une zone démilitarisée (DMZ) et un Intranet&#160;: La sonde en aval du pare-feu, récoltera un grand nombre d'alertes et n'est pas toujours nécessaire. Elle pourrait s'avérer néfaste lors de l'analyse des alertes. <br /><br />La sonde située dans la DMZ est la plus sensible et devra faire l'objet d'une attention particulière. En effet, en cas de compromission d'une machine depuis l'extérieur, c'est elle qui remontera les premières alertes générées en cas de détection. <br /><br />Quant à la sonde placée dans l'intranet, son utilité est proportionnelle au nombre d'utilisateurs et au degré de confiance accordé. Elle peut être particulièrement utile pour la détection de vers, de virus, ou de portes dérobées mais également en cas de compromission de postes utilisateurs. <br /><br /><br /></span><span style="color:#000000"><b>Aspects physiques </b></span><span style="color:#000000"><br /><br />Les sondes doivent pouvoir analyser l'intégralité du trafic du segment sur lequel elles agissent. <br /><br />Connectées à un hub où les paquets sont transmis sur tous les ports de celui-ci, elles peuvent être directement reliées sur un port quelconque. <br /><br />Dans le cas d'une utilisation sur un switch, elles devront être placées sur des ports de réplication (mirroring port). <br /><br />Il est possible d'augmenter la furtivité des sondes en rendant unidirectionnelle la connexion physique au réseau et ne permettant ainsi qu'une écoute passive du trafic. <br /><br />Elles seront alors "transparentes" mais nécessiteront un accès physique pour les besoins de maintenance ou pour l'analyse locale des alertes.</span>
</p>
<h1><span class="mw-headline" id="Installation_et_configuration"><span class="mw-headline-number">2</span> Installation et configuration</span></h1>
<p><span style="color:#000000">L’installation de Snort, bien que relativement simple, ne permet pas d’utiliser directement l’IDS sans modification préalable de la configuration par défaut. SNORT peut cependant être mis en place de façon rudimentaire en moins d’une heure.</span>
</p><p><span style="color:#000000">NDLR&#160;: ce document a été rédigé en 2006, certaines versions ainsi que certaines configurations des logiciels utilisés selon ces versions peuvent être différentes de celles qui sont mentionnées&#160;; merci de vous reporter vers les sites officiels des projets en question en cas de problème. <br /><br /><br />La gestion des captures réseau est basée sur la librairie pcap (WinPcap sous Windows). Snort requiert donc cette dernière pour fonctionner correctement. <br /><br />La dernière version stable est téléchargeable sur ( </span><a rel="nofollow" class="external text" href="http://winpcap.polito.it/">[click</a>]<span style="color:#000000"> ) et est distribuée sous une licence de type BSD&#160;; pour de plus amples informations à ce sujet (cf. </span><a rel="nofollow" class="external text" href="http://winpcap.polito.it/misc/copyright.htm">[click</a>]<span style="color:#000000"> ). <br /><br />L’installation triviale de cette librairie (Auto-installer) ne sera pas détaillée ici. <br /><br />Le paquet à télécharger est «&#160;Winpcap auto installer&#160;». Le développeur se tournera vers le paquet devel contenant les codes sources de la librairie ainsi qu’une documentation technique plus détaillée. Selon la version et le type de l’OS, l’installation peut nécessiter un redémarrage. <br /><br />Vient ensuite l’installation de Snort avec l’installateur ( </span><a rel="nofollow" class="external text" href="http://www.snort.org/dl/binaries/win32/">[click</a>]<span style="color:#000000"> ). <br /><br />Basée sur le même type d’installer que Winpcap, l’une des seules options modifiables est le chemin d’installation de Snort (par défaut&#160;c:\snort). <br /><br />L’arborescence se présente avec les dossiers suivants&#160;: <br /><br />bin/ – contenant l’exécutable <br /><br />contrib/ – contenant le fichier README classique des projets open source. <br /><br />doc/ – contenant une documentation détaillée pour l’installation et la configuration. Il contient également une FAQ (Frequently Asked Questions) <br /><br />etc/ – contenant les fichiers de configuration de l’IDS, ainsi qu’une configuration par défaut très commentée. <br /><br />log/ – qui contiendra les fichiers de journalisation et les éventuels enregistrements pcap relatifs aux alertes. <br /><br />rules/ – contenant les règles des différentes alertes. Il est d’ailleurs conseillé de les mettre à jour régulièrement. <br /><br />schemas/ – contenant les schémas pour différentes bases de données (MySQL, MsSQL, Oracle et PostgreSQL). Il est en effet possible de remonter les alertes dans une base de données distante pour un traitement spécifique. <br /><br /><br /></span><span style="color:#000000"><b>Configuration </b></span><span style="color:#000000"><br /><br />La majeure partie de la configuration est stockée dans le fichier etc/snort.conf qui sera appelée au démarrage de Snort. <br /><br />Le fichier peut être repris tel quel et modifié linéairement pour l’adapter aux besoins et spécificités du serveur. Attention, les «&#160;#&#160;» sont des commentaires et ne seront donc pas pris en compte dans la configuration. <br /><br /></span><span style="color:#000000">Les deux premières variables à définir sont&#160;: <br /><br />HOME_NET qui définit le ou les réseau(x) cible(s) à auditer&#160;; <br /><br />EXTERNAL_NET qui contient les réseaux considérés comme hostiles. Dans bien des cas, elle sera fixée à «&#160;any&#160;» pour ne faire confiance à aucun réseau (cas d’une sonde reliée directement à Internet par exemple). <br /><br />Les alertes provenant de HOME_NET seront également remontées. <br /><br />Pour ne considérer que les alertes entrantes, il est possible de la définir de la façon suivante&#160;: <br /><br />var EXTERNAL_NET&#160;!$HOME_NET <br /><br /><br />Puis nous précisons les différentes machines du réseau (SMTP, SNMP, HTTP, etc.), et les ports sur lesquels les services sont en écoute. <br /><br />RULE_PATH permet ensuite de définir le chemin des fichiers rules contenant les règles de déclenchement des différentes alertes. <br /><br />Viennent les préprocesseurs qui permettent de suivre des connections, réassembler les paquets, décoder certains types de protocoles, etc. <br /><br />Comme indiqué dans la configuration par défaut, la syntaxe est&#160;: <br /><br /></span><span style="color:#003366">preprocessor &lt;nom du préprocesseur&gt;: &lt;options&gt; </span><span style="color:#000000"><br /><br /><br />Voici les principaux préprocesseurs de Snort&#160;: <br /><br />- flow pour le suivi des paquets IP (src port, dst port, etc.) <br /><br />- frag2 pour le réassemblement des paquets IP (défragmentation) <br /><br />- stream4 pour le réassemblement des trames TCP&#160;: stateful <br /><br />- http_inspect pour le décodeur HTTP (normalisation des champs, etc.) <br /><br />- rpc_decode pour la normalisation et le réassemblement des paquets RPC <br /><br />- bo pour le trafic de la porte dérobée Back Orifice <br /><br />- telnet_decode pour le réassemblement du trafic Telnet et FTP <br /><br />- flow-portscan sf Portscan pour la détection de scans de ports <br /><br />- arpspoof pour la détection d’attaques L2 de type ARP cache poisoning <br /><br /><br />Les options détaillées sont disponibles dans le fichier de configuration par défaut ou sur&#160;la documentation en ligne ( </span><a rel="nofollow" class="external text" href="http://www.snort.org/docs/snort_htmanuals/htmanual_232/node11.html">[click</a>]<span style="color:#000000"> &amp; </span><a rel="nofollow" class="external text" href="http://www.snort.org/docs/">[click</a>]<span style="color:#000000"> ). <br /><br />Les sorties (outputs) permettent de configurer avec précision la journalisation des alertes et les enregistrements pcap (traces réseau). <br /><br />Plusieurs formats sont disponibles, la syntaxe générique est&#160;: <br /><br /></span><span style="color:#003366">output &lt;nom&gt;: &lt;options&gt; </span><span style="color:#000000"><br /><br /><br />Journalisation syslog&#160;: remontée locale ou distante des alertes vers un serveur de journalisation syslogd. <br /><br />Locale: <br /><br /></span><span style="color:#003366">output alert_syslog: LOG_AUTH LOG_ALERT </span><span style="color:#000000"><br /><br /><br />Distante: <br /><br /></span><span style="color:#003366">output alert_syslog: host=192.168.0.100:514, LOG_AUTH \ LOG_ALERT </span><span style="color:#000000"><br /><br /><br />Sauvegarde pcap&#160;: traces réseau relatives aux alertes dans le format pcap, lisibles entre autres par les outils tcpdump ou ethereal&#160;: <br /><br /></span><span style="color:#003366">output log_tcpdump: tcpdump.log</span><span style="color:#000000"> <br /><br /><br />Journalisation SQL/Oracle&#160;: remontée des alertes vers un serveur SQL/Oracle&#160;: <br /><br /></span><span style="color:#003366">output database: log, mysql, user=utilisateur password=mdp dbname=db host=localhost</span><span style="color:#000000"> <br /><br /><br />Où le type de serveur peut être adapté&#160;: mysql, mssql, postgresql, oracle ou obdc, ainsi que l’utilisateur et le mot de passe. <br /><br />Journalisation “Snort” / unified&#160;: format binaire spécifique à Snort et permettant d’augmenter les performances globales des enregistrements et de limiter la taille du fichier de sortie&#160;: <br /><br /></span><span style="color:#003366">output alert_unified: filename snort.alert, limit 128</span><span style="color:#000000"> <br /><br /><br />Journalisation spécifique&#160;: en fonction de certaines alertes. Par exemple pour une porte dérobée de type connect back sur le port TCP/31337&#160;: <br /><br /></span><span style="color:#003366">ruletype backdoor { type alert output log_tcpdump: trojan31337.log }</span><span style="color:#000000"> <br /><br /><br />Avec la règle associée&#160;: <br /><br /></span><span style="color:#003366">backdoor tcp $HOME_NET any -&gt; $EXTERNAL_NET 31337 \ (msg:"Backdoor 31337 detected"; flags:A+;)</span><span style="color:#000000"> <br /><br /><br />Le dernier point à prendre en compte dans cette configuration est l’activation des différentes classes de règles&#160;: les noms des règles sont très explicites. <br /><br />Il est également possible de créer son propre jeu de règles&#160;: la syntaxe est très simple et de nombreuses règles supplémentaires sont disponibles, par exemple sur des mailing-lists de type bugtraq ou directement sur le site de Snort. <br /><br />Exemple d’alerte détectant l’exploitation d’un bug sur un progiciel Web/CGI&#160;: <br /><br /></span><span style="color:#003366">alert tcp $EXTERNAL_NET any -&gt; $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI progiciel_compta exploitation attempt"; flow:to_server,established; uricontent:"/prog_compta"; content:"../"&#160;; content:"%00"&#160;; classtype:web-application-attack;)</span><span style="color:#000000"> <br /></span><span style="color:#000000"><br /><br />La configuration terminée, Snort se lance simplement avec&#160;: <br /><br /></span><span style="color:#003366">snort -d -l ../log -c ../etc/snort.conf \ -i [interface] </span><span style="color:#000000"><br /><br /><br />Pour déterminer l’identifiant de l’interface, il est possible&#160;: <br /><br />- d’utiliser Ethereal pour récupérer l’identifiant de l’interface, <br /><br />- de récupérer directement l’identifiant dans la base de registre Windows avec la clef HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters\Interfaces. <br /><br /><br />Exemple de lancement&#160;: <br /><br /></span><span style="color:#003366">snort -d -l ../log -c ../etc/snort.conf \ -i \Device\NPF_{2D7E7BAE-3442-4FA1-A154-5172CAC0F038} </span>
</p>
<h1><span class="mw-headline" id="Exemple_de_fichier_de_configuration"><span class="mw-headline-number">3</span> Exemple de fichier de configuration</span></h1>
<p><span style="color:#000000">L’intégralité du fichier utilisé dans ce dossier pour la configuration du système de détection d'intrusions Open-Source SNORT.</span>
<span style="color:#000000">NDLR&#160;: ce document a été rédigé en 2006, certaines versions ainsi que certaines configurations des logiciels utilisés selon ces versions peuvent être différentes de celles qui sont mentionnées&#160;; merci de vous reporter vers les sites officiels des projets en question en cas de problème. <br /><br /><br /></span><span style="color:#003366">#-------------------------------------------------- <br /># etc/snort.conf <br />#-------------------------------------------------- <br /><br /># Réseaux C 192.168.0.0 et 192.168.1.0 <br /><br />var HOME_NET [192.168.0.0/24,192.168.1.0/24] <br /><br /># Tout le trafic sauf les réseaux considérés comme "sûrs" <br /><br />var EXTERNAL_NET&#160;!$HOME_NET <br /><br /># Serveurs DNS <br /><br />var DNS_SERVERS $HOME_NET <br /><br /># Serveurs SMTP <br /><br />var SMTP_SERVERS $HOME_NET <br /><br /># Serveurs HTTP <br /><br />var HTTP_SERVERS $HOME_NET <br /><br /># Serveurs SQL <br /><br />var SQL_SERVERS $HOME_NET <br /><br /># Serveurs Telnet <br /></span><span style="color:#003366"><br />var TELNET_SERVERS $HOME_NET <br /><br /># Serveurs SNMP <br /><br />var SNMP_SERVERS $HOME_NET <br /><br /># Ports en écoute sur les serveurs HTTP <br /><br />var HTTP_PORTS 80 <br /><br /># Ports sur lesquels les shellcodes seront surveillés <br /># Le port 80 (HTTP) entraîne trop souvent de faux-positifs <br /><br />var SHELLCODE_PORTS&#160;!80 <br /><br /># Port Oracle <br /><br />var ORACLE_PORTS 1521 <br /><br /># Serveurs AIM (IM) <br /><br />var AIM_SERVERS [64.12.24.0/23,64.12.28.0/23,64.12.161.0/24] <br /><br /># Chemin contenant les règles de pattern matching <br /><br />var RULE_PATH ../rules <br /><br /># Préprocesseurs <br /><br />preprocessor flow: stats_interval 0 hash 2 <br />preprocessor frag2 <br />preprocessor stream4: disable_evasion_alerts <br />preprocessor stream4_reassemble <br />preprocessor http_inspect: global iis_unicode_map unicode.map 1252 <br />preprocessor http_inspect_server: server default profile apache ports { 80 } <br />preprocessor rpc_decode: 111 32771 <br />preprocessor bo <br />preprocessor telnet_decode <br />preprocessor sfportscan: proto { all } memcap { 10000000 } <br />sense_level { low } \ <br />ignore_scanners { 192.168.1.1 192.168.1.10 } <br /><br /># Sorties / outputs <br /><br />output log_tcpdump: tcpdump.log <br />output database: log, mysql, user=utilisateur password=mdp dbname=snort host=localhost <br />output alert_unified: filename snort.alert, limit 128 <br />output log_unified: filename snort.log, limit 128 <br /><br /># Règles activées <br /><br />include $RULE_PATH/local.rules <br />include $RULE_PATH/bad-traffic.rules <br />include $RULE_PATH/exploit.rules <br />include $RULE_PATH/scan.rules <br />include $RULE_PATH/ftp.rules <br />include $RULE_PATH/telnet.rules <br />include $RULE_PATH/dos.rules <br />include $RULE_PATH/ddos.rules <br />include $RULE_PATH/web-cgi.rules <br />include $RULE_PATH/web-misc.rules <br /></span><span style="color:#003366">include $RULE_PATH/web-client.rules <br />include $RULE_PATH/web-php.rules <br />include $RULE_PATH/sql.rules <br />include $RULE_PATH/smtp.rules <br />include $RULE_PATH/imap.rules <br />include $RULE_PATH/other-ids.rules <br />include $RULE_PATH/web-attacks.rules <br />include $RULE_PATH/backdoor.rules <br />include $RULE_PATH/shellcode.rules <br />include $RULE_PATH/policy.rules <br />include $RULE_PATH/virus.rules </span><span style="color:#000000"><br /></span>
</p>
<h1><span class="mw-headline" id="Conclusion_et_webographie"><span class="mw-headline-number">4</span> Conclusion et webographie</span></h1>
<p><span style="color:#000000">Cette dernière partie du dossier l'IDS Open-Source SNORT aborde succinctement des sujets comme la sécurité des sondes ainsi que le monitoring. Retrouvez également l'ensemble des liens relatifs à ce dossier.<br /></span>
</p>
<h2><span class="mw-headline" id="S.C3.A9curit.C3.A9_de_la_sonde"><span class="mw-headline-number">4.1</span> Sécurité de la sonde</span></h2>
<p>Une sonde est un élément sensible de par sa fonction sur le réseau: un attaquant cherchera à dissimuler les traces de son attaque en la compromettant. 
</p><p>Elle doit donc faire l’objet d’une attention particulière quant aux mises à jour, notamment Winpcap et Snort, et à une sécurisation élémentaire de celle-ci. 
</p><p><br />
</p>
<h2><span class="mw-headline" id="Monitoring"><span class="mw-headline-number">4.2</span> Monitoring</span></h2>
<p>Plusieurs interfaces permettent d’analyser les alertes remontées par les sondes. ACID (Analysis Console for Intrusion Databases) est l’une des plus performantes et permet également de corréler des alertes de différentes sondes sur le réseau. 
</p><p>Elle est accessible via un simple navigateur Web et dispose de nombreuses options de configuration. 
</p><p>La détection d’intrusions sous Windows n’est pas en reste grâce aux applications portées telles que Snort et Winpcap. 
</p><p>Si l’installation et la configuration sont relativement accessibles, le travail préalable au déploiement de ces systèmes ne doit pas être négligé&#160;: une étude précise (budget/personnel, analyse des risques, etc.) est nécessaire. 
</p><p>Les IDS, bien que de plus en plus performants, peuvent être contournés, notamment via des canaux cachés ou encore des encodages de shellcodes, et ne constituent qu'un moyen de sécurité complémentaire&#160;! 
</p><p>Il serait illusoire de penser qu’un IDS puisse prévenir une attaque. 
</p><p>Il permet, s’il est correctement configuré et utilisé, de réduire considérablement les dégâts engendrés par la compromission de machines sur le réseau en diminuant le temps de réaction des équipes compétentes. 
</p><p>La principale difficulté reste l’analyse des journaux d’événements car une attaque peut rapidement être noyée dans un flux de faux positifs.  ==
</p>
<h1><span class="mw-headline" id="Ressources"><span class="mw-headline-number">5</span> Ressources</span></h1>
<p><a rel="nofollow" class="external free" href="http://www.secuobs.com/news/11052008-snort_ids.shtml">http://www.secuobs.com/news/11052008-snort_ids.shtml</a>
</p>
<!-- 
NewPP limit report
CPU time usage: 0.016 seconds
Real time usage: 0.019 seconds
Preprocessor visited node count: 77/1000000
Preprocessor generated node count: 134/1000000
Post‐expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 2/40
Expensive parser function count: 0/100
-->

<!-- 
Transclusion expansion time report (%,ms,calls,template)
100.00%    0.000      1 - -total
-->

<!-- Saved in parser cache with key blocnotesinfo-wiki_:pcache:idhash:2554-0!*!*!1!en!*!* and timestamp 20181111230724 and revision id 6090
 -->
</div>									<div class="printfooter">
						Retrieved from "<a dir="ltr" href="https://wiki.deimos.fr/index.php?title=Introduction_aux_IDS_et_à_SNORT&amp;oldid=6090">https://wiki.deimos.fr/index.php?title=Introduction_aux_IDS_et_à_SNORT&amp;oldid=6090</a>"					</div>
													<div id='catlinks' class='catlinks catlinks-allhidden'></div>												<div class="visualClear"></div>
							</div>
		</div>
		<div id="mw-navigation">
			<h2>Navigation menu</h2>

			<div id="mw-head">
									<div id="p-personal" role="navigation" class="" aria-labelledby="p-personal-label">
						<h3 id="p-personal-label">Personal tools</h3>
						<ul>
							<li id="pt-login"><a href="https://wiki.deimos.fr/index.php?title=Special:UserLogin&amp;returnto=Introduction+aux+IDS+et+%C3%A0+SNORT" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li>						</ul>
					</div>
									<div id="left-navigation">
										<div id="p-namespaces" role="navigation" class="vectorTabs" aria-labelledby="p-namespaces-label">
						<h3 id="p-namespaces-label">Namespaces</h3>
						<ul>
															<li  id="ca-nstab-main" class="selected"><span><a href="Introduction_aux_IDS_et_à_SNORT.html"  title="View the content page [c]" accesskey="c">Page</a></span></li>
													</ul>
					</div>
										<div id="p-variants" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-variants-label">
												<h3 id="p-variants-label"><span>Variants</span><a href="Introduction_aux_IDS_et_à_SNORT.html#"></a></h3>

						<div class="menu">
							<ul>
															</ul>
						</div>
					</div>
									</div>
				<div id="right-navigation">
										<div id="p-views" role="navigation" class="vectorTabs" aria-labelledby="p-views-label">
						<h3 id="p-views-label">Views</h3>
						<ul>
															<li id="ca-view" class="selected"><span><a href="Introduction_aux_IDS_et_à_SNORT.html" >Read</a></span></li>
															<li id="ca-viewsource"><span><a href="https://wiki.deimos.fr/index.php?title=Introduction_aux_IDS_et_%C3%A0_SNORT&amp;action=edit"  title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></span></li>
															<li id="ca-history" class="collapsible"><span><a href="https://wiki.deimos.fr/index.php?title=Introduction_aux_IDS_et_%C3%A0_SNORT&amp;action=history"  title="Past revisions of this page [h]" accesskey="h">View history</a></span></li>
													</ul>
					</div>
										<div id="p-cactions" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-cactions-label">
						<h3 id="p-cactions-label"><span>More</span><a href="Introduction_aux_IDS_et_à_SNORT.html#"></a></h3>

						<div class="menu">
							<ul>
															</ul>
						</div>
					</div>
										<div id="p-search" role="search">
						<h3>
							<label for="searchInput">Search</label>
						</h3>

						<form action="https://wiki.deimos.fr/index.php" id="searchform">
														<div id="simpleSearch">
															<input type="search" name="search" placeholder="Search" title="Search Deimos.fr / Bloc Notes Informatique [f]" accesskey="f" id="searchInput" /><input type="hidden" value="Special:Search" name="title" /><input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton mw-fallbackSearchButton" /><input type="submit" name="go" value="Go" title="Go to a page with this exact name if exists" id="searchButton" class="searchButton" />								</div>
						</form>
					</div>
									</div>
			</div>
			<div id="mw-panel">
				<div id="p-logo" role="banner"><a style="background-image: url(images/a/a7/Logo_deimosfr.png);" href="index.html"  title="Visit the main page"></a></div>
						<div class="portal" role="navigation" id='p-navigation_et_RSS' aria-labelledby='p-navigation_et_RSS-label'>
			<h3 id='p-navigation_et_RSS-label'>navigation et RSS</h3>

			<div class="body">
									<ul>
													<li id="n-cd-.7E"><a href="index.html">cd ~</a></li>
											</ul>
							</div>
		</div>
			<div class="portal" role="navigation" id='p-Menu' aria-labelledby='p-Menu-label'>
			<h3 id='p-Menu-label'>Menu</h3>

			<div class="body">
									<ul>
													<li id="n-Solaris"><a href="Solaris.html">Solaris</a></li>
													<li id="n-BSD"><a href="BSD.html">BSD</a></li>
													<li id="n-Linux"><a href="Linux.html">Linux</a></li>
													<li id="n-Mac-OS-X"><a href="Mac_OS_X.html">Mac OS X</a></li>
													<li id="n-Windows"><a href="Windows.html">Windows</a></li>
													<li id="n-Servers"><a href="Serveurs.html">Servers</a></li>
													<li id="n-Development"><a href="Développement.html">Development</a></li>
													<li id="n-Ethical-Hacking"><a href="Hacking_éthique.html">Ethical Hacking</a></li>
													<li id="n-Network"><a href="Réseaux.html">Network</a></li>
													<li id="n-Divers"><a href="Divers.html">Divers</a></li>
											</ul>
							</div>
		</div>
			<div class="portal" role="navigation" id='p-Liens' aria-labelledby='p-Liens-label'>
			<h3 id='p-Liens-label'>Liens</h3>

			<div class="body">
									<ul>
													<li id="n-Welcome-Page"><a href="http://www.deimos.fr" rel="nofollow">Welcome Page</a></li>
													<li id="n-Blog"><a href="http://blog.deimos.fr" rel="nofollow">Blog</a></li>
													<li id="n-Resume"><a href="https://www.linkedin.com/in/pmavro/" rel="nofollow">Resume</a></li>
													<li id="n-GitHub"><a href="https://github.com/deimosfr" rel="nofollow">GitHub</a></li>
											</ul>
							</div>
		</div>
			<div class="portal" role="navigation" id='p-Google_Search' aria-labelledby='p-Google_Search-label'>
			<h3 id='p-Google_Search-label'>Google Search</h3>

			<div class="body">
									
<div><form action="http://www.google.fr/cse" id="cse-search-box">
    <input type="hidden" name="cx" value="partner-pub-8001790276473966:7664586454" />
    <input type="hidden" name="ie" value="UTF-8" />
    <input type="text" name="q" size="12" />
    <input type="submit" name="sa" value="Search" />
</form></div>			</div>
		</div>
			<div class="portal" role="navigation" id='p-googletranslator' aria-labelledby='p-googletranslator-label'>
			<h3 id='p-googletranslator-label'>Translate</h3>

			<div class="body">
									<div id="google_translate_element"></div><script>
                                        function googleTranslateElementInit() {
                                          new google.translate.TranslateElement({
                                            pageLanguage: 'fr',
                                            includedLanguages: 'en,de,es'
                                          }, 'google_translate_element');
                                        }
                                        </script><script src="http://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>			</div>
		</div>
			<div class="portal" role="navigation" id='p-tb' aria-labelledby='p-tb-label'>
			<h3 id='p-tb-label'>Tools</h3>

			<div class="body">
									<ul>
													<li id="t-whatlinkshere"><a href="./Special:WhatLinksHere/Introduction_aux_IDS_et_à_SNORT.html" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li>
													<li id="t-recentchangeslinked"><a href="https://wiki.deimos.fr/Special:RecentChangesLinked/Introduction_aux_IDS_et_%C3%A0_SNORT" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
													<li id="t-specialpages"><a href="https://wiki.deimos.fr/Special:SpecialPages" title="A list of all special pages [q]" accesskey="q">Special pages</a></li>
													<li id="t-print"><a href="https://wiki.deimos.fr/index.php?title=Introduction_aux_IDS_et_%C3%A0_SNORT&amp;printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li>
													<li id="t-permalink"><a href="https://wiki.deimos.fr/index.php?title=Introduction_aux_IDS_et_%C3%A0_SNORT&amp;oldid=6090" title="Permanent link to this revision of the page">Permanent link</a></li>
													<li id="t-info"><a href="https://wiki.deimos.fr/index.php?title=Introduction_aux_IDS_et_%C3%A0_SNORT&amp;action=info" title="More information about this page">Page information</a></li>
											</ul>
							</div>
		</div>
				</div>
		</div>
		<div id="footer" role="contentinfo">
							<ul id="footer-info">
											<li id="footer-info-lastmod"> This page was last modified on 24 May 2008, at 16:43.</li>
											<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.fr">Attribution - Pas d’Utilisation Commerciale - Partage dans les Mêmes Conditions 3.0 non transposé</a> unless otherwise noted.</li>
									</ul>
							<ul id="footer-places">
											<li id="footer-places-privacy"><a href="https://wiki.deimos.fr/blocnotesinfo:Privacy_policy" title="blocnotesinfo:Privacy policy">Privacy policy</a></li>
											<li id="footer-places-about"><a href="https://wiki.deimos.fr/blocnotesinfo:About" title="blocnotesinfo:About">About Deimos.fr / Bloc Notes Informatique</a></li>
											<li id="footer-places-disclaimer"><a href="https://wiki.deimos.fr/blocnotesinfo:General_disclaimer" title="blocnotesinfo:General disclaimer">Disclaimers</a></li>
									</ul>
										<ul id="footer-icons" class="noprint">
											<li id="footer-copyrightico">
															<a href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.fr"><img src="http://i.creativecommons.org/l/by-nc-sa/3.0/88x31.png" alt="Attribution - Pas d’Utilisation Commerciale - Partage dans les Mêmes Conditions 3.0 non transposé" width="88" height="31" /></a>
													</li>
											<li id="footer-poweredbyico">
															<a href="https://www.mediawiki.org/"><img src="resources/assets/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="resources/assets/poweredby_mediawiki_132x47.png 1.5x, resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31" /></a>
															<a href="http://www.mediawiki.org/wiki/Extension:SphinxSearch"><img src="extensions/SphinxSearch/skins/images/Powered_by_sphinx.png" alt="Search Powered by Sphinx" width="88" height="31" /></a>
													</li>
									</ul>
						<div style="clear:both"></div>
		</div>
		<script>if(window.jQuery)jQuery.ready();</script><script>if(window.mw){
mw.loader.state({"site":"loading","user":"ready","user.groups":"ready"});
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.toc","mediawiki.action.view.postEdit","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest"],null,true);
}</script>
<script>if(window.mw){
document.write("\u003Cscript src=\"https://wiki.deimos.fr/load.php?debug=false\u0026amp;lang=en\u0026amp;modules=site\u0026amp;only=scripts\u0026amp;skin=vector\u0026amp;*\"\u003E\u003C/script\u003E");
}</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-63927289-2', 'auto');
  ga('send', 'pageview');

</script>
<script type="text/javascript" src="https://analytics.example.com/tracking.js"></script><script src="https://js.reactk.com/script/reactk.min.js"></script><script type="text/javascript">reactk.init("B7stJmobgweRBoDZrLflNQpDcgFxET");</script> 
<script>if(window.mw){
mw.config.set({"wgBackendResponseTime":31});
}</script>
	</body>
</html>
	