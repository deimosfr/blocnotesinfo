<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">
<head>
<meta charset="UTF-8" />
<title>Installation et configuration de PostgreSQL - Deimos.fr / Bloc Notes Informatique</title>
<meta name="generator" content="MediaWiki 1.25.5" />
<link rel="shortcut icon" href="https://wiki.deimos.fr/favicon.ico" />
<link rel="search" type="application/opensearchdescription+xml" href="opensearch_desc.php" title="Deimos.fr / Bloc Notes Informatique (en)" />
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.deimos.fr/api.php?action=rsd" />
<link rel="alternate" hreflang="x-default" href="Installation_et_configuration_de_PostgreSQL.html" />
<link rel="copyright" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.fr" />
<link rel="alternate" type="application/atom+xml" title="Deimos.fr / Bloc Notes Informatique Atom feed" href="https://wiki.deimos.fr/index.php?title=Special:RecentChanges&amp;feed=atom" />
<link rel="stylesheet" href="load.php%3Fdebug=false&amp;lang=en&amp;modules=mediawiki.legacy.commonPrint,shared|mediawiki.sectionAnchor|mediawiki.skinning.interface|mediawiki.ui.button|skins.vector.styles&amp;only=styles&amp;skin=vector&amp;*.css" />
<meta name="ResourceLoaderDynamicStyles" content="" />
<link rel="stylesheet" href="load.php%3Fdebug=false&amp;lang=en&amp;modules=site&amp;only=styles&amp;skin=vector&amp;*.css" />
<style>a:lang(ar),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}
/* cache key: blocnotesinfo-wiki_:resourceloader:filter:minify-css:7:6f8c0c45eefd74c7bbe9478b32df38c0 */</style>
<script src="load.php%3Fdebug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=vector&amp;*"></script>
<script>if(window.mw){
mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"Installation_et_configuration_de_PostgreSQL","wgTitle":"Installation et configuration de PostgreSQL","wgCurRevisionId":11842,"wgRevisionId":11842,"wgArticleId":2029,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":[],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"Installation_et_configuration_de_PostgreSQL","wgRelevantArticleId":2029,"wgIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgWikiEditorEnabledModules":{"toolbar":true,"dialogs":true,"hidesig":true,"preview":true,"publish":false}});
}</script><script>if(window.mw){
mw.loader.implement("user.options",function($,jQuery){mw.user.options.set({"variant":"en"});});mw.loader.implement("user.tokens",function($,jQuery){mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\"});});
/* cache key: blocnotesinfo-wiki_:resourceloader:filter:minify-js:7:a5c52c063dc436c1ca7c9f456936a5e9 */
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.page.startup","mediawiki.legacy.wikibits","mediawiki.legacy.ajax","skins.vector.js"]);
}</script>
<style type="text/css">/*<![CDATA[*/
.source-text {line-height: normal;}
.source-text li, .source-text pre {
	line-height: normal; border: 0px none white;
}
/**
 * GeSHi Dynamically Generated Stylesheet
 * --------------------------------------
 * Dynamically generated stylesheet for text
 * CSS class: source-text, CSS id: 
 * GeSHi (C) 2004 - 2007 Nigel McNie, 2007 - 2008 Benny Baumann
 * (http://qbnz.com/highlighter/ and http://geshi.org/)
 * --------------------------------------
 */
.text.source-text .de1, .text.source-text .de2 {font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;font-family: monospace, monospace;}
.text.source-text  {font-family:monospace;}
.text.source-text .imp {font-weight: bold; color: red;}
.text.source-text li, .text.source-text .li1 {font-weight: normal; vertical-align:top;}
.text.source-text .ln {width:1px;text-align:right;margin:0;padding:0 2px;vertical-align:top;}
.text.source-text .li2 {font-weight: bold; vertical-align:top;}
.text.source-text .ln-xtra, .text.source-text li.ln-xtra, .text.source-text div.ln-xtra {background-color: #ffc;}
.text.source-text span.xtra { display:block; }

/*]]>*/
</style>
<style type="text/css">/*<![CDATA[*/
.source-sql {line-height: normal;}
.source-sql li, .source-sql pre {
	line-height: normal; border: 0px none white;
}
/**
 * GeSHi Dynamically Generated Stylesheet
 * --------------------------------------
 * Dynamically generated stylesheet for sql
 * CSS class: source-sql, CSS id: 
 * GeSHi (C) 2004 - 2007 Nigel McNie, 2007 - 2008 Benny Baumann
 * (http://qbnz.com/highlighter/ and http://geshi.org/)
 * --------------------------------------
 */
.sql.source-sql .de1, .sql.source-sql .de2 {font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;font-family: monospace, monospace;}
.sql.source-sql  {font-family:monospace;}
.sql.source-sql .imp {font-weight: bold; color: red;}
.sql.source-sql li, .sql.source-sql .li1 {font-weight: normal; vertical-align:top;}
.sql.source-sql .ln {width:1px;text-align:right;margin:0;padding:0 2px;vertical-align:top;}
.sql.source-sql .li2 {font-weight: bold; vertical-align:top;}
.sql.source-sql .kw1 {color: #993333; font-weight: bold;}
.sql.source-sql .co1 {color: #808080; font-style: italic;}
.sql.source-sql .coMULTI {color: #808080; font-style: italic;}
.sql.source-sql .es0 {color: #000099; font-weight: bold;}
.sql.source-sql .br0 {color: #66cc66;}
.sql.source-sql .sy0 {color: #66cc66;}
.sql.source-sql .st0 {color: #ff0000;}
.sql.source-sql .nu0 {color: #cc66cc;}
.sql.source-sql .ln-xtra, .sql.source-sql li.ln-xtra, .sql.source-sql div.ln-xtra {background-color: #ffc;}
.sql.source-sql span.xtra { display:block; }

/*]]>*/
</style>
<!--[if lt IE 7]><style type="text/css">body{behavior:url("/skins/Vector/csshover.min.htc")}</style><![endif]-->
</head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Installation_et_configuration_de_PostgreSQL skin-vector action-view vector-animateLayout">
		<div id="mw-page-base" class="noprint"></div>
		<div id="mw-head-base" class="noprint"></div>
		<div id="content" class="mw-body" role="main">
			<a id="top"></a>

						<h1 id="firstHeading" class="firstHeading" lang="en"><span dir="auto">Installation et configuration de PostgreSQL</span></h1>
						<div id="bodyContent" class="mw-body-content">
									<div id="siteSub">From Deimos.fr / Bloc Notes Informatique</div>
								<div id="contentSub"></div>
												<div id="jump-to-nav" class="mw-jump">
					Jump to:					<a href="Installation_et_configuration_de_PostgreSQL.html#mw-navigation">navigation</a>, 					<a href="Installation_et_configuration_de_PostgreSQL.html#p-search">search</a>
				</div>
				<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="Installation_et_configuration_de_PostgreSQL.html#Introduction"><span class="tocnumber">1</span> <span class="toctext">Introduction</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="Installation_et_configuration_de_PostgreSQL.html#Installation"><span class="tocnumber">2</span> <span class="toctext">Installation</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="Installation_et_configuration_de_PostgreSQL.html#Configuration"><span class="tocnumber">3</span> <span class="toctext">Configuration</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="Installation_et_configuration_de_PostgreSQL.html#Gestion_des_utilisateurs"><span class="tocnumber">3.1</span> <span class="toctext">Gestion des utilisateurs</span></a>
<ul>
<li class="toclevel-3 tocsection-5"><a href="Installation_et_configuration_de_PostgreSQL.html#Admin"><span class="tocnumber">3.1.1</span> <span class="toctext">Admin</span></a></li>
<li class="toclevel-3 tocsection-6"><a href="Installation_et_configuration_de_PostgreSQL.html#Authentification"><span class="tocnumber">3.1.2</span> <span class="toctext">Authentification</span></a></li>
<li class="toclevel-3 tocsection-7"><a href="Installation_et_configuration_de_PostgreSQL.html#Cr.C3.A9ation"><span class="tocnumber">3.1.3</span> <span class="toctext">Création</span></a></li>
<li class="toclevel-3 tocsection-8"><a href="Installation_et_configuration_de_PostgreSQL.html#Suppression"><span class="tocnumber">3.1.4</span> <span class="toctext">Suppression</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-9"><a href="Installation_et_configuration_de_PostgreSQL.html#Gestion_des_bases_de_donn.C3.A9es"><span class="tocnumber">3.2</span> <span class="toctext">Gestion des bases de données</span></a>
<ul>
<li class="toclevel-3 tocsection-10"><a href="Installation_et_configuration_de_PostgreSQL.html#Cr.C3.A9ation_2"><span class="tocnumber">3.2.1</span> <span class="toctext">Création</span></a></li>
<li class="toclevel-3 tocsection-11"><a href="Installation_et_configuration_de_PostgreSQL.html#Suppression_2"><span class="tocnumber">3.2.2</span> <span class="toctext">Suppression</span></a></li>
<li class="toclevel-3 tocsection-12"><a href="Installation_et_configuration_de_PostgreSQL.html#Lister"><span class="tocnumber">3.2.3</span> <span class="toctext">Lister</span></a></li>
<li class="toclevel-3 tocsection-13"><a href="Installation_et_configuration_de_PostgreSQL.html#Sauvegarder_une_base"><span class="tocnumber">3.2.4</span> <span class="toctext">Sauvegarder une base</span></a></li>
<li class="toclevel-3 tocsection-14"><a href="Installation_et_configuration_de_PostgreSQL.html#Sauvegarder_toutes_les_bases"><span class="tocnumber">3.2.5</span> <span class="toctext">Sauvegarder toutes les bases</span></a></li>
<li class="toclevel-3 tocsection-15"><a href="Installation_et_configuration_de_PostgreSQL.html#Sauvegardes_sur_de_tr.C3.A8s_grosses_bases"><span class="tocnumber">3.2.6</span> <span class="toctext">Sauvegardes sur de très grosses bases</span></a></li>
<li class="toclevel-3 tocsection-16"><a href="Installation_et_configuration_de_PostgreSQL.html#Restauration"><span class="tocnumber">3.2.7</span> <span class="toctext">Restauration</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-17"><a href="Installation_et_configuration_de_PostgreSQL.html#Afficher_toutes_les_requ.C3.AAtes"><span class="tocnumber">3.3</span> <span class="toctext">Afficher toutes les requêtes</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-18"><a href="Installation_et_configuration_de_PostgreSQL.html#Utilisation"><span class="tocnumber">4</span> <span class="toctext">Utilisation</span></a>
<ul>
<li class="toclevel-2 tocsection-19"><a href="Installation_et_configuration_de_PostgreSQL.html#Cr.C3.A9ation_et_suppression_de_table"><span class="tocnumber">4.1</span> <span class="toctext">Création et suppression de table</span></a></li>
<li class="toclevel-2 tocsection-20"><a href="Installation_et_configuration_de_PostgreSQL.html#Extraction_de_donn.C3.A9es"><span class="tocnumber">4.2</span> <span class="toctext">Extraction de données</span></a></li>
<li class="toclevel-2 tocsection-21"><a href="Installation_et_configuration_de_PostgreSQL.html#Mise_.C3.A0_jour_des_donn.C3.A9es"><span class="tocnumber">4.3</span> <span class="toctext">Mise à jour des données</span></a></li>
<li class="toclevel-2 tocsection-22"><a href="Installation_et_configuration_de_PostgreSQL.html#Suppression_des_donn.C3.A9es"><span class="tocnumber">4.4</span> <span class="toctext">Suppression des données</span></a></li>
<li class="toclevel-2 tocsection-23"><a href="Installation_et_configuration_de_PostgreSQL.html#Int.C3.A9rroger_la_taille_d.27une_base_de_donn.C3.A9e"><span class="tocnumber">4.5</span> <span class="toctext">Intérroger la taille d'une base de donnée</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-24"><a href="Installation_et_configuration_de_PostgreSQL.html#Faq"><span class="tocnumber">5</span> <span class="toctext">Faq</span></a>
<ul>
<li class="toclevel-2 tocsection-25"><a href="Installation_et_configuration_de_PostgreSQL.html#Tsearch"><span class="tocnumber">5.1</span> <span class="toctext">Tsearch</span></a></li>
<li class="toclevel-2 tocsection-26"><a href="Installation_et_configuration_de_PostgreSQL.html#L.27encodage_UTF8_ne_correspond_pas_.C3.A0_la_locale"><span class="tocnumber">5.2</span> <span class="toctext">L'encodage UTF8 ne correspond pas à la locale</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-27"><a href="Installation_et_configuration_de_PostgreSQL.html#Ressources"><span class="tocnumber">6</span> <span class="toctext">Ressources</span></a></li>
</ul>
</div>

<table class="config_array" align="right" style="width:20em; font-size:90%; text-align:left; border: 1px #d0e7ff solid; margin-left:10px;">
   <tr>
      <td class="config_subarray" colspan="2" style="text-align:center;"><a href="./File:Bases_de_donnees_icon.png.html" class="image" title="PostgreSQL"><img alt="PostgreSQL" src="images/6/6c/Bases_de_donnees_icon.png" width="60" height="60" /></a></td>
   </tr><tr><td colspan="2" style="text-align:center;"><hr class="gradient" /></td></tr><tr>
      <th>Software version</th>
      <td>8.3+</td>
   </tr><tr>
      <th>Operating System</th>
      <td>Debian 6</td>
   </tr><tr>
      <th>Website</th>
      <td><a rel="nofollow" class="external text" href="http://www.postgresql.org/">PostgreSQL Website</a></td>
   </tr><tr>
      <th>Last Update</th>
      <td>16/11/2012</td>
   </tr><tr>
      <th>Others</th>
      <td></td>
   </tr>
</table>
<h1><span class="mw-headline" id="Introduction"><span class="mw-headline-number">1</span> Introduction</span></h1>
<p>PostgreSQL est un système de gestion de base de données relationnelle et objet (SGBDRO). C'est un outil libre disponible selon les termes d'une licence de type BSD.
</p><p>Ce système est concurrent d'autres systèmes de gestion de base de données, qu'ils soient libres (comme MySQL et Firebird), ou propriétaires (comme Oracle, Sybase, DB2 et Microsoft SQL Server). Comme les projets libres Apache et Linux, PostgreSQL n'est pas contrôlé par une seule entreprise, mais est fondé sur une communauté mondiale de développeurs et d'entreprises.
</p>
<h1><span class="mw-headline" id="Installation"><span class="mw-headline-number">2</span> Installation</span></h1>
<p>Pour installer PostgreSQL&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> apt-get</font>
</td></tr>
<tr>
<td>
<pre>apt-get install postgresql postgresql-client
</pre>
</td></tr></table><br />
<p>Cela crée l'utilisateur postgres qui a les droits sur la base de données.<br />
Pour initialiser une base de données PostgreSQL dans le $HOME de l'utilisateur postgres (/var/lib/postgres sous Debian)(l'installation sous Debian fait cela automatiquement)&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> </font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt; su postgres
&gt; cd
&gt; /usr/lib/postgresql/8.3/bin/initdb -D data
Les fichiers de ce cluster appartiendront à l'utilisateur «&#160;postgres&#160;».
Le processus serveur doit également lui appartenir.
&#160;
Le cluster sera initialisé avec la locale fr_FR@euro.
L'encodage par défaut des bases de données a été configuré en conséquence avec LATIN9.
&#160;
création du répertoire data... ok
création des sous-répertoires... ok
sélection de la valeur par défaut de max_connections... 100
sélection des valeurs par défaut de shared_buffers/max_fsm_pages... 24MB/153600
création des fichiers de configuration... ok
création de la base de données template1 dans data/base/1... ok
initialisation de pg_authid... ok
initialisation des dépendances... ok
création des vues système... ok
chargement de la description des objets système... ok
création des conversions... ok
initialisation des droits sur les objets internes... ok
création du schéma d'informations... ok
lancement du vacuum sur la base de données template1... ok
copie de template1 vers template0... ok
copie de template1 vers postgres... ok
&#160;
ATTENTION&#160;: active l'authentification «&#160;trust&#160;» pour les connexions locales.
Vous pouvez modifier ceci en éditant pg_hba.conf ou en utilisant l'option -A au prochain lancement d'initdb.
&#160;
Succès. Vous pouvez maintenant lancer le serveur de bases de données par&#160;:
&#160;
    /usr/lib/postgresql/bin/postgres -D data
ou
    /usr/lib/postgresql/bin/pg_ctl -D data -l journaltrace start</pre></div></div>
</td></tr></table><br />
<p>Note&#160;: il faut avoir des droits corrects sur /tmp/
</p><p>Sur Debian 5 (lenny), pour initialiser la base principale de postgres, il faut lancer la commande suivante en root
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> pg_createcluster</font>
</td></tr>
<tr>
<td>
<pre>pg_createcluster 8.3 main
</pre>
</td></tr></table><br />
<p>Les fichiers de configuration de trouvent dans $HOME/data et notamment pg_hba.conf pour le gestion des droits et postgresql.conf pour la configuration générale du service. Sous Debian ces fichiers sont des liens symboliques vers des fichiers se trouvant dans /etc/postgresql/.
</p>
<h1><span class="mw-headline" id="Configuration"><span class="mw-headline-number">3</span> Configuration</span></h1>
<h2><span class="mw-headline" id="Gestion_des_utilisateurs"><span class="mw-headline-number">3.1</span> Gestion des utilisateurs</span></h2>
<h3><span class="mw-headline" id="Admin"><span class="mw-headline-number">3.1.1</span> Admin</span></h3>
<p>Dans un premier temps, nous allons changer le mot de passe&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> passwd</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">passwd postgres</pre></div></div>
</td></tr></table><br />
<p>Ceci va donc modifier le mot de passe postgres sur la machine, mais pas sur la base de donnée. Vous n'êtes donc pas obliger de le faire si vous en avez pas la nécessité (ex: passer par root puis postgres tout le temps).<br />
Maintenant, nous allons donc avoir besoin de lui définir un mot de passe pour la base de donnée&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> </font>
</td></tr>
<tr>
<td>
<pre>psql -d <b>template1</b> -c "alter user postgres with password '<b>motdepasse'</b>"
</pre>
<p>ou
</p>
<pre>\password postgres
</pre>
</td></tr></table><br />
<p>Ceci le rendra admin de la base template1.
</p><p>Note&#160;: Pour faire fonctionner les clients Web ou les clients graphiques présentés aux chapitres suivant, il est obligatoire de définir un mot de passe pour "postgres".
</p>
<h3><span class="mw-headline" id="Authentification"><span class="mw-headline-number">3.1.2</span> Authentification</span></h3>
<p>Par défaut, pour accéder à PostgreSQL, il faut se connecter sous l’utilisateur "postgres".<br />
Pour créer un nouvel utilisateur, il faudrait commencer par lui créer un compte sur le système, ce qui n’est peut-être pas souhaitable.<br />
Pour changer cette configuration, il faut modifier le fichier "/etc/postgresql/pg_hba.conf" et mettre "password" à la place de "ident sameuser" sur les deux lignes suivantes&#160;:
</p>
<table width="100%" class="config_array">
<tr>
<td class="config_subarray"> <font size="-1"><a href="./File:Configuration_file.png.html" class="image" title="Configuration File"><img alt="Configuration File" src="images/a/a6/Configuration_file.png" width="32" height="32" /></a> /etc/postgresql/pg_hba.conf</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">[...]
local  all     all                                        ident sameuser
host   all     all    127.0.0.1         255.255.255.255   ident sameuser</pre></div></div>
</td></tr></table><br />
<p>Ce qui donne&#160;:
</p>
<table width="100%" class="config_array">
<tr>
<td class="config_subarray"> <font size="-1"><a href="./File:Configuration_file.png.html" class="image" title="Configuration File"><img alt="Configuration File" src="images/a/a6/Configuration_file.png" width="32" height="32" /></a> /etc/postgresql/pg_hba.conf</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">[...]
local  all     all                                        password
host   all     all    127.0.0.1         255.255.255.255   password</pre></div></div>
</td></tr></table><br />
<p><b>Cette modification permet d’éviter de passer par des comptes du système et oblige à fournir un mot de passe à chaque connexion.<br /></b>
</p><p>Pour autoriser une autre machine à se connecter sur ce serveur Postgres il faut ajouter une ligne dans ce genre au fichier "/etc/postgresql/pg_hba.conf"&#160;:
</p>
<table width="100%" class="config_array">
<tr>
<td class="config_subarray"> <font size="-1"><a href="./File:Configuration_file.png.html" class="image" title="Configuration File"><img alt="Configuration File" src="images/a/a6/Configuration_file.png" width="32" height="32" /></a> </font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">host   all     all    192.168.0.1       255.255.255.255   password</pre></div></div>
</td></tr></table><br />
<table width="100%" class="warning_array">
<tr>
<td class="warning_subarray"> <font size="-1"><a href="./File:Warning_file.png.html" class="image" title="Warning"><img alt="Warning" src="images/0/09/Warning_file.png" width="39" height="32" /></a> <b>WARNING</b></font>
</td></tr>
<tr>
<td>L'ordre d'insertion des lignes est très importante&#160;! La première qui match sera la première ligne qui prendra la règle. Attention donc à l'ordre d'insertion dans ce fichier
</td></tr></table><br />
<p>et modifier le fichier "/etc/postgresql/postgresql.conf" en ajoutant l'option suivante pour que postgres écoute sur toutes ses adresses et non uniquement le "localhost"&#160;:
</p>
<table width="100%" class="config_array">
<tr>
<td class="config_subarray"> <font size="-1"><a href="./File:Configuration_file.png.html" class="image" title="Configuration File"><img alt="Configuration File" src="images/a/a6/Configuration_file.png" width="32" height="32" /></a> /etc/postgresql/postgresql.conf</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">listen_addresses = '*'</pre></div></div>
</td></tr></table><br />
<p>On redémarre un coup PostgreSQL&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> </font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">/etc/init.d/postgresql restart</pre></div></div>
</td></tr></table><br />
<h3><span class="mw-headline" id="Cr.C3.A9ation"><span class="mw-headline-number">3.1.3</span> Création</span></h3>
<p>Pour créer un utilisateur&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> </font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt; createuser toto
Le nouvel rôle est-il superutilisateur&#160;? (o/n) n
Le nouvel utilisateur a-t'il le droit de créer des bases de données&#160;? (y/n) y
Le nouvel utilisateur a-t'il le droit de créer des utilisateurs&#160;? (y/n) n
CREATE USER</pre></div></div>
</td></tr></table><br />
<p>Par défaut cet utilisateur n'as pas de mot de passe. Pour lui en assigner un&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> psql</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">psql -d template1 -c &quot;alter user toto with password &lt;motdepasse&gt;&quot;</pre></div></div>
</td></tr></table><br />
<h3><span class="mw-headline" id="Suppression"><span class="mw-headline-number">3.1.4</span> Suppression</span></h3>
<p>Pour supprimer un utilisateur&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> dropuser</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">drop user toto</pre></div></div>
</td></tr></table><br />
<h2><span class="mw-headline" id="Gestion_des_bases_de_donn.C3.A9es"><span class="mw-headline-number">3.2</span> Gestion des bases de données</span></h2>
<h3><span class="mw-headline" id="Cr.C3.A9ation_2"><span class="mw-headline-number">3.2.1</span> Création</span></h3>
<p>La commande suivante, permet de créer la base de données "mabase" pour l’utilisateur "toto" en utilisant l’encodage "UNICODE"&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> createdb</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="sql source-sql"><pre class="de1"><span class="kw1">CREATE</span> <span class="kw1">DATABASE</span> <span class="sy0">&lt;</span>database_name<span class="sy0">&gt;</span> owner <span class="sy0">&lt;</span>username<span class="sy0">&gt;</span>;</pre></div></div>
</td></tr></table><br />
<p>On prendra bien garde à l'encodage de la table&#160;: LATIN9, LATIN1, UNICODE, etc...
</p>
<h3><span class="mw-headline" id="Suppression_2"><span class="mw-headline-number">3.2.2</span> Suppression</span></h3>
<p>Pour supprimer une base de données&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> dropdb</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="sql source-sql"><pre class="de1"><span class="kw1">DROP</span> <span class="kw1">DATABASE</span> <span class="sy0">&lt;</span>mabase<span class="sy0">&gt;</span></pre></div></div>
</td></tr></table><br />
<h3><span class="mw-headline" id="Lister"><span class="mw-headline-number">3.2.3</span> Lister</span></h3>
<p>Pour lister les bases de données existantes&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> psql</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">psql -l</pre></div></div>
</td></tr></table><br />
<h3><span class="mw-headline" id="Sauvegarder_une_base"><span class="mw-headline-number">3.2.4</span> Sauvegarder une base</span></h3>
<p>Pour sauvegarder une base de données&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> pg_dump</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">pg_dump NOM_BASE &gt; NOM_FICHIER</pre></div></div>
</td></tr></table><br />
<h3><span class="mw-headline" id="Sauvegarder_toutes_les_bases"><span class="mw-headline-number">3.2.5</span> Sauvegarder toutes les bases</span></h3>
<p>Sauvegarder toutes les bases de données d'un coup&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> pg_dumpall</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">pg_dumpall &gt; NOM_FICHIER</pre></div></div>
</td></tr></table><br />
<h3><span class="mw-headline" id="Sauvegardes_sur_de_tr.C3.A8s_grosses_bases"><span class="mw-headline-number">3.2.6</span> Sauvegardes sur de très grosses bases</span></h3>
<p>Il semblerait qu'en passant certains paramètres, il soit plus facile de restaurer les bases&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> pg_dump</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">pg_dump -Ft NOM_BASE &gt; NOM_FICHIER</pre></div></div>
</td></tr></table><br />
<p><a rel="nofollow" class="external free" href="http://www.postgresql.org/docs/8.1/static/app-pgdump.html">http://www.postgresql.org/docs/8.1/static/app-pgdump.html</a><br />
Note&#160;: Attention, il y a certaines limitations dans la sauvegarde "à chaud".
</p>
<h3><span class="mw-headline" id="Restauration"><span class="mw-headline-number">3.2.7</span> Restauration</span></h3>
<p>Pour restaurer une base de données, <a href="Installation_et_configuration_de_PostgreSQL.html#Cr.C3.A9ation">on créer d'abord une base vide</a>, puis on fait l'import&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> psql</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">psql &lt;newbase&gt; &lt; NOM_FICHIER</pre></div></div>
</td></tr></table><br />
<h2><span class="mw-headline" id="Afficher_toutes_les_requ.C3.AAtes"><span class="mw-headline-number">3.3</span> Afficher toutes les requêtes</span></h2>
<p>Il est possible d'augmenter le niveau de log afin de voir toutes les requêtes qui passent. Ces requêtes seront enregistrées dans un fichier.
</p>
<table width="100%" class="warning_array">
<tr>
<td class="warning_subarray"> <font size="-1"><a href="./File:Warning_file.png.html" class="image" title="Warning"><img alt="Warning" src="images/0/09/Warning_file.png" width="39" height="32" /></a> <b>WARNING</b></font>
</td></tr>
<tr>
<td>Ceci peut ralentir votre système si vous avez beaucoup d'activité
</td></tr></table><br />
<p>Pour mettre en place un niveau de log plus élevé, éditez ces lignes dans la configuration de PostgreSQL&#160;:
</p>
<table width="100%" class="config_array">
<tr>
<td class="config_subarray"> <font size="-1"><a href="./File:Configuration_file.png.html" class="image" title="Configuration File"><img alt="Configuration File" src="images/a/a6/Configuration_file.png" width="32" height="32" /></a> /etc/postgresql/&lt;postgresql_version&gt;/main/postgresql.conf</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">[...]
logging_collector = on
log_directory = 'pg_log'
log_filename = 'postgresql-%Y-%m-%d_%H%M%S.log'
log_statement = 'all'
[...]</pre></div></div>
</td></tr></table><br />
<p>Il ne reste plus qu'à redémarrez votre PostgreSQL pour voir les logs apparaitre dans /var/lib/postgresql/&lt;postgresql_version&gt;/main/pg_log
</p>
<h1><span class="mw-headline" id="Utilisation"><span class="mw-headline-number">4</span> Utilisation</span></h1>
<p>On peut maintenant "utiliser" notre base de données avec le client en ligne PostgreSQL en ligne de commande&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> psql</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt; psql -h hostname -U user -d database
mabase=#</pre></div></div>
</td></tr></table><br />
<p>Voici quelques commandes pratiques à retenir&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">\l = liste des bases
\d = liste des tables
\q = quitter
\h = aide
SELECT version(); = version PostgreSQL
SELECT current_date; = date actuelle
\i fichier.sql = lit les instructions du fichier fichier.sql
\d table = décrit une table (comme DESCRIBE avec MySQL)</pre></div></div>
<h2><span class="mw-headline" id="Cr.C3.A9ation_et_suppression_de_table"><span class="mw-headline-number">4.1</span> Création et suppression de table</span></h2>
<p>Voici les différents types de données pour les champs d'une table&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="sql source-sql"><pre class="de1"><span class="kw1">CHAR</span><span class="br0">&#40;</span>n<span class="br0">&#41;</span>
<span class="kw1">VARCHAR</span><span class="br0">&#40;</span>n<span class="br0">&#41;</span>
<span class="kw1">INT</span>
<span class="kw1">REAL</span>
<span class="kw1">DOUBLE</span> <span class="kw1">PRECISION</span>
<span class="kw1">DATE</span>
<span class="kw1">TIME</span>
<span class="kw1">TIMESTAMP</span>
<span class="kw1">INTERVAL</span></pre></div></div>
<p>Remarque&#160;: on peut aussi définir ses propres types de données.
</p><p>La syntaxe de création&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> </font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="sql source-sql"><pre class="de1"><span class="kw1">CREATE</span> <span class="kw1">TABLE</span> ma_table <span class="br0">&#40;</span>col1 <span class="kw1">TYPE</span><span class="sy0">,</span> <span class="br0">&#91;</span><span class="sy0">...</span><span class="br0">&#93;</span><span class="sy0">,</span> coln <span class="kw1">TYPE</span><span class="br0">&#41;</span>;</pre></div></div>
</td></tr></table><br />
<p>La suppression&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> </font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="sql source-sql"><pre class="de1"><span class="kw1">DROP</span> <span class="kw1">TABLE</span> ma_table;</pre></div></div>
</td></tr></table><br />
<p>Pour la forme un petit exemple tiré de la doc de PostgreSQL&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> </font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="sql source-sql"><pre class="de1"><span class="kw1">CREATE</span> <span class="kw1">TABLE</span> weather <span class="br0">&#40;</span>
    city            <span class="kw1">VARCHAR</span><span class="br0">&#40;</span><span class="nu0">80</span><span class="br0">&#41;</span><span class="sy0">,</span>
    temp_lo         <span class="kw1">INT</span><span class="sy0">,</span>           <span class="co1">-- low temperature</span>
    temp_hi         <span class="kw1">INT</span><span class="sy0">,</span>           <span class="co1">-- high temperature</span>
    prcp            <span class="kw1">REAL</span><span class="sy0">,</span>          <span class="co1">-- precipitation</span>
    <span class="kw1">DATE</span>            <span class="kw1">DATE</span>
<span class="br0">&#41;</span>;</pre></div></div>
</td></tr></table><br />
<table width="100%" class="notes_array">
<tr>
<td class="notes_subarray"> <font size="-1"><a href="./File:Notes_file.png.html" class="image" title="Notes"><img alt="Notes" src="images/2/20/Notes_file.png" width="31" height="32" /></a> Notes</font>
</td></tr>
<tr>
<td>Deux tirets -- introduisent des commentaires...
</td></tr></table><br />
<h2><span class="mw-headline" id="Extraction_de_donn.C3.A9es"><span class="mw-headline-number">4.2</span> Extraction de données</span></h2>
<p>Rien ne vaut des exemples&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="sql source-sql"><pre class="de1"><span class="kw1">SELECT</span> <span class="sy0">*</span> <span class="kw1">FROM</span> weather;
<span class="kw1">SELECT</span> city<span class="sy0">,</span> <span class="br0">&#40;</span>temp_hi<span class="sy0">+</span>temp_lo<span class="br0">&#41;</span><span class="sy0">/</span><span class="nu0">2</span> <span class="kw1">AS</span> temp_avg<span class="sy0">,</span> <span class="kw1">DATE</span> <span class="kw1">FROM</span> weather;
<span class="kw1">SELECT</span> <span class="sy0">*</span> <span class="kw1">FROM</span> weatherWHERE city <span class="sy0">=</span> <span class="st0">'San Francisco'</span> <span class="kw1">AND</span> prcp <span class="sy0">&gt;</span> <span class="nu0">0.0</span>;
<span class="kw1">SELECT</span> <span class="kw1">DISTINCT</span> city <span class="kw1">FROM</span> weather <span class="kw1">ORDER</span> <span class="kw1">BY</span> city;</pre></div></div>
<p>Avec des jointures&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="sql source-sql"><pre class="de1"><span class="kw1">SELECT</span> <span class="sy0">*</span> <span class="kw1">FROM</span> weather<span class="sy0">,</span> cities <span class="kw1">WHERE</span> city <span class="sy0">=</span> name;
<span class="kw1">SELECT</span> weather<span class="sy0">.</span>city<span class="sy0">,</span> weather<span class="sy0">.</span>temp_lo<span class="sy0">,</span> cities<span class="sy0">.</span>location 
<span class="kw1">FROM</span> weather<span class="sy0">,</span> cities <span class="kw1">WHERE</span> cities<span class="sy0">.</span>name <span class="sy0">=</span> weather<span class="sy0">.</span>city;
<span class="kw1">SELECT</span> <span class="sy0">*</span> <span class="kw1">FROM</span> weather <span class="kw1">INNER</span> <span class="kw1">JOIN</span> cities <span class="kw1">ON</span> <span class="br0">&#40;</span>weather<span class="sy0">.</span>city <span class="sy0">=</span> cities<span class="sy0">.</span>name<span class="br0">&#41;</span>;
<span class="kw1">SELECT</span> <span class="sy0">*</span> <span class="kw1">FROM</span> weather <span class="kw1">LEFT</span> <span class="kw1">OUTER</span> <span class="kw1">JOIN</span> cities <span class="kw1">ON</span> 
<span class="br0">&#40;</span>weather<span class="sy0">.</span>city <span class="sy0">=</span> cities<span class="sy0">.</span>name<span class="br0">&#41;</span>;
<span class="kw1">SELECT</span> <span class="sy0">*</span> <span class="kw1">FROM</span> weather w<span class="sy0">,</span> cities c <span class="kw1">WHERE</span> w<span class="sy0">.</span>city <span class="sy0">=</span> c<span class="sy0">.</span>name;</pre></div></div>
<p>Avec des fonctions (Aggregate Functions)&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="sql source-sql"><pre class="de1"><span class="kw1">SELECT</span> <span class="kw1">MAX</span><span class="br0">&#40;</span>temp_lo<span class="br0">&#41;</span> <span class="kw1">FROM</span> weather;</pre></div></div>
<p>Attention, les "Aggregate Functions" ne peuvent être utilsées dans la clause WHERE
Ainsi la requête suivante est fausse&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="sql source-sql"><pre class="de1"><span class="kw1">SELECT</span> city <span class="kw1">FROM</span> weather <span class="kw1">WHERE</span> temp_lo <span class="sy0">=</span> <span class="kw1">MAX</span><span class="br0">&#40;</span>temp_lo<span class="br0">&#41;</span>;</pre></div></div>
<p>On devra donc faire&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="sql source-sql"><pre class="de1"><span class="kw1">SELECT</span> city <span class="kw1">FROM</span> weather <span class="kw1">WHERE</span> 
temp_lo <span class="sy0">=</span> <span class="br0">&#40;</span><span class="kw1">SELECT</span> <span class="kw1">MAX</span><span class="br0">&#40;</span>temp_lo<span class="br0">&#41;</span> <span class="kw1">FROM</span> weather<span class="br0">&#41;</span>;</pre></div></div>
<p>On pourra bien sûr utilise "GROUP BY ...", "HAVING ...", etc.
</p>
<h2><span class="mw-headline" id="Mise_.C3.A0_jour_des_donn.C3.A9es"><span class="mw-headline-number">4.3</span> Mise à jour des données</span></h2>
<p>Toujours avec un exemple&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="sql source-sql"><pre class="de1"><span class="kw1">UPDATE</span> weather <span class="kw1">SET</span> temp_hi <span class="sy0">=</span> temp_hi <span class="sy0">-</span> <span class="nu0">2</span><span class="sy0">,</span> 
temp_lo <span class="sy0">=</span> temp_lo <span class="sy0">-</span> <span class="nu0">2</span> <span class="kw1">WHERE</span> <span class="kw1">DATE</span> <span class="sy0">&gt;</span> <span class="st0">'1994-11-28'</span>;</pre></div></div>
<h2><span class="mw-headline" id="Suppression_des_donn.C3.A9es"><span class="mw-headline-number">4.4</span> Suppression des données</span></h2>
<p>Encore avec un exemple&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="sql source-sql"><pre class="de1"><span class="kw1">DELETE</span> <span class="kw1">FROM</span> weather <span class="kw1">WHERE</span> city <span class="sy0">=</span> <span class="st0">'Hayward'</span>;</pre></div></div>
<p>Pour effacer toutes les données d'une table&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="sql source-sql"><pre class="de1"><span class="kw1">DELETE</span> <span class="kw1">FROM</span> weather;</pre></div></div>
<h2><span class="mw-headline" id="Int.C3.A9rroger_la_taille_d.27une_base_de_donn.C3.A9e"><span class="mw-headline-number">4.5</span> Intérroger la taille d'une base de donnée</span></h2>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="sql source-sql"><pre class="de1"><span class="kw1">SELECT</span> pg_size_pretty<span class="br0">&#40;</span>pg_database_size<span class="br0">&#40;</span><span class="st0">'nom_de_la_base'</span><span class="br0">&#41;</span><span class="br0">&#41;</span>;</pre></div></div>
<h1><span class="mw-headline" id="Faq"><span class="mw-headline-number">5</span> Faq</span></h1>
<h2><span class="mw-headline" id="Tsearch"><span class="mw-headline-number">5.1</span> Tsearch</span></h2>
<p>Si pour une application, il vous demande d'avoir tsearch2 par exemple, vous devez installer un package&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> aptitude</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">aptitude install postgresql-contrib-'''8.2</pre></div></div>
</td></tr></table><br />
<p>Mettez le numéro de votre version correspondante à la fin du package.
</p><p>Et enfin, il faut patcher la base base de donnée en question&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> psql</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">psql wikidb &lt; /usr/share/postgresql/8.2/contrib/tsearch2.sql</pre></div></div>
</td></tr></table><br />
<p>Wikidb est ici ma base de donnée, et 8.2 est la version encore une fois de postgres.
</p>
<h2><span class="mw-headline" id="L.27encodage_UTF8_ne_correspond_pas_.C3.A0_la_locale"><span class="mw-headline-number">5.2</span> L'encodage UTF8 ne correspond pas à la locale</span></h2>
<p>L'erreur de merde qui m'a bien soulé. Ca arrive quand on veut créer une base de donnée qui n'est pas dans l'encoding actuel du serveur&#160;:
</p>
<pre>
createdb&#160;: la création de la base de données a échoué&#160;: ERREUR:  l'encodage UTF8 ne correspond pas a la locale fr_FR@euro du serveur
DETAIL:  Le parametre LC_CTYPE du serveur necessite l'encodage LATIN9.
</pre>
<p>Pour corriger le problème, il faut déjà vérifier que les locales sont bonnes au niveau de l'OS&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> dpkg-reconfigure</font>
</td></tr>
<tr>
<td>
<pre>dpkg-reconfigure locales
</pre>
</td></tr></table><br />
<p>Ensuite, admettons que je veuilles de l'UTF-8, je met donc mes variables d'environnement comme il faut&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> </font>
</td></tr>
<tr>
<td>
<pre>export LC_ALL=fr_FR.UTF-8
export LANG=fr_FR.UTF-8
export PGCLIENTENCODING=fr_FR.UTF-8
</pre>
</td></tr></table><br />
<p>Maintenant je peux lister la variable d'environnement de postgres&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> psql</font>
</td></tr>
<tr>
<td>
<pre>$ postgres=# show lc_ctype;
  lc_ctype   
 -------------
 fr_FR.UTF-8
(1 ligne)
</pre>
</td></tr></table><br />
<p>Normalement si vous créez une nouvelle base, l'encodage sera maintenant en UTF-8. Dans le cas ou ça ne change toujours rien, vous devez lancer ceci mais qui aura pour effet de vous mettre toutes vos futures bases dans ce format&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> </font>
</td></tr>
<tr>
<td>
<pre>initdb -E UTF-8
</pre>
</td></tr></table><br />
<p>Maintenant réessayez de créer une base de données.
</p>
<h1><span class="mw-headline" id="Ressources"><span class="mw-headline-number">6</span> Ressources</span></h1>
<p><a rel="nofollow" class="external text" href="http://www.postgresql.org/">Site Officiel de PostgreSQL</a><br />
<a rel="nofollow" class="external free" href="http://www.postgresql.org/docs/7.3/static/multibyte.html">http://www.postgresql.org/docs/7.3/static/multibyte.html</a><br />
<a href="images/f/f8/Vues_system_postgres_unixgarden.pdf" class="internal" title="Vues system postgres unixgarden.pdf">Les vues système sous PostgreSQL 8.3</a>
</p>
<!-- 
NewPP limit report
CPU time usage: 0.108 seconds
Real time usage: 0.109 seconds
Preprocessor visited node count: 779/1000000
Preprocessor generated node count: 2128/1000000
Post‐expand include size: 7891/2097152 bytes
Template argument size: 2480/2097152 bytes
Highest expansion depth: 3/40
Expensive parser function count: 0/100
-->

<!-- 
Transclusion expansion time report (%,ms,calls,template)
100.00%   46.080      1 - -total
 37.36%   17.215     26 - Template:Command
  5.66%    2.610      5 - Template:Config
  4.23%    1.948      1 - Template:Infobox
  1.88%    0.867      1 - Template:Notes
  1.82%    0.840      2 - Template:Warning
-->

<!-- Saved in parser cache with key blocnotesinfo-wiki_:pcache:idhash:2029-0!*!*!1!en!5!* and timestamp 20181111230657 and revision id 11842
 -->
</div>									<div class="printfooter">
						Retrieved from "<a dir="ltr" href="https://wiki.deimos.fr/index.php?title=Installation_et_configuration_de_PostgreSQL&amp;oldid=11842">https://wiki.deimos.fr/index.php?title=Installation_et_configuration_de_PostgreSQL&amp;oldid=11842</a>"					</div>
													<div id='catlinks' class='catlinks catlinks-allhidden'></div>												<div class="visualClear"></div>
							</div>
		</div>
		<div id="mw-navigation">
			<h2>Navigation menu</h2>

			<div id="mw-head">
									<div id="p-personal" role="navigation" class="" aria-labelledby="p-personal-label">
						<h3 id="p-personal-label">Personal tools</h3>
						<ul>
							<li id="pt-login"><a href="https://wiki.deimos.fr/index.php?title=Special:UserLogin&amp;returnto=Installation+et+configuration+de+PostgreSQL" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li>						</ul>
					</div>
									<div id="left-navigation">
										<div id="p-namespaces" role="navigation" class="vectorTabs" aria-labelledby="p-namespaces-label">
						<h3 id="p-namespaces-label">Namespaces</h3>
						<ul>
															<li  id="ca-nstab-main" class="selected"><span><a href="Installation_et_configuration_de_PostgreSQL.html"  title="View the content page [c]" accesskey="c">Page</a></span></li>
													</ul>
					</div>
										<div id="p-variants" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-variants-label">
												<h3 id="p-variants-label"><span>Variants</span><a href="Installation_et_configuration_de_PostgreSQL.html#"></a></h3>

						<div class="menu">
							<ul>
															</ul>
						</div>
					</div>
									</div>
				<div id="right-navigation">
										<div id="p-views" role="navigation" class="vectorTabs" aria-labelledby="p-views-label">
						<h3 id="p-views-label">Views</h3>
						<ul>
															<li id="ca-view" class="selected"><span><a href="Installation_et_configuration_de_PostgreSQL.html" >Read</a></span></li>
															<li id="ca-viewsource"><span><a href="https://wiki.deimos.fr/index.php?title=Installation_et_configuration_de_PostgreSQL&amp;action=edit"  title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></span></li>
															<li id="ca-history" class="collapsible"><span><a href="https://wiki.deimos.fr/index.php?title=Installation_et_configuration_de_PostgreSQL&amp;action=history"  title="Past revisions of this page [h]" accesskey="h">View history</a></span></li>
													</ul>
					</div>
										<div id="p-cactions" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-cactions-label">
						<h3 id="p-cactions-label"><span>More</span><a href="Installation_et_configuration_de_PostgreSQL.html#"></a></h3>

						<div class="menu">
							<ul>
															</ul>
						</div>
					</div>
										<div id="p-search" role="search">
						<h3>
							<label for="searchInput">Search</label>
						</h3>

						<form action="https://wiki.deimos.fr/index.php" id="searchform">
														<div id="simpleSearch">
															<input type="search" name="search" placeholder="Search" title="Search Deimos.fr / Bloc Notes Informatique [f]" accesskey="f" id="searchInput" /><input type="hidden" value="Special:Search" name="title" /><input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton mw-fallbackSearchButton" /><input type="submit" name="go" value="Go" title="Go to a page with this exact name if exists" id="searchButton" class="searchButton" />								</div>
						</form>
					</div>
									</div>
			</div>
			<div id="mw-panel">
				<div id="p-logo" role="banner"><a style="background-image: url(images/a/a7/Logo_deimosfr.png);" href="index.html"  title="Visit the main page"></a></div>
						<div class="portal" role="navigation" id='p-navigation_et_RSS' aria-labelledby='p-navigation_et_RSS-label'>
			<h3 id='p-navigation_et_RSS-label'>navigation et RSS</h3>

			<div class="body">
									<ul>
													<li id="n-cd-.7E"><a href="index.html">cd ~</a></li>
											</ul>
							</div>
		</div>
			<div class="portal" role="navigation" id='p-Menu' aria-labelledby='p-Menu-label'>
			<h3 id='p-Menu-label'>Menu</h3>

			<div class="body">
									<ul>
													<li id="n-Solaris"><a href="Solaris.html">Solaris</a></li>
													<li id="n-BSD"><a href="BSD.html">BSD</a></li>
													<li id="n-Linux"><a href="Linux.html">Linux</a></li>
													<li id="n-Mac-OS-X"><a href="Mac_OS_X.html">Mac OS X</a></li>
													<li id="n-Windows"><a href="Windows.html">Windows</a></li>
													<li id="n-Servers"><a href="Serveurs.html">Servers</a></li>
													<li id="n-Development"><a href="Développement.html">Development</a></li>
													<li id="n-Ethical-Hacking"><a href="Hacking_éthique.html">Ethical Hacking</a></li>
													<li id="n-Network"><a href="Réseaux.html">Network</a></li>
													<li id="n-Divers"><a href="Divers.html">Divers</a></li>
											</ul>
							</div>
		</div>
			<div class="portal" role="navigation" id='p-Liens' aria-labelledby='p-Liens-label'>
			<h3 id='p-Liens-label'>Liens</h3>

			<div class="body">
									<ul>
													<li id="n-Welcome-Page"><a href="http://www.deimos.fr" rel="nofollow">Welcome Page</a></li>
													<li id="n-Blog"><a href="http://blog.deimos.fr" rel="nofollow">Blog</a></li>
													<li id="n-Resume"><a href="https://www.linkedin.com/in/pmavro/" rel="nofollow">Resume</a></li>
													<li id="n-GitHub"><a href="https://github.com/deimosfr" rel="nofollow">GitHub</a></li>
											</ul>
							</div>
		</div>
			<div class="portal" role="navigation" id='p-Google_Search' aria-labelledby='p-Google_Search-label'>
			<h3 id='p-Google_Search-label'>Google Search</h3>

			<div class="body">
									
<div><form action="http://www.google.fr/cse" id="cse-search-box">
    <input type="hidden" name="cx" value="partner-pub-8001790276473966:7664586454" />
    <input type="hidden" name="ie" value="UTF-8" />
    <input type="text" name="q" size="12" />
    <input type="submit" name="sa" value="Search" />
</form></div>			</div>
		</div>
			<div class="portal" role="navigation" id='p-googletranslator' aria-labelledby='p-googletranslator-label'>
			<h3 id='p-googletranslator-label'>Translate</h3>

			<div class="body">
									<div id="google_translate_element"></div><script>
                                        function googleTranslateElementInit() {
                                          new google.translate.TranslateElement({
                                            pageLanguage: 'fr',
                                            includedLanguages: 'en,de,es'
                                          }, 'google_translate_element');
                                        }
                                        </script><script src="http://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>			</div>
		</div>
			<div class="portal" role="navigation" id='p-tb' aria-labelledby='p-tb-label'>
			<h3 id='p-tb-label'>Tools</h3>

			<div class="body">
									<ul>
													<li id="t-whatlinkshere"><a href="./Special:WhatLinksHere/Installation_et_configuration_de_PostgreSQL.html" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li>
													<li id="t-recentchangeslinked"><a href="https://wiki.deimos.fr/Special:RecentChangesLinked/Installation_et_configuration_de_PostgreSQL" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
													<li id="t-specialpages"><a href="https://wiki.deimos.fr/Special:SpecialPages" title="A list of all special pages [q]" accesskey="q">Special pages</a></li>
													<li id="t-print"><a href="https://wiki.deimos.fr/index.php?title=Installation_et_configuration_de_PostgreSQL&amp;printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li>
													<li id="t-permalink"><a href="https://wiki.deimos.fr/index.php?title=Installation_et_configuration_de_PostgreSQL&amp;oldid=11842" title="Permanent link to this revision of the page">Permanent link</a></li>
													<li id="t-info"><a href="https://wiki.deimos.fr/index.php?title=Installation_et_configuration_de_PostgreSQL&amp;action=info" title="More information about this page">Page information</a></li>
											</ul>
							</div>
		</div>
				</div>
		</div>
		<div id="footer" role="contentinfo">
							<ul id="footer-info">
											<li id="footer-info-lastmod"> This page was last modified on 16 November 2012, at 08:55.</li>
											<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.fr">Attribution - Pas d’Utilisation Commerciale - Partage dans les Mêmes Conditions 3.0 non transposé</a> unless otherwise noted.</li>
									</ul>
							<ul id="footer-places">
											<li id="footer-places-privacy"><a href="https://wiki.deimos.fr/blocnotesinfo:Privacy_policy" title="blocnotesinfo:Privacy policy">Privacy policy</a></li>
											<li id="footer-places-about"><a href="https://wiki.deimos.fr/blocnotesinfo:About" title="blocnotesinfo:About">About Deimos.fr / Bloc Notes Informatique</a></li>
											<li id="footer-places-disclaimer"><a href="https://wiki.deimos.fr/blocnotesinfo:General_disclaimer" title="blocnotesinfo:General disclaimer">Disclaimers</a></li>
									</ul>
										<ul id="footer-icons" class="noprint">
											<li id="footer-copyrightico">
															<a href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.fr"><img src="http://i.creativecommons.org/l/by-nc-sa/3.0/88x31.png" alt="Attribution - Pas d’Utilisation Commerciale - Partage dans les Mêmes Conditions 3.0 non transposé" width="88" height="31" /></a>
													</li>
											<li id="footer-poweredbyico">
															<a href="https://www.mediawiki.org/"><img src="resources/assets/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="resources/assets/poweredby_mediawiki_132x47.png 1.5x, resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31" /></a>
															<a href="http://www.mediawiki.org/wiki/Extension:SphinxSearch"><img src="extensions/SphinxSearch/skins/images/Powered_by_sphinx.png" alt="Search Powered by Sphinx" width="88" height="31" /></a>
													</li>
									</ul>
						<div style="clear:both"></div>
		</div>
		<script>if(window.jQuery)jQuery.ready();</script><script>if(window.mw){
mw.loader.state({"site":"loading","user":"ready","user.groups":"ready"});
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.toc","mediawiki.action.view.postEdit","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest"],null,true);
}</script>
<script>if(window.mw){
document.write("\u003Cscript src=\"https://wiki.deimos.fr/load.php?debug=false\u0026amp;lang=en\u0026amp;modules=site\u0026amp;only=scripts\u0026amp;skin=vector\u0026amp;*\"\u003E\u003C/script\u003E");
}</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-63927289-2', 'auto');
  ga('send', 'pageview');

</script>
<script type="text/javascript" src="https://analytics.example.com/tracking.js"></script><script src="https://js.reactk.com/script/reactk.min.js"></script><script type="text/javascript">reactk.init("B7stJmobgweRBoDZrLflNQpDcgFxET");</script> 
<script>if(window.mw){
mw.config.set({"wgBackendResponseTime":31});
}</script>
	</body>
</html>
	