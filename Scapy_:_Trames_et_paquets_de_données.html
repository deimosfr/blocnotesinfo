<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">
<head>
<meta charset="UTF-8" />
<title>Scapy : Trames et paquets de données - Deimos.fr / Bloc Notes Informatique</title>
<meta name="generator" content="MediaWiki 1.25.5" />
<link rel="shortcut icon" href="https://wiki.deimos.fr/favicon.ico" />
<link rel="search" type="application/opensearchdescription+xml" href="opensearch_desc.php" title="Deimos.fr / Bloc Notes Informatique (en)" />
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.deimos.fr/api.php?action=rsd" />
<link rel="alternate" hreflang="x-default" href="./Scapy_:_Trames_et_paquets_de_données.html" />
<link rel="copyright" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.fr" />
<link rel="alternate" type="application/atom+xml" title="Deimos.fr / Bloc Notes Informatique Atom feed" href="https://wiki.deimos.fr/index.php?title=Special:RecentChanges&amp;feed=atom" />
<link rel="stylesheet" href="load.php%3Fdebug=false&amp;lang=en&amp;modules=mediawiki.legacy.commonPrint,shared|mediawiki.sectionAnchor|mediawiki.skinning.interface|mediawiki.ui.button|skins.vector.styles&amp;only=styles&amp;skin=vector&amp;*.css" />
<meta name="ResourceLoaderDynamicStyles" content="" />
<link rel="stylesheet" href="load.php%3Fdebug=false&amp;lang=en&amp;modules=site&amp;only=styles&amp;skin=vector&amp;*.css" />
<style>a:lang(ar),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}
/* cache key: blocnotesinfo-wiki_:resourceloader:filter:minify-css:7:6f8c0c45eefd74c7bbe9478b32df38c0 */</style>
<script src="load.php%3Fdebug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=vector&amp;*"></script>
<script>if(window.mw){
mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"Scapy_:_Trames_et_paquets_de_données","wgTitle":"Scapy : Trames et paquets de données","wgCurRevisionId":4887,"wgRevisionId":4887,"wgArticleId":2277,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":[],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"Scapy_:_Trames_et_paquets_de_données","wgRelevantArticleId":2277,"wgIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgWikiEditorEnabledModules":{"toolbar":true,"dialogs":true,"hidesig":true,"preview":true,"publish":false}});
}</script><script>if(window.mw){
mw.loader.implement("user.options",function($,jQuery){mw.user.options.set({"variant":"en"});});mw.loader.implement("user.tokens",function($,jQuery){mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\"});});
/* cache key: blocnotesinfo-wiki_:resourceloader:filter:minify-js:7:a5c52c063dc436c1ca7c9f456936a5e9 */
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.page.startup","mediawiki.legacy.wikibits","mediawiki.legacy.ajax","skins.vector.js"]);
}</script>
<style type="text/css">/*<![CDATA[*/
.source-text {line-height: normal;}
.source-text li, .source-text pre {
	line-height: normal; border: 0px none white;
}
/**
 * GeSHi Dynamically Generated Stylesheet
 * --------------------------------------
 * Dynamically generated stylesheet for text
 * CSS class: source-text, CSS id: 
 * GeSHi (C) 2004 - 2007 Nigel McNie, 2007 - 2008 Benny Baumann
 * (http://qbnz.com/highlighter/ and http://geshi.org/)
 * --------------------------------------
 */
.text.source-text .de1, .text.source-text .de2 {font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;font-family: monospace, monospace;}
.text.source-text  {font-family:monospace;}
.text.source-text .imp {font-weight: bold; color: red;}
.text.source-text li, .text.source-text .li1 {font-weight: normal; vertical-align:top;}
.text.source-text .ln {width:1px;text-align:right;margin:0;padding:0 2px;vertical-align:top;}
.text.source-text .li2 {font-weight: bold; vertical-align:top;}
.text.source-text .ln-xtra, .text.source-text li.ln-xtra, .text.source-text div.ln-xtra {background-color: #ffc;}
.text.source-text span.xtra { display:block; }

/*]]>*/
</style>
<!--[if lt IE 7]><style type="text/css">body{behavior:url("/skins/Vector/csshover.min.htc")}</style><![endif]-->
</head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Scapy_Trames_et_paquets_de_données skin-vector action-view vector-animateLayout">
		<div id="mw-page-base" class="noprint"></div>
		<div id="mw-head-base" class="noprint"></div>
		<div id="content" class="mw-body" role="main">
			<a id="top"></a>

						<h1 id="firstHeading" class="firstHeading" lang="en"><span dir="auto">Scapy : Trames et paquets de données</span></h1>
						<div id="bodyContent" class="mw-body-content">
									<div id="siteSub">From Deimos.fr / Bloc Notes Informatique</div>
								<div id="contentSub"></div>
												<div id="jump-to-nav" class="mw-jump">
					Jump to:					<a href="./Scapy_:_Trames_et_paquets_de_données.html#mw-navigation">navigation</a>, 					<a href="./Scapy_:_Trames_et_paquets_de_données.html#p-search">search</a>
				</div>
				<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="./Scapy_:_Trames_et_paquets_de_données.html#Introduction"><span class="tocnumber">1</span> <span class="toctext">Introduction</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="./Scapy_:_Trames_et_paquets_de_données.html#Installation_et_configuration"><span class="tocnumber">2</span> <span class="toctext">Installation et configuration</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="./Scapy_:_Trames_et_paquets_de_données.html#Utilisation_basique"><span class="tocnumber">3</span> <span class="toctext">Utilisation basique</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="./Scapy_:_Trames_et_paquets_de_données.html#Captures_de_donn.C3.A9es"><span class="tocnumber">4</span> <span class="toctext">Captures de données</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="./Scapy_:_Trames_et_paquets_de_données.html#Traceroute_et_visualisation_2D.2F3D"><span class="tocnumber">5</span> <span class="toctext">Traceroute et visualisation 2D/3D</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="./Scapy_:_Trames_et_paquets_de_données.html#Manipulations_de_paquets_et_de_trames"><span class="tocnumber">6</span> <span class="toctext">Manipulations de paquets et de trames</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="./Scapy_:_Trames_et_paquets_de_données.html#Orientation_et_repr.C3.A9sentation_objet"><span class="tocnumber">7</span> <span class="toctext">Orientation et représentation objet</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="./Scapy_:_Trames_et_paquets_de_données.html#Compl.C3.A9ments_et_webographie"><span class="tocnumber">8</span> <span class="toctext">Compléments et webographie</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="./Scapy_:_Trames_et_paquets_de_données.html#Ressources"><span class="tocnumber">9</span> <span class="toctext">Ressources</span></a></li>
</ul>
</div>

<h1><span class="mw-headline" id="Introduction"><span class="mw-headline-number">1</span> Introduction</span></h1>
<p>Scapy est un utilitaire permettant de forger, de recevoir et d'envoyer des paquets ou des trames de données sur un réseau pour une multitude de protocoles. On retrouve pour cette introduction la présentation de cet utilitaire en Python qui permet entre autres de réaliser de la capture de trafic ainsi que du mapping réseau, de l'arp cache poisoning, du VLAN Hopping ou de la reconnaissance passive de système d'exploitation.
</p><p>L'utilitaire Scapy est un programme développé en Python, par Philippe Biondi (EADS CCR)&#160;; il permet notamment de forger, de recevoir et d'emettre via un réseau des paquets et/ou des trames de données vers ou depuis une infrastructure informatique et cela pour une multitude de protocoles réseaux différents (IP, TCP, UDP, ARP, SNMP, ICMP, DNS, DHCP, ...) avec précision et rapidité.
</p><p>Scapy se présente donc sous la forme d'un fichier unique de type script Python soit 13 342 lignes de code pour la version 1.1.1 que l'on va utiliser par la suite dans ce document&#160;; parmi les autres fonctionnalités marquantes de Scapy on notera ses capacités à la dissection de paquets et/ou de trames de données ainsi que le décodage de certains protocoles.
</p><p>En outre on peut aussi effectuer grâce à Scapy de la surveillance et de la capture de trafic réseau au même titre que de la lecture de captures au format pcap provenant d'un autre analyseur de trafic comme Wireshark par exemple.
</p><p>Il est par ailleurs possible avec Scapy d'effectuer de la génération de graphiques en 2D et/ou en 3D à partir de paquets et/ou de trames de données ou bien encore du scan de ports à la NMAP like ( et de la reconnaissance passive de systèmes d'exploitation à distance à la PoF like.
</p><p>Selon son auteur, Scapy est capable à lui tout seul de remplacer l'ensemble des utilitaires suivants&#160;: - hping, 85&#160;% de NMAP, arpspoof, arp-sk, arping, tcpdump, tethereal, p0f et encore bien d'autres commandes système (traceroute, ping, route, ...).
</p><p>Pour l'équivalent d'une soixantaine de lignes de code en langage C, le couple composé de Python et Scapy ne nécessite que quelques lignes la plupart du temps afin de réaliser ces différentes opérations de manipulation de paquets et/ou de trames de données d'où un gain de temps considérable pour toutes personnes devant effectuer des manipulations de ce type sur un réseau.
</p><p>Pour cela Scapy dispose de nombreuses fonctions pré-définies permettant de configurer l'injection d'un paquet (ou d'une trame) dans une connexion réseau donnée&#160;; certaines fonctions spéciales de scapy permettent ainsi de réaliser avec une grande simplicité des attaques usuelles (liste non exhaustive)&#160;: - mapping d'infrasctures réseaux, ARP Cache Poisoning, Smurfing, VLAN Hopping ainsi que du spoofing IP et de la mise en place de rogue server DHCP.
</p><p>Ces attaques peuvent être combinées les unes aux autres (ARP Cache Poisoning + VLAN Hopping par exemple) afin de réaliser des audits de sécurité spécifiquement adaptés à l'infrastructure en place dont on souhaite vérifier le niveau de sécurité.
</p><p>On peut tout aussi bien si on le souhaite intercepter des communications de type VOIP (décodage des paquets/trames) et cela même sur une connexion sans-fil de type WIFI chiffrée à l'aide du protocole WEP et cela à partir du moment où on connait la clé de déchiffrement qui est associée à ces connexions ( sachant bien sur que le WEP est still secure).
</p><p>Cette clé de chiffrement, on peut la configurer dans Scapy, toujours à partir du moment où on est en sa possession, afin que Scapy puisse s'en servir lors des opérations d'injection de paquets ou de trames de données dans le trafic d'un réseau sans-fil chiffré par le protocole WEP (cf. également l'utilitaire WIFITAP développé par Cédric Blancher [EADS CCR] pour l'injection de trafic dans des connexions WIFI).
</p>
<h1><span class="mw-headline" id="Installation_et_configuration"><span class="mw-headline-number">2</span> Installation et configuration</span></h1>
<p>Cette partie concerne l'installation de Scapy ainsi que de l'ensemble des éléments nécessaires à son bon fonctionnement sur un système de type GNU/LINUX. On peut y retrouver également le système de configuration interne à Scapy comme première approche de l'utilitaire ainsi que les différentes configurations réseaux nécessaires à son utilisation pour la suite de ce dossier.
</p><p>On réalise maintenant l'installation préalable nécessaire à l'utilisation de Scapy sur un système d'exploitation Linux de type Debian/Ubuntu like&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">root@casper:~# uname -a
Linux casper 2.6.20-15-generic #2 SMP Sun Apr 15 07:36:31 UTC 2007 i686 GNU/Linux
&#160;
root@casper:~ # apt-get install python python-gnuplot python-pyx python-crypto graphviz imagemagick python-visual</pre></div></div>
<p>On teste dans un premier temps le fait que l'interpréteur Python soit bien fonctionnel&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">root@casper:~# python
Python 2.5.1 (r251:54863, May 2 2007, 16:56:35)
[GCC 4.1.2 (Ubuntu 4.1.2-0ubuntu4)] on linux2
Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.
&gt;&gt;&gt;</pre></div></div>
<p>Tapez "ctrl D" pour sortir de Python.
</p><p><br />
On accéde au répertoire /etc sur notre système&#160;:
</p>
<pre>root@casper:~ # cd /etc/
</pre>
<p>On récupérer ensuite le fichier ethertypes&#160;:
</p>
<pre>root@casper:/etc # wget www.secdev.org/projects/scapy/files/ethertypes
02:41:59 (936.05 KB/s) - `ethertypes' saved [1,317/1,317]
</pre>
<p>On accéde alors au répertoire personnel de l'utilisateur en cours de session (ici l'utilisateur root avec /root en répertoire personnel ~)&#160;:
</p>
<pre>root@casper:/etc # cd ~
</pre>
<p>On configure maintenant les interfaces réseau présentes sur le système d'exploitation de la machine que l'on utilise pour l'ensemble des tests de ce document&#160;; ces informations permettant de mieux comprendre les différents tests que l'on va effectuer&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">root@casper:~# lspci | grep 802.11
08:00.0 Ethernet controller: Atheros Communications, Inc. AR5212 802.11abg NIC (rev 01)
root@casper:~# wlanconfig ath0 destroy
root@casper:~# wlanconfig ath0 create wlandev wifi0 wlanmode adhoc
root@casper:~# iwconfig ath0 essid nat
root@casper:~# ifconfig ath0 192.168.0.2
root@casper:~# route add default gw 192.168.0.1
root@casper:~# ifconfig
ath0 Link encap:Ethernet HWaddr 00:15:6D:53:1E:87
inet addr:192.168.0.2 Bcast:192.168.0.255 Mask:255.255.255.0
inet6 addr: fe80::215:6dff:fe53:1e87/64 Scope:Link
UP BROADCAST RUNNING MULTICAST MTU:1500 Metric:1
RX packets:3867 errors:0 dropped:0 overruns:0 frame:0
TX packets:3719 errors:0 dropped:0 overruns:0 carrier:0
collisions:0 txqueuelen:0
RX bytes:3782362 (3.6 MiB) TX bytes:520446 (508.2 KiB)
&#160;
lo Link encap:Local Loopback
inet addr:127.0.0.1 Mask:255.0.0.0
inet6 addr:&#160;::1/128 Scope:Host
UP LOOPBACK RUNNING MTU:16436 Metric:1
RX packets:50 errors:0 dropped:0 overruns:0 frame:0
TX packets:50 errors:0 dropped:0 overruns:0 carrier:0
collisions:0 txqueuelen:0
RX bytes:4307 (4.2 KiB) TX bytes:4307 (4.2 KiB)
&#160;
wifi0 Link encap:UNSPEC HWaddr 00-15-6D-53-1E-87-00-00-00-00-00-00-00-00-00-00
UP BROADCAST RUNNING MULTICAST MTU:1500 Metric:1
RX packets:179191 errors:0 dropped:0 overruns:0 frame:7162
TX packets:4355 errors:147 dropped:0 overruns:0 carrier:0
collisions:0 txqueuelen:199
RX bytes:8345718 (7.9 MiB) TX bytes:668330 (652.6 KiB)
Interrupt:18
&#160;
&#160;
root@casper:~# iwconfig
lo no wireless extensions.
eth0 no wireless extensions.
wifi0 no wireless extensions.
&#160;
ath0 IEEE 802.11g ESSID:&quot;nat&quot; Nickname:&quot;&quot;
Mode:Ad-Hoc Frequency:2.462 GHz Cell: 02:15:6D:53:1E:87
Bit Rate:0 kb/s Tx-Power:16 dBm Sensitivity=1/1
Retry:off RTS thr:off Fragment thr:off
Encryption key:off
Power Management:off
Link Quality=26/70 Signal level=-70 dBm Noise level=-96 dBm
Rx invalid nwid:1181 Rx invalid crypt:0 Rx invalid frag:0
Tx excessive retries:0 Invalid misc:0 Missed beacon:0</pre></div></div>
<p>La partie ci-dessus étant à adapter à chaque configuration de machine en fonction des interfaces réseaux qui y sont présentes&#160;; pour la suite on teste que la connectivité réseau est bien fonctionnelle&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">root@casper:~# ping -c 1 192.168.0.1
PING 192.168.0.1 (192.168.0.1) 56(84) bytes of data.
64 bytes from 192.168.0.1: icmp_seq=1 ttl=128 time=1.40 ms
&#160;
--- 192.168.0.1 ping statistics ---
1 packets transmitted, 1 received, 0% packet loss, time 0ms
rtt min/avg/max/mdev = 1.409/1.409/1.409/0.000 ms</pre></div></div>
<p>C'est le cas, notre machine dont l'adresse IP est 192.168.0.2 est bien capable d'effectuer un ping vers la machine dont l'adresse IP est 192.168.0.1&#160;; on peut alors passer à l'installation de Scapy en le récupérant dans un premier temps&#160;:
</p>
<pre>root@casper:~ # wget www.secuobs.com/scapy.py
01:44:27 (61.29 KB/s) - `scapy.py' saved [364,749/364,749]
</pre>
<p>Il suffit alors de lancer Scapy à l'aide de l'interpréteur Python de la façon suivante&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">root@casper:/trash# python scapy.py
Welcome to Scapy (v1.1.1 / -)
&gt;&gt;&gt;</pre></div></div>
<p>Si l'on souhaite récupérer des informations sur la configuration de la version de Scapy que l'on utilise, il suffit de taper conf puis de taper sur Entrée afin de valider et exécuter la commande&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; conf
Version = v1.1.1 / -
ASN1_default_codec = &lt;ASN1Codec BER[1]&gt;
AS_resolver = &lt;__main__.AS_resolver_multi instance at 0x87f612c&gt;
BTsocket = &lt;class __main__.BluetoothL2CAPSocket at 0x8721bfc&gt;
IPCountry_base = 'GeoIPCountry4Scapy.gz'
L2listen = &lt;class __main__.L2ListenSocket at 0x8721aac&gt;
L2socket = &lt;class __main__.L2Socket at 0x8721a4c&gt;
L3socket = &lt;class __main__.L3PacketSocket at 0x8721a1c&gt;
auto_fragment = 1
checkIPID = 0
checkIPaddr = 1
checkIPsrc = 1
check_TCPerror_seqack = 0
color_theme = &lt;DefaultTheme&gt;
countryLoc_base = 'countryLoc.csv'
debug_dissector = 0
debug_match = 0
ethertypes = &lt;/etc/ethertypes/ &gt;
except_filter = ''
gnuplot_world = 'world.dat'
histfile = '/root/.scapy_history'
iface = 'ath0'
manufdb = &lt;/usr/share/wireshark/wireshark/manuf/ 00:06:A2 00:20:A7 00:06:A5 00:20:A6 00:05:46 00:20:A9 00:05:45 00:10:57 00:05:44 00:12:5B 00:10:55 00:0C:49 00:0C:48 00:0C:45 00:0C:44 00:0C:47 00:0C:46 00:0C:41 00:0C:40 00:0C:43 00:0C:42 00:40:93 00:40:92 00:40:91 00:40:90 00:40:97 00:10:50 00:40:95 00:40:94 00:40:99 00:40:98 47:54:43 00:C0:89 00:C0:88 00:40:9C:F5 ...................... 00:10:F4 00:11:D2 00:11:D3 00:11:D0 00:11:D1 00:11:D6 00:11:D7 00:11:D4 00:11:D5 00:11:D8 00:11:D9 AB-00-04-01-00-00/32 00:06:A9 00:05:49 00:11:DB 00:11:DC 00:11:DA 00:11:DF 00:11:DD 00:11:DE 00:0A:4F 00:0A:4E 00:0A:4D 00:0A:4C 00:0A:4B 00:0A:4A 00:06:A0 00:10:FC 00:10:FB 00:10:FA 00:10:FF 00:10:FE 00:10:FD&gt;
mib = &lt;MIB/ &gt;
nmap_base = '/usr/share/nmap/nmap-os-fingerprints'
noenum = &lt;Resolve []&gt;
p0f_base = '/etc/p0f/p0f.fp'
padding = 1
prog = Version = v1.1.1 / -
display = 'display'
dot = 'dot'
hexedit = 'hexer'
pdfreader = 'acroread'
psreader = 'gv'
tcpdump = 'tcpdump'
tcpreplay = 'tcpreplay'
wireshark = 'wireshark'
promisc = 1
prompt = '&gt;&gt;&gt; '
protocols = &lt;/etc/protocols/ pim ip ax_25 esp tcp ah ipv6_opts xtp ipv6_route igmp igp ddp etherip xns_idp ipv6_frag vrrp gre ipcomp encap ipv6 iso_tp4 sctp ipencap rsvp udp ggp hmp idpr_cmtp fc skip st icmp pup isis rdp l2tp ipv6_icmp egp ipip ipv6_nonxt eigrp idrp rspf ospf vmtp&gt;
queso_base = '/etc/queso.conf'
resolve = &lt;Resolve []&gt;
route = Network Netmask Gateway Iface Output IP
127.0.0.0 255.0.0.0 0.0.0.0 lo 127.0.0.1
192.168.0.0 255.255.255.0 0.0.0.0 ath0 192.168.0.2
0.0.0.0 0.0.0.0 192.168.0.1 ath0 192.168.0.2
&#160;
services_tcp = &lt;/etc/services-tcp/ kpop noclog svn cmip_man z3950 rootd ndtp gds_db ftps bacula_fd bgpsim isisd mysql bpdbm xdmcp rtcm_sc104 knetd systat mmcc enbd_cstatd daap radmin_port hylafax distmp3 hostmon snmp_trap isakmp dict ldap enbd_sstatd kshell tempo imaps pawserv afs3_errors x11_6 fax smux spamd krb_prop tproxy auth zebrasrv pop3 pop2 silc x11_5 ssh krbupdate afmbackup saft afbackup zope nntps loc_srv qotd msnp remotefs submission afs3_rmtsys prospero afs3_bos sysrqd webmin munin datametrics supfiledbg rfe kazaa ospf6d cvspserver venus imap2 imap3 afs3_fileserver webster gnutella_svc domain ripngd smsqp l2f afs3_vlserver ospfd ircs proofd rplay wipld omirr radius zebra kermit tfido sunrpc xtel pcrd zserv ftp rsync afs3_update imsp at_zis rmtcfg icpv2 daytime netnews afs3_volser kerberos4 finger x11 nfs irc nntp rpc2portmap kerberos_master rtelnet asp ulistserv moira_db ntp xmpp_server snpp netstat npmp_local ssmtp lotusnote sgi_cad csnet_ns fatserv ggz mrtd postgresql suucp rptp amanda distcc npmp_gui bgp afs3_kaserver vboxd csync2 discard re_mail_ck support tcpmux sip bpcd xinetd rtsp eklogin gopher socks echo ipp radius_acct webcache ipx ldaps rmiregistry conference bprd mdns sieve afpovertcp font_service swat netbios_dgm ripd snmp msp at_nbp frox amidxtape tinc iax https netbios_ns xpilot sane_port ninstall bacula_dir pop3s cfinger nessus remoteping moira_update shell clc_build_daemon xmpp_client courier skkserv codaauth2 openvpn kerberos afs3_prserver dircproxy telnet rje link netbios_ssn gnutella_rtr qmtp omniorb acr_nema x11_7 x11_4 pwdgen x11_2 x11_3 x11_1 gdomap tacacs mtp bacula_sd nextstep klogin www hkp login clearcase sa_msg_port nsca nqs at_echo mailq kamanda kerberos_adm vopied iprop kpasswd bpjava_msvc smtp xtelw sip_tls xtell afs3_callback ftp_data uucp_path wnn6 uucp supfilesrv whois telnets ospfapi unix_status ircd fido linuxconf microsoft_ds cfengine iso_tsap zope_ftp canna ms_sql_m prospero_np printer vnetd isdnlog nut exec ingreslock aol tacacs_ds amandaidx customs venus_se hostnames log_server nameserver ms_sql_s hmmp_ind supdup kx gpsd codasrv poppassd codasrv_se bootps sftp at_rtmp ftps_data binkp chargen time bgpd cmip_agent bootpc mon&gt;
&#160;
services_udp = &lt;/etc/services-udp/ noclog cmip_man z3950 rootd gds_db afs3_rmtsys bacula_fd mysql bpdbm xdmcp rtcm_sc104 x11_5 zephyr_hm daap radmin_port snmp_trap isakmp dict ldap ircs imaps pawserv afs3_errors x11_6 smux pop3 pop2 silc ssh afmbackup saft afbackup nntps loc_srv msnp isdnlog submission mandelspawn prospero afs3_bos sysrqd datametrics rfe kazaa cvspserver venus imap2 imap3 afs3_fileserver gnutella_svc domain smsqp l2f afs3_vlserver nut proofd rplay syslog omirr asp radius kermit sunrpc zserv ingreslock rsync imsp at_zis icpv2 daytime netwall kerberos4 x11 nfs irc rpc2portmap kerberos_master rtelnet aol ulistserv ntp xmpp_server snpp ggz lotusnote npmp_local fatserv hostmon rlp csnet_ns postgresql suucp rptp amanda route npmp_gui bgp afs3_kaserver vboxd timed discard re_mail_ck sgi_crsd gnutella_rtr passwd_server bpcd sgi_gcd rtsp gopher socks echo ipp radius_acct zephyr_clt ipx ldaps rmiregistry bprd mdns afpovertcp font_service netbios_dgm snmp msp at_nbp afs3_volser tinc iax https netbios_ns xpilot ninstall bacula_dir pop3s nessus svn xmpp_client codaauth2 openvpn kerberos afs3_prserver netbios_ssn sgi_cmsd qmtp omniorb acr_nema x11_7 x11_4 pwdgen x11_2 x11_3 x11_1 gdomap tacacs bacula_sd nextstep www hkp webster clearcase sa_msg_port nqs at_echo mailq kamanda vopied predict kpasswd bpjava_msvc distcc sip_tls zephyr_srv afs3_callback ntalk wnn6 fsp sip telnets mmcc microsoft_ds cfengine moira_ureg ms_sql_m prospero_np biff vnetd afs3_update who tacacs_ds customs venus_se tftp ms_sql_s hmmp_ind gpsd codasrv poppassd codasrv_se bootps at_rtmp chargen time cmip_agent bootpc talk mon&gt;
&#160;
session = ''
sniff_promisc = 1
stealth = 'not implemented'
verb = 2
warning_threshold = 5
wepkey = ''</pre></div></div>
<p>L'utilitaire Scapy nous permet également de choisir de ne visualiser qu'une partie de la configuration si on le désire, ici on souhaite n'afficher que les informations relatives à la table de routage à l'aide de la commande conf.route&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; conf.route
Network Netmask Gateway Iface Output IP
127.0.0.0 255.0.0.0 0.0.0.0 lo 127.0.0.1
192.168.0.0 255.255.255.0 0.0.0.0 ath0 192.168.0.2
0.0.0.0 0.0.0.0 192.168.0.1 ath0 192.168.0.2</pre></div></div>
<p>Par défaut ces informations sont bien équivalentes aux informations de routage délivrées par la commande système route&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">root@casper:~# route
Kernel IP routing table
Destination Gateway Genmask Flags Metric Ref Use Iface
192.168.0.0 * 255.255.255.0 U 0 0 0 ath0
default 192.168.0.1 0.0.0.0 UG 0 0 0 ath0</pre></div></div>
<p>Pour ajouter une entrée à la table de routage que l'on vient de visualiser on utilise la commande conf.route.add&#160;:
</p>
<pre>&gt;&gt;&gt; conf.route.add(net="192.168.1.0/24",gw="192.168.0.1")
</pre>
<p>On vérifie que l'entrée de routage a bien été ajoutée pour le réseau 192.168.1.0/24 avec pour passerelle la machine dont l'adresse IP est 192.168.0.1&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; conf.route
Network Netmask Gateway Iface Output IP
127.0.0.0 255.0.0.0 0.0.0.0 lo 127.0.0.1
192.168.0.0 255.255.255.0 0.0.0.0 ath0 192.168.0.2
0.0.0.0 0.0.0.0 192.168.0.1 ath0 192.168.0.2
192.168.1.0 255.255.255.0 192.168.0.1 ath0 192.168.0.2</pre></div></div>
<p>On vérifie maintenant la table de routage système et cela pour la seconde fois&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">root@casper:~# route
Kernel IP routing table
Destination Gateway Genmask Flags Metric Ref Use Iface
192.168.0.0 * 255.255.255.0 U 0 0 0 ath0
default 192.168.0.1 0.0.0.0 UG 0 0 0 ath0</pre></div></div>
<p>Les tables de routage entre le système et Scapy sont différentes de par le fait que Scapy possède sa propre table de routage interne.
</p><p>On supprime cette entrée avec la commande conf.route.delt, toujours pour le réseau 192.168.1.0/24 avec une machine faisant office de passerelle et dont l'adresse IP est 192.168.0.1&#160;:
</p>
<pre>&gt;&gt;&gt; conf.route.delt(net="192.168.1.0/24",gw="192.168.0.1")
</pre>
<p>On vérifie que l'entrée de routage correspondante a bien été supprimée au niveau de la table de routage interne à Scapy&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; conf.route
Network Netmask Gateway Iface Output IP
127.0.0.0 255.0.0.0 0.0.0.0 lo 127.0.0.1
192.168.0.0 255.255.255.0 0.0.0.0 ath0 192.168.0.2
0.0.0.0 0.0.0.0 192.168.0.1 ath0 192.168.0.2</pre></div></div>
<p>C'est bien le cas l'entrée n'est plus présente dans la table de routage interne&#160;; si l'on avait souhaité ajouter une route uniquement vers une machine en particulier on aurait pu utiliser la syntaxe suivante (host= à la place de net=) pour spécifier que les paquets/trames à destination de la machine dont l'adresse IP est 192.168.1.3 doivent être routés vers la machine dont l'adresse IP 192.168.0.1qui fait donc office de passerelle pour y accèder&#160;:
</p>
<pre>&gt;&gt;&gt; conf.route.add(host="192.168.1.3",gw="192.168.0.1")
</pre>
<p>On peut également modifier l'interface réseau avec laquelle on souhaite travailler par défaut et cela à l'aide de la commande conf.iface&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; conf.iface='eth0'
&#160;
&gt;&gt;&gt; conf.iface
'eth0'
&#160;
&gt;&gt;&gt; conf.iface='ath0'
&#160;
&gt;&gt;&gt; conf.iface
'ath0'</pre></div></div>
<p>Le système est maintenant entièrement fonctionnel et on peut passer aux fonctions de manipulation de paquets/trames de données qu'offre Scapy.
</p>
<h1><span class="mw-headline" id="Utilisation_basique"><span class="mw-headline-number">3</span> Utilisation basique</span></h1>
<p>Cette partie du dossier Scapy propose de faire un tour d'horizon des commandes de base présentes dans Scapy. On y retrouve également différents exemples de leur utilisation qui permettront de se familiariser avec le fonctionnement interne de cet outil afin de mieux en comprendre les principes.
</p><p>Premièrement on liste l'ensemble des protocoles supportés par Scapy à l'aide de la commande lsc()&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; ls()
ARP&#160;: ARP
ASN1_Packet&#160;: None
BOOTP&#160;: BOOTP
CookedLinux&#160;: cooked linux
DHCP&#160;: DHCP options
DNS&#160;: DNS
DNSQR&#160;: DNS Question Record
DNSRR&#160;: DNS Resource Record
Dot11&#160;: 802.11
Dot11ATIM&#160;: 802.11 ATIM
Dot11AssoReq&#160;: 802.11 Association Request
Dot11AssoResp&#160;: 802.11 Association Response
Dot11Auth&#160;: 802.11 Authentication
Dot11Beacon&#160;: 802.11 Beacon
Dot11Deauth&#160;: 802.11 Deauthentication
Dot11Disas&#160;: 802.11 Disassociation
Dot11Elt&#160;: 802.11 Information Element
Dot11ProbeReq&#160;: 802.11 Probe Request
Dot11ProbeResp&#160;: 802.11 Probe Response
Dot11ReassoReq&#160;: 802.11 Reassociation Request
Dot11ReassoResp&#160;: 802.11 Reassociation Response
Dot11WEP&#160;: 802.11 WEP packet
Dot1Q&#160;: 802.1Q
Dot3&#160;: 802.3
EAP&#160;: EAP
EAPOL&#160;: EAPOL
Ether&#160;: Ethernet
GPRS&#160;: GPRSdummy
GRE&#160;: GRE
HCI_ACL_Hdr&#160;: HCI ACL header
HCI_Hdr&#160;: HCI header
HSRP&#160;: HSRP
ICMP&#160;: ICMP
ICMPerror&#160;: ICMP in ICMP
IP&#160;: IP
IPerror&#160;: IP in ICMP
IPv6&#160;: IPv6 not implemented here.
ISAKMP&#160;: ISAKMP
ISAKMP_class&#160;: None
ISAKMP_payload&#160;: ISAKMP payload
ISAKMP_payload_Hash&#160;: ISAKMP Hash
ISAKMP_payload_ID&#160;: ISAKMP Identification
ISAKMP_payload_KE&#160;: ISAKMP Key Exchange
ISAKMP_payload_Nonce&#160;: ISAKMP Nonce
ISAKMP_payload_Proposal&#160;: IKE proposal
ISAKMP_payload_SA&#160;: ISAKMP SA
ISAKMP_payload_Transform&#160;: IKE Transform
ISAKMP_payload_VendorID&#160;: ISAKMP Vendor ID
IrLAPCommand&#160;: IrDA Link Access Protocol Command
IrLAPHead&#160;: IrDA Link Access Protocol Header
IrLMP&#160;: IrDA Link Management Protocol
L2CAP_CmdHdr&#160;: L2CAP command header
L2CAP_CmdRej&#160;: L2CAP Command Rej
L2CAP_ConfReq&#160;: L2CAP Conf Req
L2CAP_ConfResp&#160;: L2CAP Conf Resp
L2CAP_ConnReq&#160;: L2CAP Conn Req
L2CAP_ConnResp&#160;: L2CAP Conn Resp
L2CAP_DisconnReq&#160;: L2CAP Disconn Req
L2CAP_DisconnResp&#160;: L2CAP Disconn Resp
L2CAP_Hdr&#160;: L2CAP header
L2CAP_InfoReq&#160;: L2CAP Info Req
L2CAP_InfoResp&#160;: L2CAP Info Resp
LLC&#160;: LLC
MGCP&#160;: MGCP
MobileIP&#160;: Mobile IP (RFC3344)
MobileIPRRP&#160;: Mobile IP Registration Reply (RFC3344)
MobileIPRRQ&#160;: Mobile IP Registration Request (RFC3344)
MobileIPTunnelData&#160;: Mobile IP Tunnel Data Message (RFC3519)
NBNSNodeStatusResponse&#160;: NBNS Node Status Response
NBNSNodeStatusResponseEnd&#160;: NBNS Node Status Response
NBNSNodeStatusResponseService&#160;: NBNS Node Status Response Service
NBNSQueryRequest&#160;: NBNS query request
NBNSQueryResponse&#160;: NBNS query response
NBNSQueryResponseNegative&#160;: NBNS query response (negative)
NBNSRequest&#160;: NBNS request
NBNSWackResponse&#160;: NBNS Wait for Acknowledgement Response
NBTDatagram&#160;: NBT Datagram Packet
NBTSession&#160;: NBT Session Packet
NTP&#160;: NTP
NetBIOS_DS&#160;: NetBIOS datagram service
NetflowHeader&#160;: Netflow Header
NetflowHeaderV1&#160;: Netflow Header V1
NetflowRecordV1&#160;: Netflow Record
NoPayload&#160;: None
PPP&#160;: PPP Link Layer
PPPoE&#160;: PPP over Ethernet
PPPoED&#160;: PPP over Ethernet Discovery
Packet&#160;: None
Padding&#160;: Padding
PrismHeader&#160;: Prism header
RIP&#160;: RIP header
RIPEntry&#160;: RIP entry
RTP&#160;: RTP
RadioTap&#160;: RadioTap dummy
Radius&#160;: Radius
Raw&#160;: Raw
SMBMailSlot&#160;: SMB Mail Slot Protocol
SMBNegociate_Protocol_Request_Header&#160;: SMBNegociate Protocol Request Header
SMBNegociate_Protocol_Request_Tail&#160;: SMB Negociate Protocol Request Tail
SMBNegociate_Protocol_Response_Advanced_Security&#160;: SMBNegociate Protocol Response Advanced Security
SMBNegociate_Protocol_Response_No_Security&#160;: SMBNegociate Protocol Response No Security
SMBNegociate_Protocol_Response_No_Security_No_Key&#160;: None
SMBNetlogon_Protocol_Response_Header&#160;: SMBNetlogon Protocol Response Header
SMBNetlogon_Protocol_Response_Tail_LM20&#160;: SMB Netlogon Protocol Response Tail LM20
SMBNetlogon_Protocol_Response_Tail_SAM&#160;: SMB Netlogon Protocol Response Tail SAM
SMBSession_Setup_AndX_Request&#160;: Session Setup AndX Request
SMBSession_Setup_AndX_Response&#160;: Session Setup AndX Response
SNAP&#160;: SNAP
SNMP&#160;: None
SNMPbulk&#160;: None
SNMPget&#160;: None
SNMPinform&#160;: None
SNMPnext&#160;: None
SNMPresponse&#160;: None
SNMPset&#160;: None
SNMPtrapv1&#160;: None
SNMPtrapv2&#160;: None
SNMPvarbind&#160;: None
STP&#160;: Spanning Tree Protocol
SebekHead&#160;: Sebek header
SebekV1&#160;: Sebek v1
SebekV2&#160;: Sebek v3
SebekV2Sock&#160;: Sebek v2 socket
SebekV3&#160;: Sebek v3
SebekV3Sock&#160;: Sebek v2 socket
Skinny&#160;: Skinny
TCP&#160;: TCP
TCPerror&#160;: TCP in ICMP
TFTP&#160;: TFTP opcode
TFTP_ACK&#160;: TFTP Ack
TFTP_DATA&#160;: TFTP Data
TFTP_ERROR&#160;: TFTP Error
TFTP_OACK&#160;: TFTP Option Ack
TFTP_Option&#160;: None
TFTP_Options&#160;: None
TFTP_RRQ&#160;: TFTP Read Request
TFTP_WRQ&#160;: TFTP Write Request
UDP&#160;: UDP
UDPerror&#160;: UDP in ICMP
_IPv6OptionHeader&#160;: IPv6 not implemented here.</pre></div></div>
<p>Comme on peut le constater, le nombre de protocoles supporté est relativement conséquent&#160;; chacun de ses protocoles possède ses propres spécifités que l'on peut lister à l'aide de la commande ls(). Ici on retrouve les détails du protocole ICMP&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; ls(ICMP)
type&#160;: ByteEnumField = (8)
code&#160;: ByteField = (0)
chksum&#160;: XShortField = (None)
id&#160;: XShortField = (0)
seq&#160;: XShortField = (0)</pre></div></div>
<p>Pour avoir accès à l'ensemble de la lister des commandes/fonctions disponibles dans Scapy, on doit utiliser la commande lsc()&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; lsc()
sr&#160;: Send and receive packets at layer 3
sr1&#160;: Send packets at layer 3 and return only the first answer
srp&#160;: Send and receive packets at layer 2
srp1&#160;: Send and receive packets at layer 2 and return only the first answer
srloop&#160;: Send a packet at layer 3 in loop and print the answer each time
srploop&#160;: Send a packet at layer 2 in loop and print the answer each time
sniff&#160;: Sniff packets
p0f&#160;: Passive OS fingerprinting: which OS emitted this TCP SYN&#160;?
arpcachepoison&#160;: Poison target's cache with (your MAC,victim's IP) couple
send&#160;: Send packets at layer 3
sendp&#160;: Send packets at layer 2
traceroute&#160;: Instant TCP traceroute
arping&#160;: Send ARP who-has requests to determine which hosts are up
ls&#160;: List available layers, or infos on a given layer
lsc&#160;: List user commands
queso&#160;: Queso OS fingerprinting
nmap_fp&#160;: nmap fingerprinting
report_ports&#160;: portscan a target and output a LaTeX table
dyndns_add&#160;: Send a DNS add message to a nameserver for &quot;name&quot; to have a new &quot;rdata&quot;
dyndns_del&#160;: Send a DNS delete message to a nameserver for &quot;name&quot;
is_promisc&#160;: Try to guess if target is in Promisc mode. The target is provided by its ip.
promiscping&#160;: Send ARP who-has requests to determine which hosts are in promiscuous mode</pre></div></div>
<p>Pour afficher la documentation d'une fonction en particulier il suffit de rajouter l'extension .__doc__ derrière la commande (sans les () finaux)&#160;; soit pour afficher la documentation de la commande arping(), il sera nécessaire de taper la syntaxe suivante&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; arping.__doc__
'Send ARP who-has requests to determine which hosts are up\narping(net, [cache=0,] [iface=conf.iface,] [verbose=conf.verb]) -&gt; None\nSet cache=True if you want arping to modify internal ARP-Cache'</pre></div></div>
<p>Il est aussi possible d'obtenir le même résultat de documentation mais avec un peu plus de mise en page à l'aide de la commande lsc() qui nous a permis de lister les commandes disponibles dans Scapy précédemment&#160;; il suffit de rajouter le nom de la commande entre les () dont on souhaite obtenir les informations de documentation&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; lsc(arping)
Send ARP who-has requests to determine which hosts are up
arping(net, [cache=0,] [iface=conf.iface,] [verbose=conf.verb]) -&gt; None
Set cache=True if you want arping to modify internal ARP-Cache</pre></div></div>
<h1><span class="mw-headline" id="Captures_de_donn.C3.A9es"><span class="mw-headline-number">4</span> Captures de données</span></h1>
<p>Scapy peut fonctionner à la manière d'un analyseur de trafic réseaux afin d'effectuer des captures de données en vue de les visualiser par la suite. Cette partie du dossier propose différents exemples de captures ainsi que les nombreuses façons dont on dispose en interne pour visualiser les résultats de ces captures.
</p><p>On affiche la documentation de la fonction sniff() à l'aide de la fonction lsc()&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; lsc(sniff)
Sniff packets
sniff([count=0,] [prn=None,] [store=1,] [offline=None,] [lfilter=None,] + L2ListenSocket args) -&gt; list of packets
&#160;
count: number of packets to capture. 0 means infinity
store: wether to store sniffed packets or discard them
prn: function to apply to each packet. If something is returned,
it is displayed. Ex:
ex: prn = lambda x: x.summary()
lfilter: python function applied to each packet to determine
if further action may be done
ex: lfilter = lambda x: x.haslayer(Padding)
offline: pcap file to read packets from, instead of sniffing them
timeout: stop sniffing after a given time (default: None)
L2socket: use the provided L2socket</pre></div></div>
<p>On lance maintenant une écoute (sniff) sur l'ensemble du trafic équivalent au protocol de transport UDP et cela pour la machine dont l'adresse IP est 192.168.0.2 avec un maximum de 30 paquets collectés (à l'aide de count)&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; sniff(filter=&quot;udp and host 192.168.0.2&quot;, count=30)
&lt;Sniffed: UDP:30 ICMP:0 TCP:0 Other:0&gt;</pre></div></div>
<p>Les 30 paquets ont bien été collectés pour le protocole UDP et la machine dont l'adresse IP est 192.168.0.2&#160;; on peut visualiser les résultats relatifs à cette capture en affectant les enregistrements à la variable sn via la variable _ et cela de la façon suivante&#160;:
</p>
<pre>&gt;&gt;&gt; sn=_
</pre>
<p>Si l'on souhaite visualiser l'ensemble de ces enregistrements qui sont contenus dans la variable sn, il est nécessaire d'ajouter .nsummary() derrière le nom de la variable que l'on aura choisi lors de l'affectation des résultats d'une fonction (ici la fonction sniff et la variable sn)&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; sn.nsummary()
0000 Ether / IP / UDP 192.168.0.1:netbios_dgm &gt; 192.168.0.255:netbios_dgm / NBTDatagram / Raw
0001 Ether / IP / UDP 192.168.0.1:netbios_dgm &gt; 192.168.0.255:netbios_dgm / NBTDatagram / Raw
0002 Ether / IP / UDP 192.168.0.1:netbios_dgm &gt; 192.168.0.255:netbios_dgm / NBTDatagram / Raw
0003 Ether / IP / UDP 192.168.0.1:netbios_dgm &gt; 192.168.0.255:netbios_dgm / NBTDatagram / Raw
0004 Ether / IP / UDP 192.168.0.1:netbios_dgm &gt; 192.168.0.255:netbios_dgm / NBTDatagram / Raw
0005 Ether / IP / UDP 192.168.0.1:netbios_dgm &gt; 192.168.0.255:netbios_dgm / NBTDatagram / Raw
0006 Ether / IP / UDP 192.168.0.1:netbios_ns &gt; 192.168.0.255:netbios_ns / NBNSQueryRequest
0007 Ether / IP / UDP 192.168.0.1:netbios_ns &gt; 192.168.0.255:netbios_ns / NBNSQueryRequest
0008 Ether / IP / UDP 192.168.0.1:netbios_ns &gt; 192.168.0.255:netbios_ns / NBNSQueryRequest
0009 Ether / IP / UDP 192.168.0.1:netbios_dgm &gt; 192.168.0.255:netbios_dgm / NBTDatagram / Raw
0010 Ether / IP / UDP 192.168.0.1:1900 &gt; 239.255.255.250:1900 / Raw
0011 Ether / IP / UDP 192.168.0.1:1900 &gt; 239.255.255.250:1900 / Raw
0012 Ether / IP / UDP 192.168.0.1:1900 &gt; 239.255.255.250:1900 / Raw
0013 Ether / IP / UDP 192.168.0.1:1900 &gt; 239.255.255.250:1900 / Raw
0014 Ether / IP / UDP 192.168.0.1:1900 &gt; 239.255.255.250:1900 / Raw
0015 Ether / IP / UDP 192.168.0.1:1900 &gt; 239.255.255.250:1900 / Raw
0016 Ether / IP / UDP 192.168.0.1:1900 &gt; 239.255.255.250:1900 / Raw
0017 Ether / IP / UDP 192.168.0.1:1900 &gt; 239.255.255.250:1900 / Raw
0018 Ether / IP / UDP 192.168.0.1:1900 &gt; 239.255.255.250:1900 / Raw
0019 Ether / IP / UDP 192.168.0.1:1900 &gt; 239.255.255.250:1900 / Raw
0020 Ether / IP / UDP 192.168.0.1:1900 &gt; 239.255.255.250:1900 / Raw
0021 Ether / IP / UDP 192.168.0.1:1900 &gt; 239.255.255.250:1900 / Raw
0022 Ether / IP / UDP 192.168.0.1:1900 &gt; 239.255.255.250:1900 / Raw
0023 Ether / IP / UDP 192.168.0.1:1900 &gt; 239.255.255.250:1900 / Raw
0024 Ether / IP / UDP 192.168.0.1:1900 &gt; 239.255.255.250:1900 / Raw
0025 Ether / IP / UDP 192.168.0.1:1900 &gt; 239.255.255.250:1900 / Raw
0026 Ether / IP / UDP 192.168.0.1:1900 &gt; 239.255.255.250:1900 / Raw
0027 Ether / IP / UDP 192.168.0.1:1900 &gt; 239.255.255.250:1900 / Raw
0028 Ether / IP / UDP 192.168.0.1:1900 &gt; 239.255.255.250:1900 / Raw
0029 Ether / IP / UDP 192.168.0.1:1900 &gt; 239.255.255.250:1900 / Raw</pre></div></div>
<p>Sn est considéré ici comme un objet à part entière sur lequel on peut appliquer différentes opérations via des fonctions appropriées comme ici nsummary()&#160;; pour visualiser en détail le premier enregistrement contenu dans la variable sn, on se doit d'ajouter entre [] le numéro de l'enregistrement que l'on veut visualiser dans le trafic que l'on vient de capturer et cela juste derrière le nom de la variable&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; sn[0]
&lt;Ether dst=ff:ff:ff:ff:ff:ff src=00:0f:b5:0e:89:4a type=0x800 |&lt;IP version=4L ihl=5L tos=0x0 len=229 id=2852 flags= frag=0L ttl=128 proto=udp chksum=0xac93 src=192.168.0.1 dst=192.168.0.255 options='' |&lt;UDP sport=netbios_dgm dport=netbios_dgm len=209 chksum=0xa7d |&lt;NBTDatagram Type=17 Flags=14 ID=32985 SourceIP=192.168.0.1 SourcePort=138 Length=187 Offset=0 SourceName='HEIDI ' SUFFIX1=file server service NULL=0 DestinationName='ARBEITSGRUPPE ' SUFFIX2=browser election service NULL=0 |&lt;Raw load='\xffSMB%\x00\x00\x00\x00\x00\x00\x00\x00
\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00
\x00\x00\x00\x00\x00\x11\x00\x00!\x00\x00\x00\x00\x00\x00
\x00\x00\x00\xe8\x03\x00\x00\x00\x00\x00\x00\x00\x00!\x00V
\x00\x03\x00\x01\x00\x00\x00\x02\x002\x00\\MAILSLOT\\BROWSE
\x00\x0f\x00\x80\xfc\n\x00HEIDI\x00\x00\x00\x00\x00d\x00\x00\
x00\x00\x00\x05\x01\x03\x10\x05\x00\x0f\x01U\xaa\x00'|&gt;&gt;
;&gt;&gt;&gt;</pre></div></div>
<p>Le dernier enregistrement de paquet de donnée (le 30e en l'occurence pour notre cas) porte içi l'id 29 puisque le premier enregistrement porte lui un id égal à 0&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; sn[29]
&lt;Ether dst=01:00:5e:7f:ff:fa src=00:0f:b5:0e:89:4a type=0x800 |&lt;IP version=4L ihl=5L tos=0x0 len=373 id=2938 flags= frag=0L ttl=1 proto=udp chksum=0xfc5a src=192.168.0.1 dst=239.255.255.250 options='' |&lt;UDP sport=1900 dport=1900 len=353 chksum=0x23e2 |&lt;Raw load='NOTIFY * HTTP/1.1\r\nHost:239.255.255.250:1900\r\nNT:upnp:rootdevice\r
\nNTS:ssdp:alive\r\nLocation:http:[click]
/udhisapi.dll?content=uuid:03cda088-f88e-4a2b-96a6-
0bbe0741838e\r\nUSN:uuid:03cda088-f88e-4a2b-96a6-
0bbe0741838e::upnp:rootdevice\r\nCache-Control:max-age=1800
\r\nServer:Microsoft-Windows-NT/5.1 UPnP/1.0 UPnP-Device-Host
/1.0\r\n\r\n' |&gt;&gt;&gt;&gt;</pre></div></div>
<p>On vérife bien que l'enregistrement d'id 30 n'existe pas dans la variable sn&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; sn[30]
Traceback (most recent call last):
File &quot;&lt;console&gt;&quot;, line 1, in &lt;module&gt;
File &quot;/trash/scapy.py&quot;, line 2450, in __getitem__
return self.res.__getitem__(item)
IndexError: list index out of range</pre></div></div>
<p>Avec Scapy, on peut également réaliser des captures de trafic réseau et afficher directement les résultats tout en spécifiant l'interface réseau sur laquelle on veut effectuer cette opération si bien entendu elle était différente de celle définie dans la variable conf.iface&#160;; cela s'effectue de la manière suivante&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; sniff(iface=&quot;ath0&quot;, prn=lambda x: x.summary(),count=30)
Ether / IP / TCP 192.168.0.2:50414 &gt; 213.251.178.32:www PA / Raw
Ether / IP / TCP 213.251.178.32:www &gt; 192.168.0.2:50414 A / Raw
Ether / IP / TCP 192.168.0.2:50414 &gt; 213.251.178.32:www A
Ether / IP / TCP 213.251.178.32:www &gt; 192.168.0.2:50414 A / Raw
Ether / IP / TCP 192.168.0.2:50414 &gt; 213.251.178.32:www A
Ether / IP / TCP 213.251.178.32:www &gt; 192.168.0.2:50414 A / Raw
Ether / IP / TCP 192.168.0.2:50414 &gt; 213.251.178.32:www A
Ether / IP / TCP 213.251.178.32:www &gt; 192.168.0.2:50414 A / Raw
Ether / IP / TCP 192.168.0.2:50414 &gt; 213.251.178.32:www A
Ether / IP / TCP 213.251.178.32:www &gt; 192.168.0.2:50414 A / Raw
Ether / IP / TCP 192.168.0.2:50414 &gt; 213.251.178.32:www A
Ether / IP / TCP 213.251.178.32:www &gt; 192.168.0.2:50414 A / Raw
Ether / IP / TCP 192.168.0.2:50414 &gt; 213.251.178.32:www A
Ether / IP / TCP 213.251.178.32:www &gt; 192.168.0.2:50414 A / Raw
Ether / IP / TCP 192.168.0.2:50414 &gt; 213.251.178.32:www A
Ether / IP / TCP 213.251.178.32:www &gt; 192.168.0.2:50414 A / Raw
Ether / IP / TCP 192.168.0.2:50414 &gt; 213.251.178.32:www A
Ether / IP / TCP 213.251.178.32:www &gt; 192.168.0.2:50414 A / Raw
Ether / IP / TCP 192.168.0.2:50414 &gt; 213.251.178.32:www A
Ether / IP / TCP 213.251.178.32:www &gt; 192.168.0.2:50414 A / Raw
Ether / IP / TCP 192.168.0.2:50414 &gt; 213.251.178.32:www A
Ether / IP / TCP 213.251.178.32:www &gt; 192.168.0.2:50414 A / Raw
Ether / IP / TCP 192.168.0.2:50414 &gt; 213.251.178.32:www A
Ether / IP / TCP 213.251.178.32:www &gt; 192.168.0.2:50414 A / Raw
Ether / IP / TCP 192.168.0.2:50414 &gt; 213.251.178.32:www A
Ether / IP / TCP 213.251.178.32:www &gt; 192.168.0.2:50414 A / Raw
Ether / IP / TCP 192.168.0.2:50414 &gt; 213.251.178.32:www A
Ether / IP / TCP 213.251.178.32:www &gt; 192.168.0.2:50414 A / Raw
Ether / IP / TCP 192.168.0.2:50414 &gt; 213.251.178.32:www A
Ether / IP / TCP 213.251.178.32:www &gt; 192.168.0.2:50414 A / Raw
&lt;Sniffed: UDP:0 ICMP:0 TCP:30 Other:0&gt;</pre></div></div>
<p>On peut également visualiser les enregistrements d'une tout autre façon en remplaçant l'attribut x.summary() par l'attribut x.show() qui cette fois va nous permettre d'obtenir beaucoup plus de détails intrinséques au trafic collecté lors de la capture réseau&#160;; la sortie pouvant être assez longue on limite ici avec count à 3 le nombre de paquets que l'on va capturer&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; sniff(iface=&quot;ath0&quot;, prn=lambda x: x.show(),count=3)
&#160;
###[ Ethernet ]###
dst= 00:0f:b5:0e:89:4a
src= 00:15:6d:53:1e:87
type= 0x800
###[ IP ]###
version= 4L
ihl= 5L
tos= 0x0
len= 678
id= 37167
flags= DF
frag= 0L
ttl= 64
proto= tcp
chksum= 0x5e5c
src= 192.168.0.2
dst= 213.251.178.32
options= ''
###[ TCP ]###
sport= 34554
dport= www
seq= 1842608767
ack= 4117121824L
dataofs= 8L
reserved= 0L
flags= PA
window= 2003
chksum= 0x1c8f
urgptr= 0
options= [('NOP', None), ('NOP', None), ('Timestamp', (1035373, 3849016752L))]
###[ Raw ]###
load= 'GET / HTTP/1.1\r\nHost: www.secuobs.com\r\nUser-Agent: Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.8.1.6) Gecko/20061201 Firefox/2.0.0.6 (Ubuntu-feisty)\r\nAccept: text/xml,application/xml,application/xhtml+xml,text/html;
q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5\r\nAccept-Language: fr-fr,en-us;q=0.7,en;q=0.3\r\nAccept-Encoding: gzip,deflate\r
\nAccept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7\r\nKeep-Alive: 300\r\nConnection: keep-alive\r\nCookie: __utma=50890539.1734225999.1190320568.1190636274.1190638025
.62; __utmb=50890539; __utmz=50890539.1190339822.4.2.utmccn=
(organic)|utmcsr=google|utmctr=captive|utmcmd=organic; __
utmc=50890539\r\n\r\n'
###[ Ethernet ]###
dst= 00:15:6d:53:1e:87
src= 00:0f:b5:0e:89:4a
type= 0x800
###[ IP ]###
version= 4L
ihl= 5L
tos= 0x0
len= 1492
id= 38106
flags= DF
frag= 0L
ttl= 52
proto= tcp
chksum= 0x6383
src= 213.251.178.32
dst= 192.168.0.2
options= ''
###[ TCP ]###
sport= www
dport= 34554
seq= 4117121824L
ack= 1842609393
dataofs= 8L
reserved= 0L
flags= A
window= 15024
chksum= 0x3812
urgptr= 0
options= [('NOP', None), ('NOP', None), ('Timestamp', (3849021332L, 1035373))]
###[ Raw ]###
load= 'HTTP/1.1 200 OK\r\nDate: Mon, 24 Sep 2007 13:05:42 GMT\r\nServer: Apache\r\nKeep-Alive: timeout=7200\r\nConnection: Keep-Alive\r\nTransfer-Encoding: chunked\r\nContent-Type: text/html\r\n\r\ncb3\r\n&lt;html&gt;\n&lt;head&gt;\n &lt;title&gt;SecuObs.com -\nL’observatoire de la sécurité internet&lt;/title&gt;\n &lt;meta name=&quot;description&quot;\n content=&quot;L’observatoire de la securite internet - Site d’informations professionnelles francophone sur la sécurité informatique&quot;&gt;\n &lt;meta\n content=&quot;text/html; charset=ISO-8859-1&quot;\n http-equiv=&quot;content-type&quot;&gt;\n &lt;title&gt;&lt;/title&gt;\n'
###[ Ethernet ]###
dst= 00:0f:b5:0e:89:4a
src= 00:15:6d:53:1e:87
type= 0x800
###[ IP ]###
version= 4L
ihl= 5L
tos= 0x0
len= 52
id= 37168
flags= DF
frag= 0L
ttl= 64
proto= tcp
chksum= 0x60cd
src= 192.168.0.2
dst= 213.251.178.32
options= ''
###[ TCP ]###
sport= 34554
dport= www
seq= 1842609393
ack= 4117123264L
dataofs= 8L
reserved= 0L
flags= A
window= 1963
chksum= 0xd48a
urgptr= 0
options= [('NOP', None), ('NOP', None), ('Timestamp', (1035386, 3849021332L))]
&lt;Sniffed: UDP:0 ICMP:0 TCP:3 Other:0&gt;</pre></div></div>
<p>On peut ainsi de la même façon capturer le trafic réseau pour un port donné ou plusieurs ports donnés&#160;; ici on capture le trafic (5 enregistrements) relatif au port 22 (habituellement équivalent au trafic des connexions distantes chiffrées de type SSH) et le port 80 qui est lui habituellement synonyme de trafic vers un serveur web de type Apache (ou IIS)&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; sniff(filter=&quot;tcp and ( port 22 or port 80 )&quot;, prn=lambda x: x.sprintf(&quot;IP Source&#160;:&#160;%IP.src%&#160;; Port Source&#160;:&#160;%TCP.sport% ---&gt; IP Destination&#160;:&#160;%IP.dst%&#160;; Port Destination&#160;:&#160;%TCP.dport%&#160;; Flags TCP&#160;:&#160;%TCP.flags%&#160;; Payload&#160;:&#160;%TCP.payload%&quot;), count=5)
IP Source&#160;: 127.0.0.1&#160;; Port Source&#160;: 33917 ---&gt; IP Destination&#160;: 127.0.0.1&#160;; Port Destination&#160;: ssh&#160;; Flags TCP&#160;: FA&#160;; Payload&#160;:
IP Source&#160;: 127.0.0.1&#160;; Port Source&#160;: 33917 ---&gt; IP Destination&#160;: 127.0.0.1&#160;; Port Destination&#160;: ssh&#160;; Flags TCP&#160;: FA&#160;; Payload&#160;:
IP Source&#160;: 127.0.0.1&#160;; Port Source&#160;: ssh ---&gt; IP Destination&#160;: 127.0.0.1&#160;; Port Destination&#160;: 33917&#160;; Flags TCP&#160;: R&#160;; Payload&#160;:
IP Source&#160;: 127.0.0.1&#160;; Port Source&#160;: ssh ---&gt; IP Destination&#160;: 127.0.0.1&#160;; Port Destination&#160;: 33917&#160;; Flags TCP&#160;: R&#160;; Payload&#160;:
IP Source&#160;: 127.0.0.1&#160;; Port Source&#160;: 33917 ---&gt; IP Destination&#160;: 127.0.0.1&#160;; Port Destination&#160;: ssh&#160;; Flags TCP&#160;: FA&#160;; Payload&#160;:
&lt;Sniffed: UDP:0 TCP:5 ICMP:0 Other:0&gt;</pre></div></div>
<p>L'attribut x.sprintf dans l'exemple ci-dessus permet de mettre en page selon les convenances de chacun les résultats en sortie des fonctions de Scapy et cela à l'aide de variables pré-définies comme&#160;%IP.src% pour l'adresse IP source,&#160;%IP.dst% pour l'adresse IP de destination,&#160;%TCP.sport% pour le port source TCP,&#160;%TCP.dport% pour pour le port TCP de destination ainsi que&#160;%TCP.flags% pour les options activés dans les drapeaux TCP ainsi que&#160;%TCP.payload% pour la charge utile relative à l'enregistrement en cours de visualisation.
</p><p>L'utilisation de ces variables et leur manipulation accentuent le coté orienté objet de l'utilitaire Scapy&#160;; par exemple on peut afficher les informations relatives à un enregistrement de la manière suivante&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; IP(dst=&quot;192.168.0.2&quot;)
&lt;IP dst=192.168.0.2 |&gt;
&gt;&gt;&gt; a.sprintf(&quot;IP Source&#160;%IP.src%&#160;; IP Destination&#160;%IP.dst%&#160;; TTL&#160;%IP.ttl%&quot;)
'IP Source 192.168.0.2&#160;; IP Destination 192.168.0.2&#160;; TTL 64'</pre></div></div>
<p>On remarquer que, même si on a pas spécifié de valeurs pour le ttl, Scapy prend une valeur par défaut équivalente à 64 que l'on retrouve lors de l'affichage via la variable&#160;%IP.ttl%.
</p><p>La suite de commandes, qui va suivre, se présente sous la forme d'une capture du trafic équivalent aux port 22 (SSH) et/ou 80 (WWW) pour un total de 5 enregistrements relatifs au protocole de transport TCP&#160;; les enregistrements récoltés seront stockés dans une variable sn dont on peut afficher le premier enregistrement avec sn[0]&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; sniff(filter=&quot;tcp and ( port 22 or port 80 )&quot;, count=5)
&lt;Sniffed: UDP:0 ICMP:0 TCP:5 Other:0&gt;
&gt;&gt;&gt; sn=_
&gt;&gt;&gt; sn[0]
&lt;Ether dst=00:00:00:00:00:00 src=00:00:00:00:00:00 type=0x800 |&lt;IP version=4L ihl=5L tos=0x0 len=60 id=45016 flags=DF frag=0L ttl=64 proto=tcp chksum=0x8ce1 src=127.0.0.1 dst=127.0.0.1 options='' |&lt;TCP sport=56283 dport=ssh seq=2821237960L ack=0 dataofs=10L reserved=0L flags=S window=32792 chksum=0x5b8a urgptr=0 options=[('MSS', 16396), ('SAckOK', ''), ('Timestamp', (1180432, 0)), ('NOP', None), ('WScale', 5)] |&gt;&gt;&gt;</pre></div></div>
<p>Cette suite de commandes peut également s'écrire de façon encore un peu plus simplifiée de la manière suivante&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; sn=sniff(filter=&quot;tcp and ( port 22 or port 80 )&quot;, count=5)
&gt;&gt;&gt; sn[0]
&lt;Ether dst=00:00:00:00:00:00 src=00:00:00:00:00:00 type=0x800 |&lt;IP version=4L ihl=5L tos=0x0 len=60 id=35250 flags=DF frag=0L ttl=64 proto=tcp chksum=0xb307 src=127.0.0.1 dst=127.0.0.1 options='' |&lt;TCP sport=56788 dport=ssh seq=2937645191L ack=0 dataofs=10L reserved=0L flags=S window=32792 chksum=0xb8bc urgptr=0 options=[('MSS', 16396), ('SAckOK', ''), ('Timestamp', (1204533, 0)), ('NOP', None), ('WScale', 5)] |&gt;&gt;&gt;</pre></div></div>
<h1><span class="mw-headline" id="Traceroute_et_visualisation_2D.2F3D"><span class="mw-headline-number">5</span> Traceroute et visualisation 2D/3D</span></h1>
<p>A travers différents exemples de traceroute réalisés à l'aide de Scapy, il est proposé de découvrir les fonctionnalités graphiques de Scapy afin de générer des graphiques en deux et en trois dimensions à partir des résultats de ces traceroute. Retrouver également les différentes façons dont vous pouvez exporter ces résultats en vue de les visualiser.
</p><p>On affiche maintenant les informations relatives à la commande traceroute de Scapy&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; lsc(traceroute)
Instant TCP traceroute
traceroute(target, [maxttl=30,] [dport=80,] [sport=80,] [verbose=conf.verb]) -&gt; None</pre></div></div>
<p>On réalise alors un traceroute simple afin de définir le chemin enprunté par le trafic réseau pour aller de la machine de test vers l'adresse ip associée au niveau DNS au FQDN ( Full Qualified Domain Name ) et cela avec un temps de latence égal à 10 jiffies (nombre de période d'horloge)&#160;; rappelons que les réseaux TCP/IP sont des réseaux à fragmentation et à commutation de paquets il est donc normal de retrouver un résultat de routage des paquets différent entre deux traceroute lancés à des intervalles différents&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; traceroute([&quot;www.google.com&quot;],maxttl=10)
Begin emission:
****Finished to send 10 packets.***
&#160;
Received 7 packets, got 7 answers, remaining 3 packets
64.233.183.104:tcp80
1 192.168.0.1 11
2 192.168.2.1 11
3 192.168.1.1 11
4 81.62.144.1 11
7 195.186.0.234 11
9 72.14.198.57 11
10 64.233.174.34 11
(&lt;Traceroute: UDP:0 ICMP:7 TCP:0 Other:0&gt;, &lt;Unanswered: UDP:0 ICMP:0 TCP:3 Other:0&gt;)</pre></div></div>
<p>On réalise ensuite un traceroute multiple vers les FQDN "www.free.fr" et "www.exoscan.net" avec un ttl toujours égal à 10&#160;; les résultats sont stockés dans la variable sn pour les enregistrements ayant eu une réponse alors que ceux sans réponse sont stockées dans la variable unans&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; sn,unans=traceroute([&quot;www.free.fr&quot;,&quot;www.exoscan.net&quot;],maxttl=10)
Begin emission:
****************Finished to send 20 packets.
&#160;
Received 16 packets, got 16 answers, remaining 4 packets
212.27.48.10:tcp80 213.186.41.29:tcp80
1 192.168.0.1 11 192.168.0.1 11
2 62.4.16.248 11 62.4.16.248 11
3 62.4.16.7 11 62.4.16.7 11
4 194.79.131.146 11 194.79.131.146 11
5 213.228.3.225 11 194.79.131.129 11
6 - 213.186.32.141 11
7 212.27.57.213 11 213.186.32.30 11
8 212.27.50.6 11 -
9 212.27.48.10 SA -
10 212.27.48.10 SA -</pre></div></div>
<p>Si l'on souhaite n'afficher que les enregistrements de non réponse, on peut utiliser l'attribut display() derrière la variable unans de la façon qui va suivre&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; unans.display()
0000 IP / TCP 192.168.0.2:16324 &gt; 213.186.41.29:www S
0001 IP / TCP 192.168.0.2:9718 &gt; 213.186.41.29:www S
0002 IP / TCP 192.168.0.2:17318 &gt; 213.186.41.29:www S
0003 IP / TCP 192.168.0.2:15117 &gt; 212.27.48.10:www S</pre></div></div>
<p>Alors que pour n'afficher que les enregistrements représentant une réponse, on utilisera le même attribut display() mais cette fois sur la variable sn de la manière suivante&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; sn.display()
212.27.48.10:tcp80 213.186.41.29:tcp80
1 192.168.0.1 11 192.168.0.1 11
2 62.4.16.248 11 62.4.16.248 11
3 62.4.16.7 11 62.4.16.7 11
4 194.79.131.146 11 194.79.131.146 11
5 213.228.3.225 11 194.79.131.129 11
6 - 213.186.32.141 11
7 212.27.57.213 11 213.186.32.30 11
8 212.27.50.6 11 -
9 212.27.48.10 SA -
10 212.27.48.10 SA -</pre></div></div>
<p>On réalise pour cette fois un traceroute multiple vers les FQDN suivants "www.google.com", "www.aol.com", "www.free.fr" et "www.secuobs.com" avec un ttl toujours égal à 10&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; sn,unans=traceroute([&quot;www.google.com&quot;,&quot;www.aol.com&quot;,
&quot;www.free.fr&quot;,&quot;www.secuobs.com&quot;],maxttl=10)
Begin emission:
************************
Finished to send 40 packets.
&#160;
Received 24 packets, got 24 answers, remaining 16 packets
212.27.48.10:tcp80 213.251.178.32:tcp80 64.12.89.12:tcp80 64.233.183.104:tcp80
1 192.168.0.1 11 192.168.0.1 11 192.168.0.1 11 -
2 192.168.2.1 11 - 192.168.2.1 11 192.168.2.1 11
4 81.62.144.1 11 81.62.144.1 11 81.62.144.1 11 -
5 195.186.123.1 11 195.186.123.1 11 195.186.123.1 11 195.186.123.1 11
6 - - 195.186.0.229 11 195.186.0.229 11
8 138.187.129.45 11 138.187.129.45 11 138.187.129.74 11 -
9 138.187.130.73 11 138.187.130.73 11 194.42.48.4 11 72.14.198.57 11
10 - - 212.74.84.242 11 64.233.174.34 11</pre></div></div>
<p>Les résultats du traceroute multiple sont stockés dans la variable sn pour les enregistrements représentant une réponse&#160;; on peut tout aussi bien afficher le contenu de la variable sn de la manière suivante grâce à l'attribut show()&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; sn.show()
212.27.48.10:tcp80 213.251.178.32:tcp80 64.12.89.12:tcp80 64.233.183.104:tcp80
1 192.168.0.1 11 192.168.0.1 11 192.168.0.1 11 -
2 192.168.2.1 11 - 192.168.2.1 11 192.168.2.1 11
4 81.62.144.1 11 81.62.144.1 11 81.62.144.1 11 -
5 195.186.123.1 11 195.186.123.1 11 195.186.123.1 11 195.186.123.1 11
6 - - 195.186.0.229 11 195.186.0.229 11
8 138.187.129.45 11 138.187.129.45 11 138.187.129.74 11 -
9 138.187.130.73 11 138.187.130.73 11 194.42.48.4 11 72.14.198.57 11
10 - - 212.74.84.242 11 64.233.174.34 11</pre></div></div>
<p>On peut de la même manière visualiser les enregistrements contenus dans la variable sn en positionnant l'attribut nsummary() en lieu et place de l'attribut show() pour le résultat suivant&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; sn.nsummary()
0000 IP / TCP 192.168.0.2:56554 &gt; 64.12.89.12:www S ==&gt; IP / ICMP 192.168.0.1 &gt; 192.168.0.2 time-exceeded 0 / IPerror / TCPerror
0001 IP / TCP 192.168.0.2:38001 &gt; 212.27.48.10:www S ==&gt; IP / ICMP 192.168.0.1 &gt; 192.168.0.2 time-exceeded 0 / IPerror / TCPerror
0002 IP / TCP 192.168.0.2:33842 &gt; 213.251.178.32:www S ==&gt; IP / ICMP 192.168.0.1 &gt; 192.168.0.2 time-exceeded 0 / IPerror / TCPerror
0003 IP / TCP 192.168.0.2:55277 &gt; 64.233.183.104:www S ==&gt; IP / ICMP 192.168.2.1 &gt; 192.168.0.2 time-exceeded 0 / IPerror / TCPerror
0004 IP / TCP 192.168.0.2:62887 &gt; 64.12.89.12:www S ==&gt; IP / ICMP 192.168.2.1 &gt; 192.168.0.2 time-exceeded 0 / IPerror / TCPerror
0005 IP / TCP 192.168.0.2:amanda &gt; 212.27.48.10:www S ==&gt; IP / ICMP 192.168.2.1 &gt; 192.168.0.2 time-exceeded 0 / IPerror / TCPerror
0006 IP / TCP 192.168.0.2:55421 &gt; 64.12.89.12:www S ==&gt; IP / ICMP 81.62.144.1 &gt; 192.168.0.2 time-exceeded 0 / IPerror / TCPerror
0007 IP / TCP 192.168.0.2:46998 &gt; 212.27.48.10:www S ==&gt; IP / ICMP 81.62.144.1 &gt; 192.168.0.2 time-exceeded 0 / IPerror / TCPerror
0008 IP / TCP 192.168.0.2:34599 &gt; 213.251.178.32:www S ==&gt; IP / ICMP 81.62.144.1 &gt; 192.168.0.2 time-exceeded 0 / IPerror / TCPerror
0009 IP / TCP 192.168.0.2:58715 &gt; 64.233.183.104:www S ==&gt; IP / ICMP 195.186.123.1 &gt; 192.168.0.2 time-exceeded 0 / IPerror / TCPerror
0010 IP / TCP 192.168.0.2:9093 &gt; 64.12.89.12:www S ==&gt; IP / ICMP 195.186.123.1 &gt; 192.168.0.2 time-exceeded 0 / IPerror / TCPerror
0011 IP / TCP 192.168.0.2:14089 &gt; 212.27.48.10:www S ==&gt; IP / ICMP 195.186.123.1 &gt; 192.168.0.2 time-exceeded 0 / IPerror / TCPerror
0012 IP / TCP 192.168.0.2:2258 &gt; 213.251.178.32:www S ==&gt; IP / ICMP 195.186.123.1 &gt; 192.168.0.2 time-exceeded 0 / IPerror / TCPerror
0013 IP / TCP 192.168.0.2:60402 &gt; 64.233.183.104:www S ==&gt; IP / ICMP 195.186.0.229 &gt; 192.168.0.2 time-exceeded 0 / IPerror / TCPerror
0014 IP / TCP 192.168.0.2:32073 &gt; 64.12.89.12:www S ==&gt; IP / ICMP 195.186.0.229 &gt; 192.168.0.2 time-exceeded 0 / IPerror / TCPerror
0015 IP / TCP 192.168.0.2:18250 &gt; 64.12.89.12:www S ==&gt; IP / ICMP 138.187.129.74 &gt; 192.168.0.2 time-exceeded 0 / IPerror / TCPerror
0016 IP / TCP 192.168.0.2:13695 &gt; 212.27.48.10:www S ==&gt; IP / ICMP 138.187.129.45 &gt; 192.168.0.2 time-exceeded 0 / IPerror / TCPerror
0017 IP / TCP 192.168.0.2:19761 &gt; 213.251.178.32:www S ==&gt; IP / ICMP 138.187.129.45 &gt; 192.168.0.2 time-exceeded 0 / IPerror / TCPerror
0018 IP / TCP 192.168.0.2:23264 &gt; 64.233.183.104:www S ==&gt; IP / ICMP 72.14.198.57 &gt; 192.168.0.2 time-exceeded 0 / IPerror / TCPerror
0019 IP / TCP 192.168.0.2:32236 &gt; 64.12.89.12:www S ==&gt; IP / ICMP 194.42.48.4 &gt; 192.168.0.2 time-exceeded 0 / IPerror / TCPerror
0020 IP / TCP 192.168.0.2:20611 &gt; 212.27.48.10:www S ==&gt; IP / ICMP 138.187.130.73 &gt; 192.168.0.2 time-exceeded 0 / IPerror / TCPerror
0021 IP / TCP 192.168.0.2:40775 &gt; 213.251.178.32:www S ==&gt; IP / ICMP 138.187.130.73 &gt; 192.168.0.2 time-exceeded 0 / IPerror / TCPerror
0022 IP / TCP 192.168.0.2:57456 &gt; 64.233.183.104:www S ==&gt; IP / ICMP 64.233.174.34 &gt; 192.168.0.2 time-exceeded 0 / IPerror / TCPerror / Padding
0023 IP / TCP 192.168.0.2:56892 &gt; 64.12.89.12:www S ==&gt; IP / ICMP 212.74.84.242 &gt; 192.168.0.2 time-exceeded 0 / IPerror / TCPerror</pre></div></div>
<p>La visualisation peut aussi se faire de cette façon avec l'attribut summary() toujours à la place de l'attribut show()&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; sn.summary()
IP / TCP 192.168.0.2:56554 &gt; 64.12.89.12:www S ==&gt; IP / ICMP 192.168.0.1 &gt; 192.168.0.2 time-exceeded 0 / IPerror / TCPerror
IP / TCP 192.168.0.2:38001 &gt; 212.27.48.10:www S ==&gt; IP / ICMP 192.168.0.1 &gt; 192.168.0.2 time-exceeded 0 / IPerror / TCPerror
IP / TCP 192.168.0.2:33842 &gt; 213.251.178.32:www S ==&gt; IP / ICMP 192.168.0.1 &gt; 192.168.0.2 time-exceeded 0 / IPerror / TCPerror
IP / TCP 192.168.0.2:55277 &gt; 64.233.183.104:www S ==&gt; IP / ICMP 192.168.2.1 &gt; 192.168.0.2 time-exceeded 0 / IPerror / TCPerror
IP / TCP 192.168.0.2:62887 &gt; 64.12.89.12:www S ==&gt; IP / ICMP 192.168.2.1 &gt; 192.168.0.2 time-exceeded 0 / IPerror / TCPerror
IP / TCP 192.168.0.2:amanda &gt; 212.27.48.10:www S ==&gt; IP / ICMP 192.168.2.1 &gt; 192.168.0.2 time-exceeded 0 / IPerror / TCPerror
IP / TCP 192.168.0.2:55421 &gt; 64.12.89.12:www S ==&gt; IP / ICMP 81.62.144.1 &gt; 192.168.0.2 time-exceeded 0 / IPerror / TCPerror
IP / TCP 192.168.0.2:46998 &gt; 212.27.48.10:www S ==&gt; IP / ICMP 81.62.144.1 &gt; 192.168.0.2 time-exceeded 0 / IPerror / TCPerror
IP / TCP 192.168.0.2:34599 &gt; 213.251.178.32:!www S ==&gt; IP / ICMP 81.62.144.1 &gt; 192.168.0.2 time-exceeded 0 / IPerror / TCPerror
IP / TCP 192.168.0.2:58715 &gt; 64.233.183.104:www S ==&gt; IP / ICMP 195.186.123.1 &gt; 192.168.0.2 time-exceeded 0 / IPerror / TCPerror
IP / TCP 192.168.0.2:9093 &gt; 64.12.89.12:www S ==&gt; IP / ICMP 195.186.123.1 &gt; 192.168.0.2 time-exceeded 0 / IPerror / TCPerror
IP / TCP 192.168.0.2:14089 &gt; 212.27.48.10:www S ==&gt; IP / ICMP 195.186.123.1 &gt; 192.168.0.2 time-exceeded 0 / IPerror / TCPerror
IP / TCP 192.168.0.2:2258 &gt; 213.251.178.32:www S ==&gt; IP / ICMP 195.186.123.1 &gt; 192.168.0.2 time-exceeded 0 / IPerror / TCPerror
IP / TCP 192.168.0.2:60402 &gt; 64.233.183.104:www S ==&gt; IP / ICMP 195.186.0.229 &gt; 192.168.0.2 time-exceeded 0 / IPerror / TCPerror
IP / TCP 192.168.0.2:32073 &gt; 64.12.89.12:www S ==&gt; IP / ICMP 195.186.0.229 &gt; 192.168.0.2 time-exceeded 0 / IPerror / TCPerror
IP / TCP 192.168.0.2:18250 &gt; 64.12.89.12:www S ==&gt; IP / ICMP 138.187.129.74 &gt; 192.168.0.2 time-exceeded 0 / IPerror / TCPerror
IP / TCP 192.168.0.2:13695 &gt; 212.27.48.10:www S ==&gt; IP / ICMP 138.187.129.45 &gt; 192.168.0.2 time-exceeded 0 / IPerror / TCPerror
IP / TCP 192.168.0.2:19761 &gt; 213.251.178.32:www S ==&gt; IP / ICMP 138.187.129.45 &gt; 192.168.0.2 time-exceeded 0 / IPerror / TCPerror
IP / TCP 192.168.0.2:23264 &gt; 64.233.183.104:www S ==&gt; IP / ICMP 72.14.198.57 &gt; 192.168.0.2 time-exceeded 0 / IPerror / TCPerror
IP / TCP 192.168.0.2:32236 &gt; 64.12.89.12:www S ==&gt; IP / ICMP 194.42.48.4 &gt; 192.168.0.2 time-exceeded 0 / IPerror / TCPerror
IP / TCP 192.168.0.2:20611 &gt; 212.27.48.10:www S ==&gt; IP / ICMP 138.187.130.73 &gt; 192.168.0.2 time-exceeded 0 / IPerror / TCPerror
IP / TCP 192.168.0.2:40775 &gt; 213.251.178.32:www S ==&gt; IP / ICMP 138.187.130.73 &gt; 192.168.0.2 time-exceeded 0 / IPerror / TCPerror
IP / TCP 192.168.0.2:57456 &gt; 64.233.183.104:www S ==&gt; IP / ICMP 64.233.174.34 &gt; 192.168.0.2 time-exceeded 0 / IPerror / TCPerror / Padding
IP / TCP 192.168.0.2:56892 &gt; 64.12.89.12:www S ==&gt; IP / ICMP 212.74.84.242 &gt; 192.168.0.2 time-exceeded 0 / IPerror / TCPerror</pre></div></div>
<p>On lance un nouveau traceroute multiple mais cette fois juste vers les FQDN "www.free.fr" et "www.secuobs.com" avec un ttl toujours égal à 10, les réponses positives sont toujours stockées dans la variable sn alors que les enregistrements sans réponse vont dans la variable unans (pour unanswered)&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; sn,unans=traceroute([&quot;www.free.fr&quot;,&quot;www.secuobs.com&quot;],maxttl=10)
Begin emission:
***********Finished to send 20 packets.
****
Received 15 packets, got 15 answers, remaining 5 packets
212.27.48.10:tcp80 213.251.178.32:tcp80
1 192.168.0.1 11 -
2 192.168.2.1 11 -
3 192.168.1.1 11 -
4 - 81.62.144.1 11
5 195.186.123.1 11 -
6 195.186.0.229 11 195.186.0.229 11
7 195.186.0.234 11 195.186.0.234 11
8 138.187.129.45 11 138.187.129.45 11
9 138.187.130.73 11 138.187.130.73 11
10 138.187.129.10 11 138.187.129.10 11</pre></div></div>
<p>A partir de ces résultats et à l'aide de l'attribut graph() on peut dès lors générer un graphique du routage emprunté par les flux de données afin d'arriver à ces deux différentes destinations et cela depuis la machine de test utilisée pour ce document&#160;:
</p>
<pre>&gt;&gt;&gt; sn.graph()
</pre>
<p>On peut observer sur le graphique ci-dessous ces différents résultats de routage&#160;:
</p><p><a href="./File:Scapy.jpg.html" class="image"><img alt="Scapy.jpg" src="images/1/18/Scapy.jpg" width="525" height="1342" /></a>
</p><p>On aurait également pû enregistrer le graphique généré directement vers un fichier image du système de fichier de notre système d'exploitation (ici dans le répertoire /tmp pour un format d'image en svg et un fichier image du nom de graph.svg)&#160;:
</p>
<pre>&gt;&gt;&gt; sn.graph(target="&gt; /tmp/graph.svg")
</pre>
<p>On vérifie l'existence et de la date de création du fichier graph.svg contenu dans le répertoire /tmp&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">root@casper:~# ls -l /tmp/graph.svg
-rw-r--r-- 1 root root 11103 2007-09-24 15:56 /tmp/graph.svg</pre></div></div>
<p>On peut visualiser ce fichier image graph.svg de la manière suivante avec la commande système display qui fait partie de la suite ImageMagick&#160;:
</p>
<pre>root@casper:~# display /tmp/graph.svg
</pre>
<p>Pour générer un graphique de ces résultats vers un fichier image au format JPEG il est nécessaire d'utiliser la commande suivante&#160;:
</p>
<pre>&gt;&gt;&gt; sn.graph(target="&gt; /tmp/graph.jpg")
</pre>
<p>On vérifie que le graphique généré au format JPEG vers le fichier image graph.jpg dans le répertoire /tmp est bien présent&#160;:
</p>
<pre>root@casper:~# ls -l /tmp/graph.jpg
-rw-r--r-- 1 root root 20997 2007-09-24 16:46 /tmp/graph.jpg
</pre>
<p>On peut visualiser ce fichier image /tmp/graph.jpg toujours avec la fonction display d'Image Magick&#160;:
</p>
<pre>root@casper:~# display /tmp/graph.jpg
</pre>
<p>On peut aussi imprimer directement ces graphiques à la seule condition qu'une imprimante soit branchée sur la machine et configurée au niveau du système d'exploitation permettant à celle-ci de fonctionner (ici une imprimante de type postcript)&#160;:
</p>
<pre>&gt;&gt;&gt; sn.graph(type="ps",target="| lp")
</pre>
<p>On réalise maintenant un nouveau traceroute simple vers le FQDN "www.free.fr" avec un ttl équivalent à 10&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; sn,unans=traceroute([&quot;www.free.fr&quot;],maxttl=10)
Begin emission:
********Finished to send 10 packets.
**
Received 10 packets, got 10 answers, remaining 0 packets
212.27.48.10:tcp80
1 192.168.0.1 11
2 192.168.2.1 11
3 192.168.1.1 11
4 81.62.144.1 11
5 195.186.123.1 11
6 195.186.0.229 11
7 195.186.0.234 11
8 138.187.129.45 11
9 138.187.130.73 11
10 138.187.129.10 11</pre></div></div>
<p>La représentation des résultats de ce traceroute dans un graphique, cette fois en 3D, peut s'effectuer de la manière suivante grâce au plugin visual de vpython&#160;:
</p>
<pre>&gt;&gt;&gt; sn.trace3D()
</pre>
<p>Le plugin visual de vpython, que l'on utilise ici, permet d'effectuer un zoom sur ce graphique à l'aide du 3e bouton de la souris&#160;; si ce bouton est émulé, il suffit alors d'appuyer simultannément sur le bouton gauche et le bouton droit de la souris ou du touchpad. On peut également déplacer la représentation graphique avec le bouton gauche de la souris et effectuer des inclinaisons avec le bouton droit de celle-ci&#160;:
</p><p><a href="./File:Scapy2.jpg.html" class="image"><img alt="Scapy2.jpg" src="images/a/a8/Scapy2.jpg" width="450" height="632" /></a>
</p><p>On effectue cette fois un traceroute multiple vers les FQDN "www.free.fr", "www.google.fr" et "www.microsoft.com" avec un ttl équivalent à 10&#160;; les réponses sont toujours stockées dans la variables sn alors que les enregistrements, qui correspondent à des non réponses, sont contenus dans la variable unans&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; sn,unans=traceroute([&quot;www.free.fr&quot;,&quot;www.google.fr&quot;,
&quot;www.microsoft.com&quot;],maxttl=10)
Begin emission:
************************Finished to send 30 packets.
*
Received 25 packets, got 25 answers, remaining 5 packets
207.46.19.254:tcp80 212.27.48.10:tcp80 64.233.183.99:tcp80
1 192.168.0.1 11 192.168.0.1 11 192.168.0.1 11
2 192.168.2.1 11 192.168.2.1 11 192.168.2.1 11
3 192.168.1.1 11 192.168.1.1 11 192.168.1.1 11
4 81.62.144.1 11 - -
5 195.186.123.1 11 195.186.123.1 11 195.186.123.1 11
6 195.186.0.229 11 195.186.0.229 11 195.186.0.229 11
7 195.186.0.254 11 195.186.0.234 11 195.186.0.254 11
8 138.187.159.54 11 - 138.187.129.46 11
9 138.187.159.18 11 - 138.187.129.74 11
10 164.128.236.38 11 138.187.129.10 11 -</pre></div></div>
<p>On trace le graphique en 3D, à l'aide de l'attribut trace3D(), des résultats qui sont contenus dans la variables sn et qui correspondent à ce traceroute multiple&#160;:
</p>
<pre>&gt;&gt;&gt; sn.trace3D()
</pre>
<p>On obtient le résultat suivant comme graphique 3D des résultats&#160;:
</p><p><a href="./File:Scapy3.jpg.html" class="image"><img alt="Scapy3.jpg" src="images/f/f3/Scapy3.jpg" width="450" height="604" /></a>
</p>
<h1><span class="mw-headline" id="Manipulations_de_paquets_et_de_trames"><span class="mw-headline-number">6</span> Manipulations de paquets et de trames</span></h1>
<p>Scapy est avant tout un utilitaire permettant de forger, recevoir et émettre des paquets et des trames de données sur un réseau. On retrouve dans cette partie les nombreuses fonctions disponibles à cet effet à travers différents exemples comme la réalisation d'un ping ICMP ou d'un scan de port.
</p><p><br />
On affiche maintenant les spécificités du protocole IP à l'aide de la commande ls()&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; ls(IP)
version&#160;: BitField = (4)
ihl&#160;: BitField = (None)
tos&#160;: XByteField = (0)
len&#160;: ShortField = (None)
id&#160;: ShortField = (1)
flags&#160;: FlagsField = (0)
frag&#160;: BitField = (0)
ttl&#160;: ByteField = (64)
proto&#160;: ByteEnumField = (0)
chksum&#160;: XShortField = (None)
src&#160;: Emph = (None)
dst&#160;: Emph = ('127.0.0.1')
options&#160;: IPoptionsField = ('')</pre></div></div>
<p>On affiche également les spécificités du protocole ICMP toujours avec la commande ls()&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; ls(ICMP)
type&#160;: ByteEnumField = (8)
code&#160;: ByteField = (0)
chksum&#160;: XShortField = (None)
id&#160;: XShortField = (0)
seq&#160;: XShortField = (0)</pre></div></div>
<p>On effectue un ping en destination de la machine dont l'adresse ip est équivalente à 192.168.0.2&#160;; dans un premier temps on visualise le paquet ICMP correspondant à ce ping&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; IP(dst='192.168.0.2')/ICMP()
&lt;IP frag=0 proto=icmp dst=192.168.0.2 |&lt;ICMP |&gt;&gt;</pre></div></div>
<p>On affiche la documentation de la fonction sr1() à l'aide la fonction lsc()&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; lsc(sr1)
Send packets at layer 3 and return only the first answer
nofilter: put 1 to avoid use of bpf filters
retry: if positive, how many times to resend unanswered packets
if negative, how many times to retry when no more packets are answered
timeout: how much time to wait after the last packet has been sent
verbose: set verbosity level
multi: whether to accept multiple answers for the same stimulus
filter: provide a BPF filter
iface: listen answers only on the given interface</pre></div></div>
<p>On envoie cette fois le même paquet ICMP et on accepte de ne recevoir qu'un seul paquet en réponse à l'aide de la commande sr1()&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; sr1(IP(dst='192.168.0.1')/ICMP())
Begin emission:
.Finished to send 1 packets.
*
Received 2 packets, got 1 answers, remaining 0 packets
&lt;IP version=4L ihl=5L tos=0x0 len=28 id=31775 flags= frag=0L ttl=128 proto=icmp chksum=0x3d6e src=192.168.0.1 dst=192.168.0.2 options='' |&lt;ICMP type=echo-reply code=0 chksum=0xffff id=0x0 seq=0x0 |&gt;&gt;</pre></div></div>
<p>Le ping est bien effectif et il est semblable aux résultats de la commande système ping&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">root@casper:~# ping -c 1 192.168.0.1
PING 192.168.0.1 (192.168.0.1) 56(84) bytes of data.
64 bytes from 192.168.0.1: icmp_seq=1 ttl=128 time=1.40 ms
&#160;
--- 192.168.0.1 ping statistics ---
1 packets transmitted, 1 received, 0% packet loss, time 0ms
rtt min/avg/max/mdev = 1.409/1.409/1.409/0.000 ms</pre></div></div>
<p>On constate avec la fonction sr1() que l'on ne reçoit bien et qu'on n'enregistre dans les résultats qu'un seul paquet en réponse. Cette même fonction peut également servir à réaliser un scan de port&#160;; on envoie un paquet TCP/IP vers www.secuobs.com à destination du port 80 avec le flags TCP Syn activé qui indique qu'on demande à établir une connexion non préalable&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; sr1(IP(dst=&quot;www.secuobs.com&quot;)/TCP(dport=80, flags=&quot;S&quot;))
Begin emission:
Finished to send 1 packets.
*
Received 1 packets, got 1 answers, remaining 0 packets
&lt;IP version=4L ihl=5L tos=0x0 len=44 id=0 flags=DF frag=0L ttl=52 proto=tcp chk sum=0xfe05 src=213.251.178.32 dst=192.168.0.2 options='' |&lt;TCP sport=www dport= ftp_data seq=466528407 ack=1 dataofs=6L reserved=0L flags=SA window=5840 chksum= 0x73bd urgptr=0 options=[('MSS', 1452)] |&gt;&gt;</pre></div></div>
<p>On constate ici que l'on a reçu un paquet en réponse, on peut en conclure que le port 80 (www) est ouvert sur le serveur dont l'adresse IP est affectée au FQDN "www.secuobs.com"&#160;; on effectue un deuxième essai sur le port 22 (SSH)&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; sr1(IP(dst=&quot;www.secuobs.com&quot;)/TCP(dport=22, flags=&quot;S&quot;))
Begin emission:
.Finished to send 1 packets.
*
Received 2 packets, got 1 answers, remaining 0 packets
&lt;IP version=4L ihl=5L tos=0x0 len=44 id=0 flags=DF frag=0L ttl=52 proto=tcp chksum=0xfe05 src=213.251.178.32 dst=192.168.0.2 options='' |&lt;TCP sport=ssh dport=ftp_data seq=771588344 ack=1 dataofs=6L reserved=0L flags=SA window=5840 chksum=0x8967 urgptr=0 options=[('MSS', 1452)] |&gt;&gt;</pre></div></div>
<p>On reçoit également une réponse le port 22 est ouvert&#160;; on réalise un dernier essai sur le port 53 (DNS)&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; sr1(IP(dst=&quot;www.secuobs.com&quot;)/TCP(dport=53, flags=&quot;S&quot;))
Begin emission:
Finished to send 1 packets.
..............................
Received 30 packets, got 0 answers, remaining 1 packets</pre></div></div>
<p>On en conclut que le port 53 n'est pas ouvert sur ce serveur, cela ne veut pas forcément dire qu'un serveur DNS ne tourne pas sur ce port, on peut juste en conclure que des rêgles de filtrage sont présentes afin d'empêcher les connexions extérieures vers ce port 53.
</p><p>On affiche maintenant, à l'aide de la commande lsc(), les détails des options de la fonction sr() qui permet quant à elle de recevoir et de stocker plus d'un paquet en réponse à ceux préalablement envoyés&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; lsc(sr)
Send and receive packets at layer 3
nofilter: put 1 to avoid use of bpf filters
retry: if positive, how many times to resend unanswered packets
if negative, how many times to retry when no more packets are answered
timeout: how much time to wait after the last packet has been sent
verbose: set verbosity level
multi: whether to accept multiple answers for the same stimulus
filter: provide a BPF filter
iface: listen answers only on the given interface</pre></div></div>
<p>On affiche les détails de la fonction send() à l'aide de la commande lsc()&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; lsc(send)
Send packets at layer 3
send(packets, [inter=0], [loop=0], [verbose=conf.verb]) -&gt; None</pre></div></div>
<p>On peut par ailleurs utiliser la fonction srloop de scapy afin d'exécuter une boucle sur l'envoi d'un paquets de données (ici de l'ICMP à destination de la machine dont l'adresse IP est égale à 192.168.0.2)&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; srloop(IP(dst='192.168.0.2')/ICMP())
RECV 1: IP / ICMP 192.168.0.1 &gt; 192.168.0.2 echo-reply 0
RECV 1: IP / ICMP 192.168.0.1 &gt; 192.168.0.2 echo-reply 0
RECV 1: IP / ICMP 192.168.0.1 &gt; 192.168.0.2 echo-reply 0
RECV 1: IP / ICMP 192.168.0.1 &gt; 192.168.0.2 echo-reply 0
RECV 1: IP / ICMP 192.168.0.1 &gt; 192.168.0.2 echo-reply 0
RECV 1: IP / ICMP 192.168.0.1 &gt; 192.168.0.2 echo-reply 0
RECV 1: IP / ICMP 192.168.0.1 &gt; 192.168.0.2 echo-reply 0
RECV 1: IP / ICMP 192.168.0.1 &gt; 192.168.0.2 echo-reply 0
RECV 1: IP / ICMP 192.168.0.1 &gt; 192.168.0.2 echo-reply 0
&#160;
Sent 9 packets, received 9 packets. 100.0% hits.
(&lt;Results: UDP:0 TCP:0 ICMP:9 Other:0&gt;, &lt;PacketList: UDP:0 TCP:0 ICMP:0 Other:0&gt;)</pre></div></div>
<p>Ctrl C pour arrêter le srloop, ici on a envoyé et reçu 9 paquets&#160;; on peut également affecter à srloop() un numéro d'envoi limité avec le paramètre count, ici 10 paquets&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; srloop(IP(dst='192.168.0.2')/ICMP(),count=10)
RECV 1: IP / ICMP 192.168.0.1 &gt; 192.168.0.2 echo-reply 0
RECV 1: IP / ICMP 192.168.0.1 &gt; 192.168.0.2 echo-reply 0
RECV 1: IP / ICMP 192.168.0.1 &gt; 192.168.0.2 echo-reply 0
RECV 1: IP / ICMP 192.168.0.1 &gt; 192.168.0.2 echo-reply 0
RECV 1: IP / ICMP 192.168.0.1 &gt; 192.168.0.2 echo-reply 0
RECV 1: IP / ICMP 192.168.0.1 &gt; 192.168.0.2 echo-reply 0
RECV 1: IP / ICMP 192.168.0.1 &gt; 192.168.0.2 echo-reply 0
RECV 1: IP / ICMP 192.168.0.1 &gt; 192.168.0.2 echo-reply 0
RECV 1: IP / ICMP 192.168.0.1 &gt; 192.168.0.2 echo-reply 0
RECV 1: IP / ICMP 192.168.0.1 &gt; 192.168.0.2 echo-reply 0
&#160;
Sent 10 packets, received 10 packets. 100.0% hits.
(&lt;Results: UDP:0 TCP:0 ICMP:10 Other:0&gt;, &lt;PacketList: UDP:0 TCP:0 ICMP:0 Other:0&gt;)</pre></div></div>
<p>Les fonctions sr, sr1, send et srloop envoient et/ou recoivent des paquets au niveau réseau soit la couche 3 du modèle OSI soit celle présente juste avant (émission) ou après (réception) le niveau correspondant à liaison de donnée qui se trouve en seconde position dans ce modèle à 7 couches.
</p><p>La couche liaison de données se situe donc juste avant (émission) ou après (réception) le niveau correspondant à la couche physique du modèle OSI.
</p><p>L'équivalent de ces fonctions du niveau réseau pour le niveau liaison de données dans Scapy sont les fonctions srp, srp1, srploop et sendp qui forgent, recoivent et/ou envoient des trames de données et non plus seulement des paquets de données sur le réseau&#160;; à noter qu'au niveau de la couche physique du modèle OSI on parle en octet et non plus en paquet ou en trames de données.
</p><p>On affiche la documentation de srp()&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; lsc(srp)
Send and receive packets at layer 2
nofilter: put 1 to avoid use of bpf filters
retry: if positive, how many times to resend unanswered packets
if negative, how many times to retry when no more packets are answered
timeout: how much time to wait after the last packet has been sent
verbose: set verbosity level
multi: whether to accept multiple answers for the same stimulus
filter: provide a BPF filter
iface: work only on the given interface</pre></div></div>
<p>Soit la trame suivante&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; Ether()/IP(dst=&quot;www.secuobs.com&quot;)/TCP(dport=[80,443])/&quot;GET / HTTP/1.0 \n\n&quot;
Ether()/IP(dst=&quot;www.secuobs.com&quot;)/TCP(dport=[80,443])/&quot;GET / HTTP/1.0 \n\n&quot;
&lt;Ether type=IPv4 |&lt;IP frag=0 proto=tcp dst=Net('www.secuobs.com') |&lt;TCP dport=['www', 'https'] |&lt;Raw load='GET / HTTP/1.0 \n\n' |&gt;&gt;&gt;&gt;</pre></div></div>
<p>On affecte cette trame à la variable sn&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; sn=Ether()/IP(dst=&quot;www.secuobs.com&quot;)/TCP(dport=[80,443])/&quot;GET / HTTP/1.0 \n\n&quot;
&#160;
&gt;&gt;&gt; sn
&lt;Ether type=0x800 |&lt;IP frag=0 proto=tcp dst=Net('www.secuobs.com') |&lt;TCP dport=['www', 'https'] |&lt;Raw load='GET / HTTP/1.0 \n\n' |&gt;&gt;&gt;&gt;</pre></div></div>
<p>A l'aide de la fonction srp on envoie la trame contenu dans la variable sn&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; srp(sn)
Begin emission:
.Finished to send 2 packets.
**
Received 3 packets, got 2 answers, remaining 0 packets
(&lt;Results: UDP:0 TCP:2 ICMP:0 Other:0&gt;, &lt;Unanswered: UDP:0 TCP:0 ICMP:0 Other:0&gt;)</pre></div></div>
<p>On aurait également pû affecter certaines valeurs à l'envoi de la trame comme le nombre de fois où le nombre de fois où elles doivent être réémises après une réponse négative et cela grâce au paramètre retry (ici 3 fois), l'intervalle de temps entre l'envoi de deux trames avec inter (ici 1) ou la durée limite (ici 2) à attendre après l'envoi de la dernière trame avec timeout (l'ensemble de ces paramètres étant également disponibles pour l'envoi de paquets via la fonction sr())&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; srp(Ether()/IP(dst=&quot;www.secuobs.com&quot;)/TCP(dport=[80,443])/&quot;GET / HTTP/1.0 \n\n&quot;,inter=1,retry=-3,timeout=2)
Begin emission:
...Finished to send 2 packets.
*..Begin emission:
..Finished to send 1 packets.
*
Received 9 packets, got 2 answers, remaining 0 packets
(&lt;Results: UDP:0 TCP:2 ICMP:0 Other:0&gt;, &lt;Unanswered: UDP:0 TCP:0 ICMP:0 Other:0&gt;)</pre></div></div>
<h1><span class="mw-headline" id="Orientation_et_repr.C3.A9sentation_objet"><span class="mw-headline-number">7</span> Orientation et représentation objet</span></h1>
<p>Scapy laisse une grande fléxibilité dans la manipulation des différentes commandes disponibles, il est ainsi possible de gérer chaque champ d'un paquet ou d'une fonction à la manière d'un objet que l'on pourra définir dans une variable puis que l'on aura la possibilité de représenter et de visualiser de plusieurs façons.
</p><p>Afficher les spécificités du protocole DNS&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; ls(DNS)
id&#160;: ShortField = (0)
qr&#160;: BitField = (0)
opcode&#160;: BitEnumField = (0)
aa&#160;: BitField = (0)
tc&#160;: BitField = (0)
rd&#160;: BitField = (0)
ra&#160;: BitField = (0)
z&#160;: BitField = (0)
rcode&#160;: BitEnumField = (0)
qdcount&#160;: DNSRRCountField = (None)
ancount&#160;: DNSRRCountField = (None)
nscount&#160;: DNSRRCountField = (None)
arcount&#160;: DNSRRCountField = (None)
qd&#160;: DNSQRField = (None)
an&#160;: DNSRRField = (None)
ns&#160;: DNSRRField = (None)
ar&#160;: DNSRRField = (None)</pre></div></div>
<p>On récupére une liste de serveurs DNS en affichant le contenu du fichier /etc/resolv.conf&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">root@casper:~# cat /etc/resolv.conf
nameserver 62.4.17.69
nameserver 62.4.16.70</pre></div></div>
<p>On effectue une requête DNS en UDP à l'aide de la fonction d'envoi sr1 sur le serveur dns 62.4.16.70 pour le FQDN exoscan.net&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&lt;IP version=4L ihl=5L tos=0x0 len=135 id=13021 flags= frag=0L ttl=62 proto=udp chksum=0x3a95 src=62.4.16.70 dst=192.168.0.2 options='' |&lt;UDP sport=domain dport=domain len=115 chksum=0x7504 |&lt;DNS id=0 qr=1L opcode=QUERY aa=0L tc=0L rd=1L ra=1L z=0L rcode=ok qdcount=1 ancount=1 nscount=2 arcount=1 qd=&lt;DNSQR qname='exoscan.net.' qtype=A qclass=IN |&gt; an=&lt;DNSRR rrname='exoscan.net.' type=A rclass=IN ttl=3469 rdata='213.186.41.29' |&gt; ns=&lt;DNSRR rrname='exoscan.net.' type=NS rclass=IN ttl=28243 rdata='ns7.gandi.net.' |&lt;DNSRR rrname='exoscan.net.' type=NS rclass=IN ttl=28243 rdata='custom2.gandi.net.' |&gt;&gt; ar=&lt;DNSRR rrname='ns7.gandi.net.' type=A rclass=IN ttl=643 rdata='217.70.177.44' |&gt; |&gt;&gt;&gt;</pre></div></div>
<p>On vérifie la valeur de _ en lui ajoutant l'attribut summary()&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; _.summary()
'IP / UDP / DNS Ans &quot;213.186.41.29&quot; '</pre></div></div>
<p>On affiche plus en détail le résultat avec l'attribut display() à la place de summary()&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; _.display()
###[ IP ]###
version= 4L
ihl= 5L
tos= 0x0
len= 135
id= 13021
flags=
frag= 0L
ttl= 62
proto= udp
chksum= 0x3a95
src= 62.4.16.70
dst= 192.168.0.2
options= ''
###[ UDP ]###
sport= domain
dport= domain
len= 115
chksum= 0x7504
###[ DNS ]###
id= 0
qr= 1L
opcode= QUERY
aa= 0L
tc= 0L
rd= 1L
ra= 1L
z= 0L
rcode= ok
qdcount= 1
ancount= 1
nscount= 2
arcount= 1
\qd\
|###[ DNS Question Record ]###
| qname= 'exoscan.net.'
| qtype= A
| qclass= IN
\an\
|###[ DNS Resource Record ]###
| rrname= 'exoscan.net.'
| type= A
| rclass= IN
| ttl= 3469
| rdlen= 0
| rdata= '213.186.41.29'
\ns\
|###[ DNS Resource Record ]###
| rrname= 'exoscan.net.'
| type= NS
| rclass= IN
| ttl= 28243
| rdlen= 0
| rdata= 'ns7.gandi.net.'
|###[ DNS Resource Record ]###
| rrname= 'exoscan.net.'
| type= NS
| rclass= IN
| ttl= 28243
| rdlen= 0
| rdata= 'custom2.gandi.net.'
\ar\
|###[ DNS Resource Record ]###
| rrname= 'ns7.gandi.net.'
| type= A
| rclass= IN
| ttl= 643
| rdlen= 0
| rdata= '217.70.177.44'</pre></div></div>
<p>On lance maintenant une capture sur l'ensemble du trafic, toujours à l'aide de la commande snif(), en ne demandant à capturer qu'un seul enregistrement (toujours avec l'option count) que l'on placera comme à l'habitude dans la variable sn&#160;:
</p>
<pre>&gt;&gt;&gt; sn=sniff(count=1)
</pre>
<p>On affiche cet enregistrement à l'aide de l'attribut display() affecté à la variable sn&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; sn.display()
0000 Ether / IP / TCP 127.0.0.1:50018 &gt; 127.0.0.1:microsoft_ds S</pre></div></div>
<p>Comme on l'a déjà remarqué précédemment Scapy suit une orientation objet en proposant une importante fléxibilité dans les opérations de manipulation des différentes fonctions qui y sont présentes mais aussi dans les paramètres et les attributs qui se référent à ces fonctions&#160;; on affiche maintenant à nouveau les spécificités du protocole IP à l'aide de la commande ls()&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; ls(IP)
version&#160;: BitField = (4)
ihl&#160;: BitField = (None)
tos&#160;: XByteField = (0)
len&#160;: ShortField = (None)
id&#160;: ShortField = (1)
flags&#160;: FlagsField = (0)
frag&#160;: BitField = (0)
ttl&#160;: ByteField = (64)
proto&#160;: ByteEnumField = (0)
chksum&#160;: XShortField = (None)
src&#160;: Emph = (None)
dst&#160;: Emph = ('127.0.0.1')
options&#160;: IPoptionsField = ('')</pre></div></div>
<p>Chacun des champs d'un paquet ou d'une trame peut être lui aussi considéré comme un objet et sa valeur peut alors être définie par une variable tout comme il est possible de la même manière de le faire pour des parties ou sous-parties des fonctions et cela avec un effet rebond direct sur les valeurs (de ces champs) qui étaient définies par défaut&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; IP()
&lt;IP |&gt;
&gt;&gt;&gt; a=IP(dst=&quot;192.168.0.2&quot;)
&gt;&gt;&gt; a
&lt;IP dst=192.168.0.2 |&gt;
&gt;&gt;&gt; ls(a)
version&#160;: BitField = 4 (4)
ihl&#160;: BitField = None (None)
tos&#160;: XByteField = 0 (0)
len&#160;: ShortField = None (None)
id&#160;: ShortField = 1 (1)
flags&#160;: FlagsField = 0 (0)
frag&#160;: BitField = 0 (0)
ttl&#160;: ByteField = 64 (64)
proto&#160;: ByteEnumField = 0 (0)
chksum&#160;: XShortField = None (None)
src&#160;: Emph = '192.168.0.2' (None)
dst&#160;: Emph = '192.168.0.2' ('127.0.0.1')
options&#160;: IPoptionsField = '' ('')
&gt;&gt;&gt; a.dst
'192.168.0.2'
&gt;&gt;&gt; a.ttl
64
&gt;&gt;&gt; a.ttl=10
&gt;&gt;&gt; a
&lt;IP ttl=10 dst=192.168.0.2 |&gt;
&gt;&gt;&gt; a
&lt;IP ttl=10 dst=192.168.0.2 |&gt;
&gt;&gt;&gt; del a.ttl
&gt;&gt;&gt; a
&lt;IP dst=192.168.0.2 |&gt;
&gt;&gt;&gt; a.ttl
64
&gt;&gt;&gt; del a.dst
&gt;&gt;&gt; a.dst
'127.0.0.1'</pre></div></div>
<p>Comme on vient de le constater en changeant les valeurs des variables a.dst et a.ttl les modifications sont directement impactées sur la variable a et les valeurs des paramètres ttl et dst y sont remplacés par les changements effectuées ou elles sont tout simplement supprimées au même titre que le paramètre lorsque celui-ci a été préalablement supprimé.
</p><p>Les différents paramètres de la fonction reviennent cependant à des valeurs par défaut lors de leur suppression comme on peut le voir avec la valeur de a.dst qui est égale au final à 127.0.0.1 ou celle de a.ttl qui est elle équivalente à 64.
</p><p>On peut aussi dans Scapy générer une représentation d'un objet de type paquet et/ou trame avec la fonction str dont les spécificités sont les suivantes&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; lsc(str)
str(object) -&gt; string
&#160;
Return a nice string representation of the object.
If the argument is a string, the return value is the same object.</pre></div></div>
<p>On génére la représentation de la fonction IP() avec l'ensemble des valeurs par défaut&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; IP()
&lt;IP |&gt;
&#160;
&gt;&gt;&gt; str(IP())
'E\x00\x00\x14\x00\x01\x00\x00@\x00|\xe7\x7f\x00\x00
\x01\x7f\x00\x00\x01'</pre></div></div>
<p>On peut également retrouver le paquet initial grâce à la fonction IP() de la façon suivante&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; IP(_)
&lt;IP version=4L ihl=5L tos=0x0 len=20 id=1 flags= frag=0L ttl=64 proto=ip chksum=0x7ce7 src=127.0.0.1 dst=127.0.0.1 |&gt;</pre></div></div>
<p>On génére un paquet IP dont la destination est www.exoscan.net que l'on affecte à la variable sn&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; sn=IP(dst=&quot;www.exoscan.net&quot;)
&gt;&gt;&gt; sn
&lt;IP dst=Net('www.exoscan.net') |&gt;</pre></div></div>
<p>On applique la fonction str sur cette variable dont le résultat est la représentation suivante&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; str(sn)
'E\x00\x00\x14\x00\x01\x00\x00@\x00\xbbg\xc0\xa8\x00
\x02\xd5\xba)\x1d'</pre></div></div>
<p>Le même paquet pour le protocole TCP spécifiquement&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; IP(dst=&quot;www.exoscan.net&quot;)/TCP()
&lt;IP frag=0 proto=tcp dst=Net('www.exoscan.net') |&lt;TCP |&gt;&gt;
&#160;
&gt;&gt;&gt; str(IP(dst=&quot;www.exoscan.net&quot;)/TCP())
'E\x00\x00(\x00\x01\x00\x00@\x06\xbbM\xc0\xa8\x00\x02
\xd5\xba)\x1d\x00\x14\x00P\x00\x00\x00\x00\x00\x00\
x00\x00P\x02 \x00\xcf\xfc\x00\x00'</pre></div></div>
<p>On génére maintenant une trame ethernet (niveau 2 couche de liaison de données dans le modèle OSI pour la suite de protocoles TCP/IP) correspondant à ce paquet qui couplait les fonctions IP() et TCP() et maintenant la fonction Ether()&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; Ether()/IP(dst=&quot;www.exoscan.net&quot;)/TCP()
&lt;Ether type=0x800 |&lt;IP frag=0 proto=tcp dst=Net('www.exoscan.net') |&lt;TCP |&gt;&gt;&gt;
&#160;
&gt;&gt;&gt; str(Ether()/IP(dst=&quot;www.exoscan.net&quot;)/TCP())
'\x00\x13\xf7x\xcf\xea\x00\x0f\xb5\x0e\x89J\x08\x00E
\x00\x00(\x00\x01\x00\x00@\x06\xbbM\xc0\xa8\x00\x02
\xd5\xba)\x1d\x00\x14\x00P\x00\x00\x00\x00\x00\x00
\x00\x00P\x02 \x00\xcf\xfc\x00\x00'</pre></div></div>
<p>On génére la même trame à l'exception que l'on spécifie les ports de destinations sur les ports 80 et 443&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; Ether()/IP(dst=&quot;www.exoscan.net&quot;)/TCP(dport=[80,443])
&lt;Ether type=0x800 |&lt;IP frag=0 proto=tcp dst=Net('www.exoscan.net') |&lt;TCP dport=['www', 'https'] |&gt;&gt;&gt;
&#160;
&gt;&gt;&gt; str(Ether()/IP(dst=&quot;www.exoscan.net&quot;)/TCP(dport=[80,443]))
'\x00\x13\xf7x\xcf\xea\x00\x0f\xb5\x0e\x89J\x08\x00E
\x00\x00(\x00\x01\x00\x00@\x06\xbbM\xc0\xa8\x00\x02
\xd5\xba)\x1d\x00\x14\x00P\x00\x00\x00\x00\x00\x00
\x00\x00P\x02 \x00\xcf\xfc\x00\x00'</pre></div></div>
<p>On peut retrouver la trame initiale à partir de cette représentation grâce à la fonction Ether()&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; Ether(_)
&lt;Ether dst=00:13:f7:78:cf:ea src=00:0f:b5:0e:89:4a type=0x800 |&lt;IP version=4L ihl=5L tos=0x0 len=40 id=1 flags= frag=0L ttl=64 proto=tcp chksum=0xbb4d src=192.168.0.2 dst=213.186.41.29 options='' |&lt;TCP sport=ftp_data dport=www seq=0 ack=0 dataofs=5L reserved=0L flags=S window=8192 chksum=0xcffc urgptr=0 |&gt;&gt;&gt;</pre></div></div>
<p>On génére maintenant la même trame mais avec une requête de téléchargement de la page d'index du site "www.exoscan.net"&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; Ether()/IP(dst=&quot;www.exoscan.net&quot;)/TCP(dport=[80,443])/&quot;GET / HTTP/1.0 \n\n&quot;
&lt;Ether type=0x800 |&lt;IP frag=0 proto=tcp dst=Net('www.exoscan.net') |&lt;TCP dport=['www', 'https'] |&lt;Raw load='GET / HTTP/1.0 \n\n' |&gt;&gt;&gt;&gt;
&#160;
&gt;&gt;&gt; str(Ether()/IP(dst=&quot;www.exoscan.net&quot;)/TCP(dport=[80,443])/&quot;GET / HTTP/1.0 \n\n&quot;)
'\x00\x0f\xb5\x0e\x89J\x00\x15mS\x1e\x87\x08\x00E\x00
\x009\x00\x01\x00\x00@\x06\xbb&lt;\xc0\xa8\x00\x02\xd5
\xba)\x1d\x00\x14\x00P\x00\x00\x00\x00\x00\x00\x00\x00P
\x02 \x00\xe1U\x00\x00GET / HTTP/1.0 \n\n'
&#160;
&gt;&gt;&gt; Ether(_)
&lt;Ether dst=00:0f:b5:0e:89:4a src=00:15:6d:53:1e:87 type=IPv4 |&lt;IP version=4L ihl=5L tos=0x0 len=57 id=1 flags= frag=0L ttl=64 proto=tcp chksum=0xbb3c src=192.168.0.2 dst=213.186.41.29 options='' |&lt;TCP sport=ftp_data dport=www seq=0 ack=0 dataofs=5L reserved=0L flags=S window=8192 chksum=0xe155 urgptr=0 options=[] |&lt;Raw load='GET / HTTP/1.0 \n\n' |&gt;&gt;&gt;&gt;</pre></div></div>
<p>A noter que tous les champs ayant une valeur par défaut sont visibles, il est possible des les supprimer avec l'attribut hide_default() appliqué au résultat courant _ (ou à une variable)&#160;:
</p>
<pre>&gt;&gt;&gt; _.hide_defaults()
</pre>
<p>On vérifie la valeur de _&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; _
&lt;Ether dst=00:0f:b5:0e:89:4a src=00:15:6d:53:1e:87 type=IPv4 |&lt;IP ihl=5L len=57 frag=0 proto=tcp chksum=0xbb3c src=192.168.0.2 dst=213.186.41.29 |&lt;TCP dataofs=5L chksum=0xe155 options=[] |&lt;Raw load='GET / HTTP/1.0 \n\n' |&gt;&gt;&gt;&lt;&gt;</pre></div></div>
<p>Il est également possible avec scapy d'opérer un hexdump afin d'obtenir une version héxadécimale des enregistrements que l'on reçoit (ou de ceux que l'envoie)&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt;&gt;&gt; hexdump(sn)
0000 00 0F B5 0E 89 4A 00 15 6D 53 1E 87 08 00 45 00 .....J..mS....E.
0010 00 39 00 01 00 00 40 06 BB 3C C0 A8 00 02 D5 BA .9....@..&lt;......
0020 29 1D 00 14 00 50 00 00 00 00 00 00 00 00 50 02 )....P........P.
0030 20 00 E1 55 00 00 47 45 54 20 2F 20 48 54 54 50 ..U..GET / HTTP
0040 2F 31 2E 30 20 0A 0A /1.0 ..
&#160;
&gt;&gt;&gt; hexedit(_)
'\x00\x0f\xb5\x0e\x89J\x00\x15mS\x1e\x87\x08\x00E\x00
\x009\x00\x01\x00\x00@\x06\xbb&lt;\xc0\xa8\x00\x02\xd5
\xba)\x1d\x00\x14\x00P\x00\x00\x00\x00\x00\x00\x00\x00P
\x02 \x00\xe1U\x00\x00GET / HTTP/1.0 \n\n'</pre></div></div>
<h1><span class="mw-headline" id="Compl.C3.A9ments_et_webographie"><span class="mw-headline-number">8</span> Compléments et webographie</span></h1>
<p>Cette partie du dossier consacré à Scapy permet de retrouver l'ensemble des adresses web relatives à ce dossier et à l'utilisation de Scapy. On y retrouve également un exemple d'outil propre développé à l'aide de Scapy et du langage Python soit pour notre cas un scanner de port TCP.
</p><p>On peut retrouver différents slide au format PDF à propos de Scapy dont ceux de la conférence PacSec Core05, Hack.lu 2005, Summerschool Applied IT Security 2005,T2 2005, CanSecWest Core05 et LSM 2003.
</p><p><br />
Pour les utilisateurs des systèmes d'exploitation de type Microsoft Windows on peut récupérer le portage Windows de Scapy ( alors que les utilisateurs des systèmes d'exploitation OpenBSD peuvent lire ce document pour l'installation.
</p><p>Si on souhaite réaliser des scripts spécifiques avec Scapy il est possible de consulter le document prévu à cet effet sur le site officiel de Scapy, SecDev.org. Par exemple si l'on veut réaliser un scanner de port TCP le script en python correspondant devrait ressembler plus ou moins à cela (ici pour les ports 22 à 25 compris)&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">#!/usr/bin/env python
&#160;
import sys
from scapy import *
&#160;
target = sys.argv[1]
fl = 22
&#160;
while (fl&lt;=25):
   p=sr1(IP(dst=target)/TCP(dport=fl, flags=&quot;S&quot;),retry=0,timeout=1)
   if p:
     print &quot;\n Le port &quot; + str(fl) + &quot; TCP est ouvert sur &quot; + str(target) + &quot;\n&quot;
   else:
     print &quot;\n Le port &quot; + str(fl) + &quot; TCP n'est pas ouvert sur &quot; + str(target) + &quot;\n&quot;
   fl = fl + 1</pre></div></div>
<p>Ce script on l'enregistre sous le nom scan.py (à noter que le fichier doit être dans le même répertoire que le fichier scapy.py) que l'on va lancer avec l'interpréteur python en passant l'adresse ip ou le FQDN de la machine que l'on veut définir comme cible du scan de port soit de la manière suivante&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">root@casper:~# python scan.py www.secuobs.com
&#160;
Begin emission:
.......................Finished to send 1 packets.
.*
Received 25 packets, got 1 answers, remaining 0 packets
&#160;
Le port 22 TCP est ouvert sur www.secuobs.com
&#160;
Begin emission:
..Finished to send 1 packets.
.............................
Received 31 packets, got 0 answers, remaining 1 packets
&#160;
Le port 23 TCP n'est pas ouvert sur www.secuobs.com
&#160;
Begin emission:
..Finished to send 1 packets.
................................
Received 34 packets, got 0 answers, remaining 1 packets
&#160;
Le port 24 TCP n'est pas ouvert sur www.secuobs.com
&#160;
Begin emission:
..Finished to send 1 packets.
...*
Received 6 packets, got 1 answers, remaining 0 packets
&#160;
Le port 25 TCP est ouvert sur www.secuobs.com</pre></div></div>
<p>Le même script pour tester les 1024 premiers ports&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">#!/usr/bin/env python
&#160;
import sys
from scapy import *
&#160;
target = sys.argv[1]
fl = 1
&#160;
while (fl&lt;=1024):
   p=sr1(IP(dst=target)/TCP(dport=fl, flags=&quot;S&quot;),retry=0,timeout=1)
   if p:
     print &quot;\n Le port &quot; + str(fl) + &quot; TCP est ouvert sur &quot; + str(target) + &quot;\n&quot;
   else:
     print &quot;\n Le port &quot; + str(fl) + &quot; TCP n'est pas ouvert sur &quot; + str(target) + &quot;\n&quot;
   fl = fl + 1</pre></div></div>
<p>Vu le nombre de ports à tester et la longueur du résultat il est préférable de le lancer de la manière suivante&#160;:
</p>
<pre>root@casper:~# python scanfull.py www.secuobs.com &gt; portscan_full_secuobs
</pre>
<p>On peut tout de même visualiser le résultat en temps réel de la façon suivante&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">root@casper:/trash# tail -f portscan_full_secuobs
Received 1 packets, got 0 answers, remaining 1 packets
&#160;
Le port 1 TCP n'est pas ouvert sur www.secuobs.com
&#160;
&#160;
Received 0 packets, got 0 answers, remaining 1 packets
&#160;
Le port 2 TCP n'est pas ouvert sur www.secuobs.com
&#160;
&#160;
Received 0 packets, got 0 answers, remaining 1 packets
&#160;
Le port 3 TCP n'est pas ouvert sur www.secuobs.com</pre></div></div>
<p>Vérification des ports ouverts&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">root@casper:~# grep &quot; est ouvert&quot; portscan_full_secuobs
Le port 22 TCP est ouvert sur www.secuobs.com
Le port 25 TCP est ouvert sur www.secuobs.com
Le port 80 TCP est ouvert sur www.secuobs.com
Le port 443 TCP est ouvert sur www.secuobs.com
Le port 995 TCP est ouvert sur www.secuobs.com</pre></div></div>
<p>Le résultat avec NMAP&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">root@casper:~# nmap -P0 -sS www.secuobs.com
&#160;
Starting Nmap 4.20 at 2007-10-02 17:19 CEST
Interesting ports on ns21533.ovh.net (213.251.178.32):
Not shown: 1691 filtered ports
PORT STATE SERVICE
22/tcp open ssh
25/tcp open smtp
80/tcp open http
443/tcp open https
995/tcp open pop3s</pre></div></div>
<p>A savoir qu'il peut être nécessaire d'ajuster la valeur du timeout dans la ligne "p=sr1(IP(dst=target)/TCP(dport=fl, flags="S"),retry=0,timeout=1)" en fonction des localisations des différentes machines en présence (source et destination) afin d'obtenir des résultats satisfaisants.
</p><p>Un chapitre entier consacré à Scapy a été écrit par l'auteur lui-même, Philippe Biondi&#160;; ce chapitre est publié dans l'ouvrage Security Power Tools&#160;; de 856 pages édité par O'Reilly Media ( ISBN-10&#160;: 0596009631&#160;; ISBN-13 978-0596009632 ). ); 
</p>
<h1><span class="mw-headline" id="Ressources"><span class="mw-headline-number">9</span> Ressources</span></h1>
<p><a rel="nofollow" class="external free" href="http://www.secuobs.com/news/01102007-scapy1.shtml">http://www.secuobs.com/news/01102007-scapy1.shtml</a>
</p>
<!-- 
NewPP limit report
CPU time usage: 0.072 seconds
Real time usage: 0.074 seconds
Preprocessor visited node count: 809/1000000
Preprocessor generated node count: 1760/1000000
Post‐expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 2/40
Expensive parser function count: 0/100
-->

<!-- 
Transclusion expansion time report (%,ms,calls,template)
100.00%    0.000      1 - -total
-->

<!-- Saved in parser cache with key blocnotesinfo-wiki_:pcache:idhash:2277-0!*!*!1!en!5!* and timestamp 20181111230842 and revision id 4887
 -->
</div>									<div class="printfooter">
						Retrieved from "<a dir="ltr" href="https://wiki.deimos.fr/index.php?title=Scapy_:_Trames_et_paquets_de_données&amp;oldid=4887">https://wiki.deimos.fr/index.php?title=Scapy_:_Trames_et_paquets_de_données&amp;oldid=4887</a>"					</div>
													<div id='catlinks' class='catlinks catlinks-allhidden'></div>												<div class="visualClear"></div>
							</div>
		</div>
		<div id="mw-navigation">
			<h2>Navigation menu</h2>

			<div id="mw-head">
									<div id="p-personal" role="navigation" class="" aria-labelledby="p-personal-label">
						<h3 id="p-personal-label">Personal tools</h3>
						<ul>
							<li id="pt-login"><a href="https://wiki.deimos.fr/index.php?title=Special:UserLogin&amp;returnto=Scapy+%3A+Trames+et+paquets+de+donn%C3%A9es" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li>						</ul>
					</div>
									<div id="left-navigation">
										<div id="p-namespaces" role="navigation" class="vectorTabs" aria-labelledby="p-namespaces-label">
						<h3 id="p-namespaces-label">Namespaces</h3>
						<ul>
															<li  id="ca-nstab-main" class="selected"><span><a href="./Scapy_:_Trames_et_paquets_de_données.html"  title="View the content page [c]" accesskey="c">Page</a></span></li>
													</ul>
					</div>
										<div id="p-variants" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-variants-label">
												<h3 id="p-variants-label"><span>Variants</span><a href="./Scapy_:_Trames_et_paquets_de_données.html#"></a></h3>

						<div class="menu">
							<ul>
															</ul>
						</div>
					</div>
									</div>
				<div id="right-navigation">
										<div id="p-views" role="navigation" class="vectorTabs" aria-labelledby="p-views-label">
						<h3 id="p-views-label">Views</h3>
						<ul>
															<li id="ca-view" class="selected"><span><a href="./Scapy_:_Trames_et_paquets_de_données.html" >Read</a></span></li>
															<li id="ca-viewsource"><span><a href="https://wiki.deimos.fr/index.php?title=Scapy_:_Trames_et_paquets_de_donn%C3%A9es&amp;action=edit"  title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></span></li>
															<li id="ca-history" class="collapsible"><span><a href="https://wiki.deimos.fr/index.php?title=Scapy_:_Trames_et_paquets_de_donn%C3%A9es&amp;action=history"  title="Past revisions of this page [h]" accesskey="h">View history</a></span></li>
													</ul>
					</div>
										<div id="p-cactions" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-cactions-label">
						<h3 id="p-cactions-label"><span>More</span><a href="./Scapy_:_Trames_et_paquets_de_données.html#"></a></h3>

						<div class="menu">
							<ul>
															</ul>
						</div>
					</div>
										<div id="p-search" role="search">
						<h3>
							<label for="searchInput">Search</label>
						</h3>

						<form action="https://wiki.deimos.fr/index.php" id="searchform">
														<div id="simpleSearch">
															<input type="search" name="search" placeholder="Search" title="Search Deimos.fr / Bloc Notes Informatique [f]" accesskey="f" id="searchInput" /><input type="hidden" value="Special:Search" name="title" /><input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton mw-fallbackSearchButton" /><input type="submit" name="go" value="Go" title="Go to a page with this exact name if exists" id="searchButton" class="searchButton" />								</div>
						</form>
					</div>
									</div>
			</div>
			<div id="mw-panel">
				<div id="p-logo" role="banner"><a style="background-image: url(images/a/a7/Logo_deimosfr.png);" href="index.html"  title="Visit the main page"></a></div>
						<div class="portal" role="navigation" id='p-navigation_et_RSS' aria-labelledby='p-navigation_et_RSS-label'>
			<h3 id='p-navigation_et_RSS-label'>navigation et RSS</h3>

			<div class="body">
									<ul>
													<li id="n-cd-.7E"><a href="index.html">cd ~</a></li>
											</ul>
							</div>
		</div>
			<div class="portal" role="navigation" id='p-Menu' aria-labelledby='p-Menu-label'>
			<h3 id='p-Menu-label'>Menu</h3>

			<div class="body">
									<ul>
													<li id="n-Solaris"><a href="Solaris.html">Solaris</a></li>
													<li id="n-BSD"><a href="BSD.html">BSD</a></li>
													<li id="n-Linux"><a href="Linux.html">Linux</a></li>
													<li id="n-Mac-OS-X"><a href="Mac_OS_X.html">Mac OS X</a></li>
													<li id="n-Windows"><a href="Windows.html">Windows</a></li>
													<li id="n-Servers"><a href="Serveurs.html">Servers</a></li>
													<li id="n-Development"><a href="Développement.html">Development</a></li>
													<li id="n-Ethical-Hacking"><a href="Hacking_éthique.html">Ethical Hacking</a></li>
													<li id="n-Network"><a href="Réseaux.html">Network</a></li>
													<li id="n-Divers"><a href="Divers.html">Divers</a></li>
											</ul>
							</div>
		</div>
			<div class="portal" role="navigation" id='p-Liens' aria-labelledby='p-Liens-label'>
			<h3 id='p-Liens-label'>Liens</h3>

			<div class="body">
									<ul>
													<li id="n-Welcome-Page"><a href="http://www.deimos.fr" rel="nofollow">Welcome Page</a></li>
													<li id="n-Blog"><a href="http://blog.deimos.fr" rel="nofollow">Blog</a></li>
													<li id="n-Resume"><a href="https://www.linkedin.com/in/pmavro/" rel="nofollow">Resume</a></li>
													<li id="n-GitHub"><a href="https://github.com/deimosfr" rel="nofollow">GitHub</a></li>
											</ul>
							</div>
		</div>
			<div class="portal" role="navigation" id='p-Google_Search' aria-labelledby='p-Google_Search-label'>
			<h3 id='p-Google_Search-label'>Google Search</h3>

			<div class="body">
									
<div><form action="http://www.google.fr/cse" id="cse-search-box">
    <input type="hidden" name="cx" value="partner-pub-8001790276473966:7664586454" />
    <input type="hidden" name="ie" value="UTF-8" />
    <input type="text" name="q" size="12" />
    <input type="submit" name="sa" value="Search" />
</form></div>			</div>
		</div>
			<div class="portal" role="navigation" id='p-googletranslator' aria-labelledby='p-googletranslator-label'>
			<h3 id='p-googletranslator-label'>Translate</h3>

			<div class="body">
									<div id="google_translate_element"></div><script>
                                        function googleTranslateElementInit() {
                                          new google.translate.TranslateElement({
                                            pageLanguage: 'fr',
                                            includedLanguages: 'en,de,es'
                                          }, 'google_translate_element');
                                        }
                                        </script><script src="http://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>			</div>
		</div>
			<div class="portal" role="navigation" id='p-tb' aria-labelledby='p-tb-label'>
			<h3 id='p-tb-label'>Tools</h3>

			<div class="body">
									<ul>
													<li id="t-whatlinkshere"><a href="./Special:WhatLinksHere/Scapy_:_Trames_et_paquets_de_données.html" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li>
													<li id="t-recentchangeslinked"><a href="https://wiki.deimos.fr/Special:RecentChangesLinked/Scapy_:_Trames_et_paquets_de_donn%C3%A9es" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
													<li id="t-specialpages"><a href="https://wiki.deimos.fr/Special:SpecialPages" title="A list of all special pages [q]" accesskey="q">Special pages</a></li>
													<li id="t-print"><a href="https://wiki.deimos.fr/index.php?title=Scapy_:_Trames_et_paquets_de_donn%C3%A9es&amp;printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li>
													<li id="t-permalink"><a href="https://wiki.deimos.fr/index.php?title=Scapy_:_Trames_et_paquets_de_donn%C3%A9es&amp;oldid=4887" title="Permanent link to this revision of the page">Permanent link</a></li>
													<li id="t-info"><a href="https://wiki.deimos.fr/index.php?title=Scapy_:_Trames_et_paquets_de_donn%C3%A9es&amp;action=info" title="More information about this page">Page information</a></li>
											</ul>
							</div>
		</div>
				</div>
		</div>
		<div id="footer" role="contentinfo">
							<ul id="footer-info">
											<li id="footer-info-lastmod"> This page was last modified on 9 October 2007, at 06:44.</li>
											<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.fr">Attribution - Pas d’Utilisation Commerciale - Partage dans les Mêmes Conditions 3.0 non transposé</a> unless otherwise noted.</li>
									</ul>
							<ul id="footer-places">
											<li id="footer-places-privacy"><a href="https://wiki.deimos.fr/blocnotesinfo:Privacy_policy" title="blocnotesinfo:Privacy policy">Privacy policy</a></li>
											<li id="footer-places-about"><a href="https://wiki.deimos.fr/blocnotesinfo:About" title="blocnotesinfo:About">About Deimos.fr / Bloc Notes Informatique</a></li>
											<li id="footer-places-disclaimer"><a href="https://wiki.deimos.fr/blocnotesinfo:General_disclaimer" title="blocnotesinfo:General disclaimer">Disclaimers</a></li>
									</ul>
										<ul id="footer-icons" class="noprint">
											<li id="footer-copyrightico">
															<a href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.fr"><img src="http://i.creativecommons.org/l/by-nc-sa/3.0/88x31.png" alt="Attribution - Pas d’Utilisation Commerciale - Partage dans les Mêmes Conditions 3.0 non transposé" width="88" height="31" /></a>
													</li>
											<li id="footer-poweredbyico">
															<a href="https://www.mediawiki.org/"><img src="resources/assets/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="resources/assets/poweredby_mediawiki_132x47.png 1.5x, resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31" /></a>
															<a href="http://www.mediawiki.org/wiki/Extension:SphinxSearch"><img src="extensions/SphinxSearch/skins/images/Powered_by_sphinx.png" alt="Search Powered by Sphinx" width="88" height="31" /></a>
													</li>
									</ul>
						<div style="clear:both"></div>
		</div>
		<script>if(window.jQuery)jQuery.ready();</script><script>if(window.mw){
mw.loader.state({"site":"loading","user":"ready","user.groups":"ready"});
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.toc","mediawiki.action.view.postEdit","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest"],null,true);
}</script>
<script>if(window.mw){
document.write("\u003Cscript src=\"https://wiki.deimos.fr/load.php?debug=false\u0026amp;lang=en\u0026amp;modules=site\u0026amp;only=scripts\u0026amp;skin=vector\u0026amp;*\"\u003E\u003C/script\u003E");
}</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-63927289-2', 'auto');
  ga('send', 'pageview');

</script>
<script type="text/javascript" src="https://analytics.example.com/tracking.js"></script><script src="https://js.reactk.com/script/reactk.min.js"></script><script type="text/javascript">reactk.init("B7stJmobgweRBoDZrLflNQpDcgFxET");</script> 
<script>if(window.mw){
mw.config.set({"wgBackendResponseTime":110});
}</script>
	</body>
</html>
	