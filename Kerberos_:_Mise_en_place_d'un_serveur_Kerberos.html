<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">
<head>
<meta charset="UTF-8" />
<title>Kerberos : Mise en place d'un serveur Kerberos - Deimos.fr / Bloc Notes Informatique</title>
<meta name="generator" content="MediaWiki 1.25.5" />
<link rel="shortcut icon" href="https://wiki.deimos.fr/favicon.ico" />
<link rel="search" type="application/opensearchdescription+xml" href="opensearch_desc.php" title="Deimos.fr / Bloc Notes Informatique (en)" />
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.deimos.fr/api.php?action=rsd" />
<link rel="alternate" hreflang="x-default" href="./Kerberos_:_Mise_en_place_d'un_serveur_Kerberos.html" />
<link rel="copyright" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.fr" />
<link rel="alternate" type="application/atom+xml" title="Deimos.fr / Bloc Notes Informatique Atom feed" href="https://wiki.deimos.fr/index.php?title=Special:RecentChanges&amp;feed=atom" />
<link rel="stylesheet" href="load.php%3Fdebug=false&amp;lang=en&amp;modules=ext.cite.styles|mediawiki.legacy.commonPrint,shared|mediawiki.sectionAnchor|mediawiki.skinning.interface|mediawiki.ui.button|skins.vector.styles&amp;only=styles&amp;skin=vector&amp;*.css" />
<meta name="ResourceLoaderDynamicStyles" content="" />
<link rel="stylesheet" href="load.php%3Fdebug=false&amp;lang=en&amp;modules=site&amp;only=styles&amp;skin=vector&amp;*.css" />
<style>a:lang(ar),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}
/* cache key: blocnotesinfo-wiki_:resourceloader:filter:minify-css:7:6f8c0c45eefd74c7bbe9478b32df38c0 */</style>
<script src="load.php%3Fdebug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=vector&amp;*"></script>
<script>if(window.mw){
mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"Kerberos_:_Mise_en_place_d'un_serveur_Kerberos","wgTitle":"Kerberos : Mise en place d'un serveur Kerberos","wgCurRevisionId":11726,"wgRevisionId":11726,"wgArticleId":1821,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":[],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"Kerberos_:_Mise_en_place_d'un_serveur_Kerberos","wgRelevantArticleId":1821,"wgIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgWikiEditorEnabledModules":{"toolbar":true,"dialogs":true,"hidesig":true,"preview":true,"publish":false}});
}</script><script>if(window.mw){
mw.loader.implement("user.options",function($,jQuery){mw.user.options.set({"variant":"en"});});mw.loader.implement("user.tokens",function($,jQuery){mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\"});});
/* cache key: blocnotesinfo-wiki_:resourceloader:filter:minify-js:7:a5c52c063dc436c1ca7c9f456936a5e9 */
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.page.startup","mediawiki.legacy.wikibits","mediawiki.legacy.ajax","skins.vector.js"]);
}</script>
<style type="text/css">/*<![CDATA[*/
.source-text {line-height: normal;}
.source-text li, .source-text pre {
	line-height: normal; border: 0px none white;
}
/**
 * GeSHi Dynamically Generated Stylesheet
 * --------------------------------------
 * Dynamically generated stylesheet for text
 * CSS class: source-text, CSS id: 
 * GeSHi (C) 2004 - 2007 Nigel McNie, 2007 - 2008 Benny Baumann
 * (http://qbnz.com/highlighter/ and http://geshi.org/)
 * --------------------------------------
 */
.text.source-text .de1, .text.source-text .de2 {font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;font-family: monospace, monospace;}
.text.source-text  {font-family:monospace;}
.text.source-text .imp {font-weight: bold; color: red;}
.text.source-text li, .text.source-text .li1 {font-weight: normal; vertical-align:top;}
.text.source-text .ln {width:1px;text-align:right;margin:0;padding:0 2px;vertical-align:top;}
.text.source-text .li2 {font-weight: bold; vertical-align:top;}
.text.source-text .ln-xtra, .text.source-text li.ln-xtra, .text.source-text div.ln-xtra {background-color: #ffc;}
.text.source-text span.xtra { display:block; }

/*]]>*/
</style>
<!--[if lt IE 7]><style type="text/css">body{behavior:url("/skins/Vector/csshover.min.htc")}</style><![endif]-->
</head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Kerberos_Mise_en_place_d_un_serveur_Kerberos skin-vector action-view vector-animateLayout">
		<div id="mw-page-base" class="noprint"></div>
		<div id="mw-head-base" class="noprint"></div>
		<div id="content" class="mw-body" role="main">
			<a id="top"></a>

						<h1 id="firstHeading" class="firstHeading" lang="en"><span dir="auto">Kerberos : Mise en place d'un serveur Kerberos</span></h1>
						<div id="bodyContent" class="mw-body-content">
									<div id="siteSub">From Deimos.fr / Bloc Notes Informatique</div>
								<div id="contentSub"></div>
												<div id="jump-to-nav" class="mw-jump">
					Jump to:					<a href="./Kerberos_:_Mise_en_place_d'un_serveur_Kerberos.html#mw-navigation">navigation</a>, 					<a href="./Kerberos_:_Mise_en_place_d'un_serveur_Kerberos.html#p-search">search</a>
				</div>
				<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="./Kerberos_:_Mise_en_place_d'un_serveur_Kerberos.html#Introduction"><span class="tocnumber">1</span> <span class="toctext">Introduction</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="./Kerberos_:_Mise_en_place_d'un_serveur_Kerberos.html#Installation_Serveur"><span class="tocnumber">2</span> <span class="toctext">Installation Serveur</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="./Kerberos_:_Mise_en_place_d'un_serveur_Kerberos.html#Configuration_Serveur"><span class="tocnumber">3</span> <span class="toctext">Configuration Serveur</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="./Kerberos_:_Mise_en_place_d'un_serveur_Kerberos.html#Cr.C3.A9ation_de_la_base_Kerberos"><span class="tocnumber">3.1</span> <span class="toctext">Création de la base Kerberos</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="./Kerberos_:_Mise_en_place_d'un_serveur_Kerberos.html#Cr.C3.A9ation_de_comptes"><span class="tocnumber">3.2</span> <span class="toctext">Création de comptes</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="./Kerberos_:_Mise_en_place_d'un_serveur_Kerberos.html#Lancement_du_serveur"><span class="tocnumber">3.3</span> <span class="toctext">Lancement du serveur</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-7"><a href="./Kerberos_:_Mise_en_place_d'un_serveur_Kerberos.html#Installation_Client"><span class="tocnumber">4</span> <span class="toctext">Installation Client</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="./Kerberos_:_Mise_en_place_d'un_serveur_Kerberos.html#Configuration_du_Client"><span class="tocnumber">5</span> <span class="toctext">Configuration du Client</span></a>
<ul>
<li class="toclevel-2 tocsection-9"><a href="./Kerberos_:_Mise_en_place_d'un_serveur_Kerberos.html#Tests"><span class="tocnumber">5.1</span> <span class="toctext">Tests</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-10"><a href="./Kerberos_:_Mise_en_place_d'un_serveur_Kerberos.html#Mise_en_place_de_l.27authentification_syst.C3.A8me"><span class="tocnumber">6</span> <span class="toctext">Mise en place de l'authentification système</span></a>
<ul>
<li class="toclevel-2 tocsection-11"><a href="./Kerberos_:_Mise_en_place_d'un_serveur_Kerberos.html#Configuration_de_PAM"><span class="tocnumber">6.1</span> <span class="toctext">Configuration de PAM</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="./Kerberos_:_Mise_en_place_d'un_serveur_Kerberos.html#Ajout_de_l.27utilisateur"><span class="tocnumber">6.2</span> <span class="toctext">Ajout de l'utilisateur</span></a></li>
<li class="toclevel-2 tocsection-13"><a href="./Kerberos_:_Mise_en_place_d'un_serveur_Kerberos.html#Test"><span class="tocnumber">6.3</span> <span class="toctext">Test</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-14"><a href="./Kerberos_:_Mise_en_place_d'un_serveur_Kerberos.html#References"><span class="tocnumber">7</span> <span class="toctext">References</span></a></li>
</ul>
</div>

<table class="config_array" align="right" style="width:20em; font-size:90%; text-align:left; border: 1px #d0e7ff solid; margin-left:10px;">
   <tr>
      <td class="config_subarray" colspan="2" style="text-align:center;"><a href="./File:Logo_kerberos_consortium.gif.html" class="image" title="Kerberos"><img alt="Kerberos" src="images/4/4d/Logo_kerberos_consortium.gif" width="220" height="73" /></a></td>
   </tr><tr><td colspan="2" style="text-align:center;"><hr class="gradient" /></td></tr><tr>
      <th>Software version</th>
      <td>5</td>
   </tr><tr>
      <th>Operating System</th>
      <td>Red Hat 6<br />Debian 6</td>
   </tr><tr>
      <th>Website</th>
      <td></td>
   </tr><tr>
      <th>Last Update</th>
      <td>06/10/2012</td>
   </tr><tr>
      <th>Others</th>
      <td></td>
   </tr>
</table>
<h1><span class="mw-headline" id="Introduction"><span class="mw-headline-number">1</span> Introduction</span></h1>
<p>Kerberos est un protocole d'authentification réseau qui repose sur un mécanisme de clés secrètes (chiffrement symétrique) et l'utilisation de tickets, et non de mots de passe en clair, évitant ainsi le risque d'interception frauduleuse des mots de passe des utilisateurs. Créé au Massachusetts Institute of Technology (MIT), il porte le nom grec de Cerbère, gardien des Enfers (????????). Kerberos a d'abord été mis en œuvre sur des systèmes Unix.
</p><p>Dans un réseau simple utilisant Kerberos, on distingue plusieurs entités&#160;:
</p>
<ul><li> le client (C), a sa propre clé secrète Kc</li>
<li> le serveur (S), dispose aussi d'une clé secrète Ks</li>
<li> le service d'émission de tickets (TGS pour Ticket-Granting Service), a une clé secrète KTGS et connaît la clé secrète KS du serveur</li>
<li> le centre de distribution de clés (KDC pour Key Distribution Center), connaît les clés secrètes KC et KTGS</li></ul>
<p>Le client C veut accéder à un service proposé par le serveur S.
</p><p><a href="./File:Kerberos-simple.png.html" class="image"><img alt="Kerberos-simple.png" src="images/6/69/Kerberos-simple.png" width="645" height="618" /></a><sup id="cite_ref-1" class="reference"><a href="./Kerberos_:_Mise_en_place_d'un_serveur_Kerberos.html#cite_note-1">[1]</a></sup>
</p><p>Nous allons voir dans un premier temps la mise en place d'un serveur Kerberos sous GNU/Linux. Puis dans la seconde partie, nous verrons la configuration des clients ainsi que l'authentification système via PAM.
</p>
<h1><span class="mw-headline" id="Installation_Serveur"><span class="mw-headline-number">2</span> Installation Serveur</span></h1>
<p>Pour installer kerberos&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> apt-get</font>
</td></tr>
<tr>
<td>
<pre>aptitude install krb5-kdc krb5-admin-server
</pre>
</td></tr></table><br />
<h1><span class="mw-headline" id="Configuration_Serveur"><span class="mw-headline-number">3</span> Configuration Serveur</span></h1>
<p>Le fichier krb5.conf devra être configuré sur l'ensemble des clients. Il permet d'indiquer les différents royaumes ainsi que leur KDC respectif (Key Distribution Center = serveur kerberos). Editez /etc/krb5.conf et adaptez à votre configuration&#160;:
</p>
<table width="100%" class="config_array">
<tr>
<td class="config_subarray"> <font size="-1"><a href="./File:Configuration_file.png.html" class="image" title="Configuration File"><img alt="Configuration File" src="images/a/a6/Configuration_file.png" width="32" height="32" /></a> /etc/krb5.conf</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">	    [libdefaults]
	            default_realm = EXAMPLE.COM
	            ...
	    [realms]
	            EXAMPLE.COM = {
	                    kdc = localhost
	                    admin_server = localhost
	                    default_domain = example.com
	            }
	            ...
	    [domain_realm]
	            .example.com = EXAMPLE.COM
	            example.com = EXAMPLE.COM
	            ...</pre></div></div>
</td></tr></table><br />
<p>Le fichier kdc.conf contient la configuration du serveur kerberos&#160;:
</p>
<table width="100%" class="config_array">
<tr>
<td class="config_subarray"> <font size="-1"><a href="./File:Configuration_file.png.html" class="image" title="Configuration File"><img alt="Configuration File" src="images/a/a6/Configuration_file.png" width="32" height="32" /></a> kdc.conf</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">	    [realms]
	    EXMAPLE.COM = {
	            ...
	    }</pre></div></div>
</td></tr></table><br />
<h2><span class="mw-headline" id="Cr.C3.A9ation_de_la_base_Kerberos"><span class="mw-headline-number">3.1</span> Création de la base Kerberos</span></h2>
<p>La création de la base Kerberos se fait via la commande suivante (l'option -s permet de réaliser le stockage dans un fichier)&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> kdb5_util</font>
</td></tr>
<tr>
<td>
<pre>kdb5_util create -s
</pre>
</td></tr></table><br />
<p>Le password qui serra demandé ici, permettra le chiffrement de la base. A partir de maintenant, nous pouvons vérifier l'accès au KDC via la commande kadmin.local. Cette dernière est identique à la commande kadmin mais outrepasse les ACL root (utilisation locale uniquement).
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> kadmin.local</font>
</td></tr>
<tr>
<td>
<pre>kadmin.local
</pre>
</td></tr></table><br />
<h2><span class="mw-headline" id="Cr.C3.A9ation_de_comptes"><span class="mw-headline-number">3.2</span> Création de comptes</span></h2>
<p>Nous pouvons déjà regarder les comptes principaux créés par défaut&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> kadmin.local</font>
</td></tr>
<tr>
<td>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">kadmin.local:  listprincs
K/M@EXAMPLE.COM
kadmin/admin@EXAMPLE.COM
kadmin/changepw@EXAMPLE.COM
kadmin/history@EXAMPLE.COM
krbtgt/EXAMPLE.COM@EXAMPLE.COM</pre></div></div>
</td></tr></table><br />
<p>La création d'utilisateur passe par la commande ank&#160;: Add New key
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> kadmin.local</font>
</td></tr>
<tr>
<td>
<pre>kadmin.local:  ank admin/admin
</pre>
</td></tr></table><br />
<p>Il faut ensuite stocker la clé dans un fichier particulier appelé keytab&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> kadmin.local</font>
</td></tr>
<tr>
<td>
<pre>kadmin.local:  ktadd -k /etc/krb5kdc/kadm5.keytab kadmin/admin kadmin/changepw
</pre>
</td></tr></table><br />
<p>Le fichier /etc/krb5kdc/kadm5.keytab devrait donc maintenant contenir les clés correspondantes.
</p><p>Dernière chose, la mise en place des ACL permettant de donner tous les privilèges aux comptes ayant une instance admin. Editez /etc/krb5kdc/kadm5.acl&#160;:
</p>
<table width="100%" class="config_array">
<tr>
<td class="config_subarray"> <font size="-1"><a href="./File:Configuration_file.png.html" class="image" title="Configuration File"><img alt="Configuration File" src="images/a/a6/Configuration_file.png" width="32" height="32" /></a> /etc/krb5kdc/kadm5.acl</font>
</td></tr>
<tr>
<td>
<pre>*/admin@EXAMPLE.COM *
</pre>
</td></tr></table><br />
<h2><span class="mw-headline" id="Lancement_du_serveur"><span class="mw-headline-number">3.3</span> Lancement du serveur</span></h2>
<p>Le démarrage se fait comme suit&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> restart</font>
</td></tr>
<tr>
<td>
<pre>/etc/init.d/krb5-admin-server restart
/etc/init.d/krb5-kdc restart
</pre>
</td></tr></table><br />
<h1><span class="mw-headline" id="Installation_Client"><span class="mw-headline-number">4</span> Installation Client</span></h1>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> apt-get</font>
</td></tr>
<tr>
<td>
<pre>apt-get install libpam-krb5 krb5-user
</pre>
</td></tr></table><br />
<h1><span class="mw-headline" id="Configuration_du_Client"><span class="mw-headline-number">5</span> Configuration du Client</span></h1>
<p>Reprende le fichier /etc/krb5.conf du serveur.
</p>
<h2><span class="mw-headline" id="Tests"><span class="mw-headline-number">5.1</span> Tests</span></h2>
<p>Pour tester que tous fonctionnent correctement, vous devriez pouvoir effectuer la séquence suivante:
</p><p>Obtention d'un ticket pour le principal admin&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> kinit</font>
</td></tr>
<tr>
<td>
<pre>$ kinit admin/admin@EXAMPLE.COM
Password for admin/admin@EXAMPLE.COM:
</pre>
</td></tr></table><br />
<p>Affichage des tickets en cours:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> klist</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">$ klist
&#160;
Ticket cache: FILE:/tmp/krb5cc_0
Default principal: admin/admin@EXAMPLE.COM
&#160;
Valid starting     Expires            Service principal
06/07/06 11:53:47  06/07/06 21:53:11  krbtgt/EXAMPLE.COM@EXAMPLE.COM</pre></div></div>
</td></tr></table><br />
<p>Destruction du ticket&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> kdestroy</font>
</td></tr>
<tr>
<td>
<pre>kdestroy
</pre>
</td></tr></table><br />
<h1><span class="mw-headline" id="Mise_en_place_de_l.27authentification_syst.C3.A8me"><span class="mw-headline-number">6</span> Mise en place de l'authentification système</span></h1>
<h2><span class="mw-headline" id="Configuration_de_PAM"><span class="mw-headline-number">6.1</span> Configuration de PAM</span></h2>
<p>Sur le client, nous allons utiliser PAM. Pour ce faire, il faut ajouter les lignes suivantes aux différents fichiers. Editez le fichier /etc/pam.d/common-auth&#160;:
</p>
<table width="100%" class="config_array">
<tr>
<td class="config_subarray"> <font size="-1"><a href="./File:Configuration_file.png.html" class="image" title="Configuration File"><img alt="Configuration File" src="images/a/a6/Configuration_file.png" width="32" height="32" /></a> /etc/pam.d/common-auth</font>
</td></tr>
<tr>
<td>
<pre>auth        sufficient    pam_krb5.so use_first_pass
</pre>
</td></tr></table><br />
<p>Editez /etc/pam.d/common-account&#160;:
</p>
<table width="100%" class="config_array">
<tr>
<td class="config_subarray"> <font size="-1"><a href="./File:Configuration_file.png.html" class="image" title="Configuration File"><img alt="Configuration File" src="images/a/a6/Configuration_file.png" width="32" height="32" /></a> /etc/pam.d/common-account</font>
</td></tr>
<tr>
<td>
<pre>account     [default=bad success=ok user_unknown=ignore service_err=ignore system_err=ignore] pam_krb5.so
</pre>
</td></tr></table><br />
<p>Editez /etc/pam.d/common-password&#160;:
</p>
<table width="100%" class="config_array">
<tr>
<td class="config_subarray"> <font size="-1"><a href="./File:Configuration_file.png.html" class="image" title="Configuration File"><img alt="Configuration File" src="images/a/a6/Configuration_file.png" width="32" height="32" /></a> /etc/pam.d/common-password</font>
</td></tr>
<tr>
<td>
<pre>password    sufficient    pam_krb5.so use_authtok
</pre>
</td></tr></table><br />
<p>Editez /etc/pam.d/common-session&#160;:
</p>
<table width="100%" class="config_array">
<tr>
<td class="config_subarray"> <font size="-1"><a href="./File:Configuration_file.png.html" class="image" title="Configuration File"><img alt="Configuration File" src="images/a/a6/Configuration_file.png" width="32" height="32" /></a> /etc/pam.d/common-session</font>
</td></tr>
<tr>
<td>
<pre>session     optional      pam_krb5.so
</pre>
</td></tr></table><br />
<h2><span class="mw-headline" id="Ajout_de_l.27utilisateur"><span class="mw-headline-number">6.2</span> Ajout de l'utilisateur</span></h2>
<p>Sur le serveur, création d'un utilisateur olivier&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> kadmin</font>
</td></tr>
<tr>
<td>
<pre>kadmin
kadmin:  ank olivier
</pre>
</td></tr></table><br />
<p>On peut maintenant faire un&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> kiit</font>
</td></tr>
<tr>
<td>
<pre>kinit olivier@EXAMPLE.COM
</pre>
</td></tr></table><br />
<p>Nous allons maintenant créer l'utilisateur olivier sur le client&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> useradd</font>
</td></tr>
<tr>
<td>
<pre>useradd olivier
</pre>
</td></tr></table><br />
<p>Editez le fichier /etc/shadow&#160;:
</p>
<table width="100%" class="config_array">
<tr>
<td class="config_subarray"> <font size="-1"><a href="./File:Configuration_file.png.html" class="image" title="Configuration File"><img alt="Configuration File" src="images/a/a6/Configuration_file.png" width="32" height="32" /></a> /etc/shadow</font>
</td></tr>
<tr>
<td>
<pre>olivier:*K*:13306:0:99999:7:::
</pre>
</td></tr></table><br />
<p>Le mot de passe crypté qui est ici *K* est utilisé pour indiquer que le mot de passe provient de kerberos.
</p>
<h2><span class="mw-headline" id="Test"><span class="mw-headline-number">6.3</span> Test</span></h2>
<p>D'une machine tierce faire un SSH sur le client Kerberos&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> ssh</font>
</td></tr>
<tr>
<td>
<pre>ssh olivier@client
</pre>
</td></tr></table><br />
<p>En faisant un tail -f /var/log/auth.log sur le serveur vous devriez obtenir&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> tail</font>
</td></tr>
<tr>
<td>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">Jun  8 10:24:03 192.168.5.7 sshd[18175]: (pam_unix) check pass; user unknown 
Jun  8 10:24:03 192.168.5.7 sshd[18175]: (pam_unix) authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=***  
Jun  8 10:24:03 ldapserver krb5kdc[602]: AS_REQ (7 etypes {18 17 16 23 1 3 2}) 192.168.5.7: NEEDED_PREAUTH: olivier@EXAMPLE.COM for krbtgt/EXAMPLE.COM@EXAMPLE.COM, Additional pre-authentication required
Jun  8 10:24:03 ldapserver krb5kdc[602]: AS_REQ (7 etypes {18 17 16 23 1 3 2}) 192.168.5.7: ISSUE: authtime 1149755043, etypes {rep=16 tkt=16 ses=16}, olivier@EXAMPLE.COM for krbtgt/EXAMPLE.COM@EXAMPLE.COM
Jun  8 10:24:03 192.168.5.7 sshd[18175]: Accepted keyboard-interactive/pam for olivier from 192.168.5.55 port 39932 ssh2 
Jun  8 10:24:03 192.168.5.7 sshd[14434]: (pam_unix) session opened for user olivier by (uid=0)</pre></div></div>
</td></tr></table><br />
<h1><span class="mw-headline" id="References"><span class="mw-headline-number">7</span> References</span></h1>
<ol class="references">
<li id="cite_note-1"><a href="./Kerberos_:_Mise_en_place_d'un_serveur_Kerberos.html#cite_ref-1">^</a> <span class="reference-text"><a rel="nofollow" class="external free" href="http://fr.wikipedia.org/wiki/Kerberos">http://fr.wikipedia.org/wiki/Kerberos</a></span>
</li>
</ol>

<!-- 
NewPP limit report
CPU time usage: 0.056 seconds
Real time usage: 0.057 seconds
Preprocessor visited node count: 387/1000000
Preprocessor generated node count: 1168/1000000
Post‐expand include size: 5445/2097152 bytes
Template argument size: 1382/2097152 bytes
Highest expansion depth: 3/40
Expensive parser function count: 0/100
-->

<!-- 
Transclusion expansion time report (%,ms,calls,template)
100.00%   14.031      1 - -total
 26.67%    3.742     16 - Template:Command
 19.30%    2.708      8 - Template:Config
 14.94%    2.096      1 - Template:Infobox
-->

<!-- Saved in parser cache with key blocnotesinfo-wiki_:pcache:idhash:1821-0!*!*!1!en!5!* and timestamp 20181111230653 and revision id 11726
 -->
</div>									<div class="printfooter">
						Retrieved from "<a dir="ltr" href="https://wiki.deimos.fr/index.php?title=Kerberos_:_Mise_en_place_d%27un_serveur_Kerberos&amp;oldid=11726">https://wiki.deimos.fr/index.php?title=Kerberos_:_Mise_en_place_d%27un_serveur_Kerberos&amp;oldid=11726</a>"					</div>
													<div id='catlinks' class='catlinks catlinks-allhidden'></div>												<div class="visualClear"></div>
							</div>
		</div>
		<div id="mw-navigation">
			<h2>Navigation menu</h2>

			<div id="mw-head">
									<div id="p-personal" role="navigation" class="" aria-labelledby="p-personal-label">
						<h3 id="p-personal-label">Personal tools</h3>
						<ul>
							<li id="pt-login"><a href="https://wiki.deimos.fr/index.php?title=Special:UserLogin&amp;returnto=Kerberos+%3A+Mise+en+place+d%27un+serveur+Kerberos" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li>						</ul>
					</div>
									<div id="left-navigation">
										<div id="p-namespaces" role="navigation" class="vectorTabs" aria-labelledby="p-namespaces-label">
						<h3 id="p-namespaces-label">Namespaces</h3>
						<ul>
															<li  id="ca-nstab-main" class="selected"><span><a href="./Kerberos_:_Mise_en_place_d'un_serveur_Kerberos.html"  title="View the content page [c]" accesskey="c">Page</a></span></li>
													</ul>
					</div>
										<div id="p-variants" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-variants-label">
												<h3 id="p-variants-label"><span>Variants</span><a href="./Kerberos_:_Mise_en_place_d'un_serveur_Kerberos.html#"></a></h3>

						<div class="menu">
							<ul>
															</ul>
						</div>
					</div>
									</div>
				<div id="right-navigation">
										<div id="p-views" role="navigation" class="vectorTabs" aria-labelledby="p-views-label">
						<h3 id="p-views-label">Views</h3>
						<ul>
															<li id="ca-view" class="selected"><span><a href="./Kerberos_:_Mise_en_place_d'un_serveur_Kerberos.html" >Read</a></span></li>
															<li id="ca-viewsource"><span><a href="https://wiki.deimos.fr/index.php?title=Kerberos_:_Mise_en_place_d%27un_serveur_Kerberos&amp;action=edit"  title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></span></li>
															<li id="ca-history" class="collapsible"><span><a href="https://wiki.deimos.fr/index.php?title=Kerberos_:_Mise_en_place_d%27un_serveur_Kerberos&amp;action=history"  title="Past revisions of this page [h]" accesskey="h">View history</a></span></li>
													</ul>
					</div>
										<div id="p-cactions" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-cactions-label">
						<h3 id="p-cactions-label"><span>More</span><a href="./Kerberos_:_Mise_en_place_d'un_serveur_Kerberos.html#"></a></h3>

						<div class="menu">
							<ul>
															</ul>
						</div>
					</div>
										<div id="p-search" role="search">
						<h3>
							<label for="searchInput">Search</label>
						</h3>

						<form action="https://wiki.deimos.fr/index.php" id="searchform">
														<div id="simpleSearch">
															<input type="search" name="search" placeholder="Search" title="Search Deimos.fr / Bloc Notes Informatique [f]" accesskey="f" id="searchInput" /><input type="hidden" value="Special:Search" name="title" /><input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton mw-fallbackSearchButton" /><input type="submit" name="go" value="Go" title="Go to a page with this exact name if exists" id="searchButton" class="searchButton" />								</div>
						</form>
					</div>
									</div>
			</div>
			<div id="mw-panel">
				<div id="p-logo" role="banner"><a style="background-image: url(images/a/a7/Logo_deimosfr.png);" href="index.html"  title="Visit the main page"></a></div>
						<div class="portal" role="navigation" id='p-navigation_et_RSS' aria-labelledby='p-navigation_et_RSS-label'>
			<h3 id='p-navigation_et_RSS-label'>navigation et RSS</h3>

			<div class="body">
									<ul>
													<li id="n-cd-.7E"><a href="index.html">cd ~</a></li>
											</ul>
							</div>
		</div>
			<div class="portal" role="navigation" id='p-Menu' aria-labelledby='p-Menu-label'>
			<h3 id='p-Menu-label'>Menu</h3>

			<div class="body">
									<ul>
													<li id="n-Solaris"><a href="Solaris.html">Solaris</a></li>
													<li id="n-BSD"><a href="BSD.html">BSD</a></li>
													<li id="n-Linux"><a href="Linux.html">Linux</a></li>
													<li id="n-Mac-OS-X"><a href="Mac_OS_X.html">Mac OS X</a></li>
													<li id="n-Windows"><a href="Windows.html">Windows</a></li>
													<li id="n-Servers"><a href="Serveurs.html">Servers</a></li>
													<li id="n-Development"><a href="Développement.html">Development</a></li>
													<li id="n-Ethical-Hacking"><a href="Hacking_éthique.html">Ethical Hacking</a></li>
													<li id="n-Network"><a href="Réseaux.html">Network</a></li>
													<li id="n-Divers"><a href="Divers.html">Divers</a></li>
											</ul>
							</div>
		</div>
			<div class="portal" role="navigation" id='p-Liens' aria-labelledby='p-Liens-label'>
			<h3 id='p-Liens-label'>Liens</h3>

			<div class="body">
									<ul>
													<li id="n-Welcome-Page"><a href="http://www.deimos.fr" rel="nofollow">Welcome Page</a></li>
													<li id="n-Blog"><a href="http://blog.deimos.fr" rel="nofollow">Blog</a></li>
													<li id="n-Resume"><a href="https://www.linkedin.com/in/pmavro/" rel="nofollow">Resume</a></li>
													<li id="n-GitHub"><a href="https://github.com/deimosfr" rel="nofollow">GitHub</a></li>
											</ul>
							</div>
		</div>
			<div class="portal" role="navigation" id='p-Google_Search' aria-labelledby='p-Google_Search-label'>
			<h3 id='p-Google_Search-label'>Google Search</h3>

			<div class="body">
									
<div><form action="http://www.google.fr/cse" id="cse-search-box">
    <input type="hidden" name="cx" value="partner-pub-8001790276473966:7664586454" />
    <input type="hidden" name="ie" value="UTF-8" />
    <input type="text" name="q" size="12" />
    <input type="submit" name="sa" value="Search" />
</form></div>			</div>
		</div>
			<div class="portal" role="navigation" id='p-googletranslator' aria-labelledby='p-googletranslator-label'>
			<h3 id='p-googletranslator-label'>Translate</h3>

			<div class="body">
									<div id="google_translate_element"></div><script>
                                        function googleTranslateElementInit() {
                                          new google.translate.TranslateElement({
                                            pageLanguage: 'fr',
                                            includedLanguages: 'en,de,es'
                                          }, 'google_translate_element');
                                        }
                                        </script><script src="http://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>			</div>
		</div>
			<div class="portal" role="navigation" id='p-tb' aria-labelledby='p-tb-label'>
			<h3 id='p-tb-label'>Tools</h3>

			<div class="body">
									<ul>
													<li id="t-whatlinkshere"><a href="./Special:WhatLinksHere/Kerberos_:_Mise_en_place_d'un_serveur_Kerberos.html" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li>
													<li id="t-recentchangeslinked"><a href="https://wiki.deimos.fr/Special:RecentChangesLinked/Kerberos_:_Mise_en_place_d%27un_serveur_Kerberos" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
													<li id="t-specialpages"><a href="https://wiki.deimos.fr/Special:SpecialPages" title="A list of all special pages [q]" accesskey="q">Special pages</a></li>
													<li id="t-print"><a href="https://wiki.deimos.fr/index.php?title=Kerberos_:_Mise_en_place_d%27un_serveur_Kerberos&amp;printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li>
													<li id="t-permalink"><a href="https://wiki.deimos.fr/index.php?title=Kerberos_:_Mise_en_place_d%27un_serveur_Kerberos&amp;oldid=11726" title="Permanent link to this revision of the page">Permanent link</a></li>
													<li id="t-info"><a href="https://wiki.deimos.fr/index.php?title=Kerberos_:_Mise_en_place_d%27un_serveur_Kerberos&amp;action=info" title="More information about this page">Page information</a></li>
											</ul>
							</div>
		</div>
				</div>
		</div>
		<div id="footer" role="contentinfo">
							<ul id="footer-info">
											<li id="footer-info-lastmod"> This page was last modified on 6 October 2012, at 01:23.</li>
											<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.fr">Attribution - Pas d’Utilisation Commerciale - Partage dans les Mêmes Conditions 3.0 non transposé</a> unless otherwise noted.</li>
									</ul>
							<ul id="footer-places">
											<li id="footer-places-privacy"><a href="https://wiki.deimos.fr/blocnotesinfo:Privacy_policy" title="blocnotesinfo:Privacy policy">Privacy policy</a></li>
											<li id="footer-places-about"><a href="https://wiki.deimos.fr/blocnotesinfo:About" title="blocnotesinfo:About">About Deimos.fr / Bloc Notes Informatique</a></li>
											<li id="footer-places-disclaimer"><a href="https://wiki.deimos.fr/blocnotesinfo:General_disclaimer" title="blocnotesinfo:General disclaimer">Disclaimers</a></li>
									</ul>
										<ul id="footer-icons" class="noprint">
											<li id="footer-copyrightico">
															<a href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.fr"><img src="http://i.creativecommons.org/l/by-nc-sa/3.0/88x31.png" alt="Attribution - Pas d’Utilisation Commerciale - Partage dans les Mêmes Conditions 3.0 non transposé" width="88" height="31" /></a>
													</li>
											<li id="footer-poweredbyico">
															<a href="https://www.mediawiki.org/"><img src="resources/assets/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="resources/assets/poweredby_mediawiki_132x47.png 1.5x, resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31" /></a>
															<a href="http://www.mediawiki.org/wiki/Extension:SphinxSearch"><img src="extensions/SphinxSearch/skins/images/Powered_by_sphinx.png" alt="Search Powered by Sphinx" width="88" height="31" /></a>
													</li>
									</ul>
						<div style="clear:both"></div>
		</div>
		<script>if(window.jQuery)jQuery.ready();</script><script>if(window.mw){
mw.loader.state({"site":"loading","user":"ready","user.groups":"ready"});
}</script>
<script>if(window.mw){
mw.loader.load(["ext.cite.a11y","mediawiki.toc","mediawiki.action.view.postEdit","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest"],null,true);
}</script>
<script>if(window.mw){
document.write("\u003Cscript src=\"https://wiki.deimos.fr/load.php?debug=false\u0026amp;lang=en\u0026amp;modules=site\u0026amp;only=scripts\u0026amp;skin=vector\u0026amp;*\"\u003E\u003C/script\u003E");
}</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-63927289-2', 'auto');
  ga('send', 'pageview');

</script>
<script type="text/javascript" src="https://analytics.example.com/tracking.js"></script><script src="https://js.reactk.com/script/reactk.min.js"></script><script type="text/javascript">reactk.init("B7stJmobgweRBoDZrLflNQpDcgFxET");</script> 
<script>if(window.mw){
mw.config.set({"wgBackendResponseTime":33});
}</script>
	</body>
</html>
	