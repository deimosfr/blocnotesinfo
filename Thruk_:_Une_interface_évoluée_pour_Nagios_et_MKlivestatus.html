<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">
<head>
<meta charset="UTF-8" />
<title>Thruk : Une interface évoluée pour Nagios et MKlivestatus - Deimos.fr / Bloc Notes Informatique</title>
<meta name="generator" content="MediaWiki 1.25.5" />
<link rel="shortcut icon" href="https://wiki.deimos.fr/favicon.ico" />
<link rel="search" type="application/opensearchdescription+xml" href="opensearch_desc.php" title="Deimos.fr / Bloc Notes Informatique (en)" />
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.deimos.fr/api.php?action=rsd" />
<link rel="alternate" hreflang="x-default" href="./Thruk_:_Une_interface_évoluée_pour_Nagios_et_MKlivestatus.html" />
<link rel="copyright" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.fr" />
<link rel="alternate" type="application/atom+xml" title="Deimos.fr / Bloc Notes Informatique Atom feed" href="https://wiki.deimos.fr/index.php?title=Special:RecentChanges&amp;feed=atom" />
<link rel="stylesheet" href="load.php%3Fdebug=false&amp;lang=en&amp;modules=mediawiki.legacy.commonPrint,shared|mediawiki.sectionAnchor|mediawiki.skinning.interface|mediawiki.ui.button|skins.vector.styles&amp;only=styles&amp;skin=vector&amp;*.css" />
<meta name="ResourceLoaderDynamicStyles" content="" />
<link rel="stylesheet" href="load.php%3Fdebug=false&amp;lang=en&amp;modules=site&amp;only=styles&amp;skin=vector&amp;*.css" />
<style>a:lang(ar),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}
/* cache key: blocnotesinfo-wiki_:resourceloader:filter:minify-css:7:6f8c0c45eefd74c7bbe9478b32df38c0 */</style>
<script src="load.php%3Fdebug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=vector&amp;*"></script>
<script>if(window.mw){
mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"Thruk_:_Une_interface_évoluée_pour_Nagios_et_MKlivestatus","wgTitle":"Thruk : Une interface évoluée pour Nagios et MKlivestatus","wgCurRevisionId":10978,"wgRevisionId":10978,"wgArticleId":3354,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":[],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"Thruk_:_Une_interface_évoluée_pour_Nagios_et_MKlivestatus","wgRelevantArticleId":3354,"wgIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgWikiEditorEnabledModules":{"toolbar":true,"dialogs":true,"hidesig":true,"preview":true,"publish":false}});
}</script><script>if(window.mw){
mw.loader.implement("user.options",function($,jQuery){mw.user.options.set({"variant":"en"});});mw.loader.implement("user.tokens",function($,jQuery){mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\"});});
/* cache key: blocnotesinfo-wiki_:resourceloader:filter:minify-js:7:a5c52c063dc436c1ca7c9f456936a5e9 */
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.page.startup","mediawiki.legacy.wikibits","mediawiki.legacy.ajax","skins.vector.js"]);
}</script>
<style type="text/css">/*<![CDATA[*/
.source-text {line-height: normal;}
.source-text li, .source-text pre {
	line-height: normal; border: 0px none white;
}
/**
 * GeSHi Dynamically Generated Stylesheet
 * --------------------------------------
 * Dynamically generated stylesheet for text
 * CSS class: source-text, CSS id: 
 * GeSHi (C) 2004 - 2007 Nigel McNie, 2007 - 2008 Benny Baumann
 * (http://qbnz.com/highlighter/ and http://geshi.org/)
 * --------------------------------------
 */
.text.source-text .de1, .text.source-text .de2 {font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;font-family: monospace, monospace;}
.text.source-text  {font-family:monospace;}
.text.source-text .imp {font-weight: bold; color: red;}
.text.source-text li, .text.source-text .li1 {font-weight: normal; vertical-align:top;}
.text.source-text .ln {width:1px;text-align:right;margin:0;padding:0 2px;vertical-align:top;}
.text.source-text .li2 {font-weight: bold; vertical-align:top;}
.text.source-text .ln-xtra, .text.source-text li.ln-xtra, .text.source-text div.ln-xtra {background-color: #ffc;}
.text.source-text span.xtra { display:block; }

/*]]>*/
</style>
<style type="text/css">/*<![CDATA[*/
.source-apache {line-height: normal;}
.source-apache li, .source-apache pre {
	line-height: normal; border: 0px none white;
}
/**
 * GeSHi Dynamically Generated Stylesheet
 * --------------------------------------
 * Dynamically generated stylesheet for apache
 * CSS class: source-apache, CSS id: 
 * GeSHi (C) 2004 - 2007 Nigel McNie, 2007 - 2008 Benny Baumann
 * (http://qbnz.com/highlighter/ and http://geshi.org/)
 * --------------------------------------
 */
.apache.source-apache .de1, .apache.source-apache .de2 {font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;font-family: monospace, monospace;}
.apache.source-apache  {font-family:monospace;}
.apache.source-apache .imp {font-weight: bold; color: red;}
.apache.source-apache li, .apache.source-apache .li1 {font-weight: normal; vertical-align:top;}
.apache.source-apache .ln {width:1px;text-align:right;margin:0;padding:0 2px;vertical-align:top;}
.apache.source-apache .li2 {font-weight: bold; vertical-align:top;}
.apache.source-apache .kw1 {color: #00007f;}
.apache.source-apache .kw2 {color: #0000ff;}
.apache.source-apache .kw3 {color: #000000; font-weight:bold;}
.apache.source-apache .co1 {color: #adadad; font-style: italic;}
.apache.source-apache .es0 {color: #000099; font-weight: bold;}
.apache.source-apache .br0 {color: #339933;}
.apache.source-apache .sy0 {color: #008000;}
.apache.source-apache .st0 {color: #7f007f;}
.apache.source-apache .nu0 {color: #ff0000;}
.apache.source-apache .ln-xtra, .apache.source-apache li.ln-xtra, .apache.source-apache div.ln-xtra {background-color: #ffc;}
.apache.source-apache span.xtra { display:block; }

/*]]>*/
</style>
<style type="text/css">/*<![CDATA[*/
.source-diff {line-height: normal;}
.source-diff li, .source-diff pre {
	line-height: normal; border: 0px none white;
}
/**
 * GeSHi Dynamically Generated Stylesheet
 * --------------------------------------
 * Dynamically generated stylesheet for diff
 * CSS class: source-diff, CSS id: 
 * GeSHi (C) 2004 - 2007 Nigel McNie, 2007 - 2008 Benny Baumann
 * (http://qbnz.com/highlighter/ and http://geshi.org/)
 * --------------------------------------
 */
.diff.source-diff .de1, .diff.source-diff .de2 {font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;font-family: monospace, monospace;}
.diff.source-diff  {font-family:monospace;}
.diff.source-diff .imp {font-weight: bold; color: red;}
.diff.source-diff li, .diff.source-diff .li1 {font-weight: normal; vertical-align:top;}
.diff.source-diff .ln {width:1px;text-align:right;margin:0;padding:0 2px;vertical-align:top;}
.diff.source-diff .li2 {font-weight: bold; vertical-align:top;}
.diff.source-diff .kw1 {color: #aaaaaa; font-style: italic;}
.diff.source-diff .re0 {color: #440088;}
.diff.source-diff .re1 {color: #991111;}
.diff.source-diff .re2 {color: #00b000;}
.diff.source-diff .re3 {color: #888822;}
.diff.source-diff .re4 {color: #888822;}
.diff.source-diff .re5 {color: #0011dd;}
.diff.source-diff .re6 {color: #440088;}
.diff.source-diff .re7 {color: #991111;}
.diff.source-diff .re8 {color: #00b000;}
.diff.source-diff .re9 {color: #888822;}
.diff.source-diff .ln-xtra, .diff.source-diff li.ln-xtra, .diff.source-diff div.ln-xtra {background-color: #ffc;}
.diff.source-diff span.xtra { display:block; }

/*]]>*/
</style>
<style type="text/css">/*<![CDATA[*/
.source-perl {line-height: normal;}
.source-perl li, .source-perl pre {
	line-height: normal; border: 0px none white;
}
/**
 * GeSHi Dynamically Generated Stylesheet
 * --------------------------------------
 * Dynamically generated stylesheet for perl
 * CSS class: source-perl, CSS id: 
 * GeSHi (C) 2004 - 2007 Nigel McNie, 2007 - 2008 Benny Baumann
 * (http://qbnz.com/highlighter/ and http://geshi.org/)
 * --------------------------------------
 */
.perl.source-perl .de1, .perl.source-perl .de2 {font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;font-family: monospace, monospace;}
.perl.source-perl  {font-family:monospace;}
.perl.source-perl .imp {font-weight: bold; color: red;}
.perl.source-perl li, .perl.source-perl .li1 {font-weight: normal; vertical-align:top;}
.perl.source-perl .ln {width:1px;text-align:right;margin:0;padding:0 2px;vertical-align:top;}
.perl.source-perl .li2 {font-weight: bold; vertical-align:top;}
.perl.source-perl .kw1 {color: #b1b100;}
.perl.source-perl .kw2 {color: #000000; font-weight: bold;}
.perl.source-perl .kw3 {color: #000066;}
.perl.source-perl .co1 {color: #666666; font-style: italic;}
.perl.source-perl .co2 {color: #009966; font-style: italic;}
.perl.source-perl .co3 {color: #0000ff;}
.perl.source-perl .co4 {color: #cc0000; font-style: italic;}
.perl.source-perl .co5 {color: #0000ff;}
.perl.source-perl .coMULTI {color: #666666; font-style: italic;}
.perl.source-perl .es0 {color: #000099; font-weight: bold;}
.perl.source-perl .es_h {color: #000099; font-weight: bold;}
.perl.source-perl .br0 {color: #009900;}
.perl.source-perl .sy0 {color: #339933;}
.perl.source-perl .st0 {color: #ff0000;}
.perl.source-perl .st_h {color: #ff0000;}
.perl.source-perl .nu0 {color: #cc66cc;}
.perl.source-perl .me1 {color: #006600;}
.perl.source-perl .me2 {color: #006600;}
.perl.source-perl .re0 {color: #0000ff;}
.perl.source-perl .re4 {color: #009999;}
.perl.source-perl .ln-xtra, .perl.source-perl li.ln-xtra, .perl.source-perl div.ln-xtra {background-color: #ffc;}
.perl.source-perl span.xtra { display:block; }

/*]]>*/
</style>
<!--[if lt IE 7]><style type="text/css">body{behavior:url("/skins/Vector/csshover.min.htc")}</style><![endif]-->
</head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Thruk_Une_interface_évoluée_pour_Nagios_et_MKlivestatus skin-vector action-view vector-animateLayout">
		<div id="mw-page-base" class="noprint"></div>
		<div id="mw-head-base" class="noprint"></div>
		<div id="content" class="mw-body" role="main">
			<a id="top"></a>

						<h1 id="firstHeading" class="firstHeading" lang="en"><span dir="auto">Thruk : Une interface évoluée pour Nagios et MKlivestatus</span></h1>
						<div id="bodyContent" class="mw-body-content">
									<div id="siteSub">From Deimos.fr / Bloc Notes Informatique</div>
								<div id="contentSub"></div>
												<div id="jump-to-nav" class="mw-jump">
					Jump to:					<a href="./Thruk_:_Une_interface_évoluée_pour_Nagios_et_MKlivestatus.html#mw-navigation">navigation</a>, 					<a href="./Thruk_:_Une_interface_évoluée_pour_Nagios_et_MKlivestatus.html#p-search">search</a>
				</div>
				<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><table class="config_array" align="right" style="width:20em; font-size:90%; text-align:left; border: 1px #d0e7ff solid; margin-left:10px;">
   <tr>
      <td class="config_subarray" colspan="2" style="text-align:center;"><a href="./File:Thruk_logo.png.html" class="image"><img alt="Thruk logo.png" src="images/b/b2/Thruk_logo.png" width="139" height="50" /></a></td>
   </tr><tr><td colspan="2" style="text-align:center;"><hr class="gradient" /></td></tr><tr>
      <th>Software version</th>
      <td>1.30</td>
   </tr><tr>
      <th>Operating System</th>
      <td>Debian 6</td>
   </tr><tr>
      <th>Website</th>
      <td><a rel="nofollow" class="external text" href="http://www.thruk.org">Thruk Website</a></td>
   </tr><tr>
      <th>Last Update</th>
      <td>30/05/2012</td>
   </tr><tr>
      <th>Others</th>
      <td></td>
   </tr>
</table>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="./Thruk_:_Une_interface_évoluée_pour_Nagios_et_MKlivestatus.html#Introduction"><span class="tocnumber">1</span> <span class="toctext">Introduction</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="./Thruk_:_Une_interface_évoluée_pour_Nagios_et_MKlivestatus.html#Pr.C3.A9requis"><span class="tocnumber">2</span> <span class="toctext">Prérequis</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="./Thruk_:_Une_interface_évoluée_pour_Nagios_et_MKlivestatus.html#Installation"><span class="tocnumber">3</span> <span class="toctext">Installation</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="./Thruk_:_Une_interface_évoluée_pour_Nagios_et_MKlivestatus.html#Configuration"><span class="tocnumber">4</span> <span class="toctext">Configuration</span></a>
<ul>
<li class="toclevel-2 tocsection-5"><a href="./Thruk_:_Une_interface_évoluée_pour_Nagios_et_MKlivestatus.html#Apache_LDAP"><span class="tocnumber">4.1</span> <span class="toctext">Apache LDAP</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="./Thruk_:_Une_interface_évoluée_pour_Nagios_et_MKlivestatus.html#Thruk"><span class="tocnumber">4.2</span> <span class="toctext">Thruk</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="./Thruk_:_Une_interface_évoluée_pour_Nagios_et_MKlivestatus.html#Interface_minimale_pour_.C3.A9crans_de_supervision"><span class="tocnumber">4.3</span> <span class="toctext">Interface minimale pour écrans de supervision</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="./Thruk_:_Une_interface_évoluée_pour_Nagios_et_MKlivestatus.html#Ajouter_un_CGI_personnalis.C3.A9"><span class="tocnumber">4.4</span> <span class="toctext">Ajouter un CGI personnalisé</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-9"><a href="./Thruk_:_Une_interface_évoluée_pour_Nagios_et_MKlivestatus.html#FAQ"><span class="tocnumber">5</span> <span class="toctext">FAQ</span></a>
<ul>
<li class="toclevel-2 tocsection-10"><a href="./Thruk_:_Une_interface_évoluée_pour_Nagios_et_MKlivestatus.html#Les_logos_des_OS_ne_s.27affichent_plus"><span class="tocnumber">5.1</span> <span class="toctext">Les logos des OS ne s'affichent plus</span></a></li>
</ul>
</li>
</ul>
</div>

<h1><span class="mw-headline" id="Introduction"><span class="mw-headline-number">1</span> Introduction</span></h1>
<p>Thruk est une interface évoluée pour Nagios (et Shinken) qui permet de se connecter à plusieurs Nagios en même temps et d'afficher des informations plus pertinentes par rapport à l'interface standard de Nagios.
</p>
<h1><span class="mw-headline" id="Pr.C3.A9requis"><span class="mw-headline-number">2</span> Prérequis</span></h1>
<p>Voici les prérequis&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> aptitude</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">aptitude install libapache2-mod-fcgid</pre></div></div>
</td></tr></table><br />
<h1><span class="mw-headline" id="Installation"><span class="mw-headline-number">3</span> Installation</span></h1>
<p>Nous allons télécharger Thruk&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> dpkg</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">wget http://www.thruk.org/files/pkg/v1.30/debian6/amd64/thruk_1.30_debian6_amd64.deb
dpkg -i thruk_1.30_debian6_amd64.deb</pre></div></div>
</td></tr></table><br />
<p>Vous pouvez maintenant vous connecter à l'interface Thruk&#160;: <a rel="nofollow" class="external free" href="http://nagios/thruk/">http://nagios/thruk/</a><br />
Login et mot de passe&#160;: thrukadmin
</p>
<h1><span class="mw-headline" id="Configuration"><span class="mw-headline-number">4</span> Configuration</span></h1>
<p>Nous allons dans un premier temps ajuster quelques droits pour éviter de futurs problèmes&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> </font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">chown www-data. /etc/thruk/thruk* /etc/thruk/cgi.cfg
chown -Rf nagios. /var/lib/nagios3
touch /etc/thruk/checkconfig
chown nagios:www-data /etc/thruk/checkconfig</pre></div></div>
</td></tr></table><br />
<h2><span class="mw-headline" id="Apache_LDAP"><span class="mw-headline-number">4.1</span> Apache LDAP</span></h2>
<p>Vous avez peut être envie de coller LDAP sur Thrunk, tout comme votre Nagios. C'est assez simple&#160;:
</p>
<table width="100%" class="config_array">
<tr>
<td class="config_subarray"> <font size="-1"><a href="./File:Configuration_file.png.html" class="image" title="Configuration File"><img alt="Configuration File" src="images/a/a6/Configuration_file.png" width="32" height="32" /></a> /etc/apache2/conf.d/thruk.conf</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="apache source-apache"><pre class="de1">&lt;<span class="kw3">IfModule</span> mod_fcgid.c&gt;
  <span class="kw1">AddHandler</span> fcgid-<span class="kw1">script</span> .sh
&#160;
  &lt;<span class="kw3">Directory</span> /usr/share/thruk&gt;
    <span class="kw1">Options</span> <span class="kw2">FollowSymLinks</span>
    <span class="kw1">AllowOverride</span> <span class="kw2">All</span>
    <span class="kw1">order</span> <span class="kw1">allow</span>,<span class="kw1">deny</span>
    <span class="kw1">allow</span> from <span class="kw2">all</span>
  &lt;/<span class="kw3">Directory</span>&gt;
  &lt;<span class="kw3">Directory</span> /etc/thruk/themes&gt;
    <span class="kw1">Options</span> <span class="kw2">FollowSymLinks</span>
    <span class="kw1">allow</span> from <span class="kw2">all</span>
  &lt;/<span class="kw3">Directory</span>&gt;
  &lt;<span class="kw3">Directory</span> /etc/thruk/plugins&gt;
    <span class="kw1">Options</span> <span class="kw2">FollowSymLinks</span>
    <span class="kw1">allow</span> from <span class="kw2">all</span>
  &lt;/<span class="kw3">Directory</span>&gt;
&#160;
  <span class="co1"># redirect to a startup page when there is no pidfile yet</span>
  <span class="kw1">RewriteEngine</span> <span class="kw2">On</span>
  <span class="kw1">RewriteCond</span>&#160;%{REQUEST_METHOD} GET
  <span class="kw1">RewriteCond</span>&#160;%{REQUEST_URI}&#160;!^/thruk/startup.html
  <span class="kw1">RewriteCond</span>&#160;%{REQUEST_URI}&#160;!^/thruk/side.html
  <span class="kw1">RewriteCond</span>&#160;%{REQUEST_URI}&#160;!^/thruk/.*\.(css|png|js)
  <span class="kw1">RewriteCond</span>&#160;%{REQUEST_URI} ^/thruk
  <span class="kw1">RewriteCond</span> /var/cache/thruk/thruk.pid&#160;!-f
  <span class="kw1">RewriteRule</span> ^(.*)$ /thruk/startup.html?$1 [R=<span class="nu0">302</span>,L,NE,QSA]
&#160;
  <span class="kw1">Alias</span> /thruk/documentation.html /usr/share/thruk/root/thruk/documentation.html
  <span class="kw1">Alias</span> /thruk/startup.html /usr/share/thruk/root/thruk/startup.html
  <span class="kw1">AliasMatch</span> ^/thruk/(.*\.cgi|.*\.html)  /usr/share/thruk/fcgid_env.sh/thruk/$1
  <span class="kw1">AliasMatch</span> ^/thruk/plugins/(.*?)/(.*)$  /etc/thruk/plugins/plugins-enabled/$1/root/$2
  <span class="kw1">Alias</span> /thruk/themes/  /etc/thruk/themes/themes-enabled/
  <span class="kw1">Alias</span> /thruk /usr/share/thruk/root/thruk
&#160;
<span class="xtra ln-xtra">  &lt;<span class="kw3">Location</span> /thruk&gt;</span><span class="xtra ln-xtra">    <span class="kw1">Options</span> ExecCGI</span><span class="xtra ln-xtra">  &lt;/<span class="kw3">Location</span>&gt;</span><span class="xtra ln-xtra">&#160;</span><span class="xtra ln-xtra">  &lt;<span class="kw3">DirectoryMatch</span> (/usr/share/thruk/root/thruk|/etc/thruk/themes/themes-enabled/)&gt;</span><span class="xtra ln-xtra">    <span class="kw1">Options</span> <span class="kw2">FollowSymLinks</span></span><span class="xtra ln-xtra">    <span class="co1">#DirectoryIndex index.php</span></span><span class="xtra ln-xtra">&#160;</span><span class="xtra ln-xtra">    <span class="kw1">AllowOverride</span> AuthConfig</span><span class="xtra ln-xtra">    <span class="kw1">Order</span> <span class="kw1">Deny</span>,<span class="kw1">Allow</span></span><span class="xtra ln-xtra">    <span class="kw1">Deny</span> From <span class="kw2">All</span></span><span class="xtra ln-xtra">    <span class="kw1">Allow</span> From 127.0.1.1</span><span class="xtra ln-xtra">    <span class="kw1">Allow</span> From 127.0.0.1</span><span class="xtra ln-xtra">&#160;</span><span class="xtra ln-xtra">    <span class="kw1">AuthName</span> <span class="st0">&quot;Thruk Access&quot;</span></span><span class="xtra ln-xtra">    <span class="kw1">AuthType</span> Basic</span><span class="xtra ln-xtra">    <span class="kw1">AuthBasicProvider</span> ldap</span><span class="xtra ln-xtra">&#160;</span><span class="xtra ln-xtra">    <span class="kw1">AuthzLDAPAuthoritative</span> <span class="kw2">on</span></span><span class="xtra ln-xtra">    <span class="kw1">AuthLDAPURL</span> ldap://openldap.deimos.fr/dc=openldap,dc=deimos,dc=fr?uid?sub?(objectClass=posixAccount)</span><span class="xtra ln-xtra">    <span class="kw1">AuthLDAPRemoteUserIsDN</span> <span class="kw2">off</span> </span><span class="xtra ln-xtra">    <span class="kw1">AuthLDAPGroupAttribute</span> memberUid</span><span class="xtra ln-xtra">    <span class="kw1">AuthLDAPGroupAttributeIsDN</span> <span class="kw2">off</span> </span><span class="xtra ln-xtra">    <span class="kw1">Require</span> ldap-<span class="kw1">group</span> ou=Groups,dc=openldap,dc=deimos,dc=fr</span><span class="xtra ln-xtra">    <span class="kw1">Require</span> ldap-<span class="kw1">user</span> nagiosadmin</span><span class="xtra ln-xtra">&#160;</span><span class="xtra ln-xtra">    <span class="kw1">Satisfy</span> Any </span><span class="xtra ln-xtra">  &lt;/<span class="kw3">DirectoryMatch</span>&gt;</span>&#160;
&lt;/<span class="kw3">IfModule</span>&gt;</pre></div></div>
</td></tr></table><br />
<h2><span class="mw-headline" id="Thruk"><span class="mw-headline-number">4.2</span> Thruk</span></h2>
<p>Pour la configuration de Thruk, il existe 2 fichiers importants&#160;:
</p>
<ul><li> thruk.conf&#160;: La configuration générale</li>
<li> thruk_local.conf&#160;: La configuration personnalisée</li></ul>
<p>D'après la doc officielle, il est préférable de ne pas toucher à la configuration générale et d'overrider certains paramètres avec la configuration personnalisée.
</p><p>Voici une configuration de base pour que ça fonctionne avec <a href="./Check_MK_:_Collecter_facilement_des_infos_Nagios_et_étendez_ses_possibilités.html" title="Check MK : Collecter facilement des infos Nagios et étendez ses possibilités">MK Livestatus</a>&#160;:
</p>
<table width="100%" class="config_array">
<tr>
<td class="config_subarray"> <font size="-1"><a href="./File:Configuration_file.png.html" class="image" title="Configuration File"><img alt="Configuration File" src="images/a/a6/Configuration_file.png" width="32" height="32" /></a> /etc/thruk/thruk_local.conf</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">############################################
# put your own settings into this file
# settings from this file will override
# those from the thruk.conf
############################################
&#160;
# Interface Options
default_theme       = Exfoliation
use_timezone = CET
use_ajax_search = 1
use_new_search = 1
info_popup_event_type = onmouseover
show_modified_attributes = 1
show_long_plugin_output = inline
show_full_commandline = 2
&#160;
# Backends to Mklivestatus
&lt;Component Thruk::Backend&gt;
    &lt;peer&gt;
        name   = Local Nagios
        type   = livestatus
        &lt;options&gt;
            peer          = /var/lib/nagios3/rw/live
            resource_file = /etc/nagios3/resource.cfg
       &lt;/options&gt;
       &lt;configtool&gt;
            core_conf      = /etc/nagios3/nagios.cfg
            obj_check_cmd  = /usr/sbin/nagios3 -v /etc/nagios3/nagios.cfg
            obj_reload_cmd = /etc/init.d/nagios3 reload
       &lt;/configtool&gt;
    &lt;/peer&gt;
&lt;/Component&gt;</pre></div></div>
</td></tr></table><br />
<p>Vous pouvez ajouter plusieurs Peer pour avoir une interface unique et plusieurs serveurs Nagios. Une fois que vous aurez la main sur l'interface de Thruk, vous pourrez configurer toutes ses options directement depuis cette interface, ainsi que celles de Nagios.
</p><p>Reloadez ensuite apache pour que les modifications soient prisent en compte.
</p>
<h2><span class="mw-headline" id="Interface_minimale_pour_.C3.A9crans_de_supervision"><span class="mw-headline-number">4.3</span> Interface minimale pour écrans de supervision</span></h2>
<p>J'avais déjà abordé dans <a href="./Nagios_:_Installation_et_configuration.html" title="Nagios : Installation et configuration">la doc sur Nagios</a> des solutions pour avoir un écran assez minimal. Le soucis c'est que ce n'est toujours pas suffisant et avec Thruk heureusement il y a moyen de corriger ce petit problèmes sans avoir à recoder les 3/4 du programme. J'ai donc créer un petit patch que j'ai soumis à l'équipe de Thruk (qui vient d'être accepté <a rel="nofollow" class="external free" href="https://github.com/sni/Thruk/commit/d1eefef82cd8fbab6ebebff8a570bb1e026d1a9f">https://github.com/sni/Thruk/commit/d1eefef82cd8fbab6ebebff8a570bb1e026d1a9f</a> mais ne sera dispo que dans la prochaine release (1.28)), alors en attendant, voici comme avoir une interface la plus minimal possible.
</p><p>Voici un premier patch pour modifier les module Perl de Thruk afin qu'il prenne en compte un nouveau paramètre dans l'URL appelé "minimal"&#160;:
</p>
<table width="100%" class="config_array">
<tr>
<td class="config_subarray"> <font size="-1"><a href="./File:Configuration_file.png.html" class="image" title="Configuration File"><img alt="Configuration File" src="images/a/a6/Configuration_file.png" width="32" height="32" /></a> Thruk_perl_modules.patch</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="diff source-diff"><pre class="de1">diff -Nru old/Root.pm new/Root.pm
<span class="re3">--- old/Root.pm 2012-04-06 13:05:08.000000000 +0200</span>
<span class="re4">+++ new/Root.pm 2012-04-06 13:05:16.000000000 +0200</span>
<span class="re6">@@ -215,6 +215,9 @@</span>
     <span class="br0">&#125;</span>
     $c-&gt;stash-&gt;<span class="br0">&#123;</span>hidetop<span class="br0">&#125;</span> = $c-&gt;<span class="br0">&#123;</span>'request'<span class="br0">&#125;</span>-&gt;<span class="br0">&#123;</span>'parameters'<span class="br0">&#125;</span>-&gt;<span class="br0">&#123;</span>'hidetop'<span class="br0">&#125;</span> || '';
&#160;
<span class="re8">+       # Add custom monitor screen function</span>
<span class="re8">+    $c-&gt;stash-&gt;<span class="br0">&#123;</span>minimal<span class="br0">&#125;</span> = $c-&gt;<span class="br0">&#123;</span>'request'<span class="br0">&#125;</span>-&gt;<span class="br0">&#123;</span>'parameters'<span class="br0">&#125;</span>-&gt;<span class="br0">&#123;</span>'minimal'<span class="br0">&#125;</span> || '';</span>
<span class="re8">+</span>
     # initialize our backends
     unless <span class="br0">&#40;</span> defined $c-&gt;<span class="br0">&#123;</span>'db'<span class="br0">&#125;</span> <span class="br0">&#41;</span> <span class="br0">&#123;</span>
         $c-&gt;<span class="br0">&#123;</span>'db'<span class="br0">&#125;</span> = $c-&gt;model<span class="br0">&#40;</span>'Thruk'<span class="br0">&#41;</span>;
diff -Nru old/status.pm new/status.pm
<span class="re3">--- old/status.pm       2012-04-06 13:05:08.000000000 +0200</span>
<span class="re4">+++ new/status.pm       2012-04-06 13:05:21.000000000 +0200</span>
<span class="re6">@@ -744,6 +744,9 @@</span>
     $c-&gt;stash-&gt;<span class="br0">&#123;</span>hidetop<span class="br0">&#125;</span>    = <span class="nu0">1</span> unless $c-&gt;stash-&gt;<span class="br0">&#123;</span>hidetop<span class="br0">&#125;</span> ne '';
     $c-&gt;stash-&gt;<span class="br0">&#123;</span>hidesearch<span class="br0">&#125;</span> = <span class="nu0">1</span>;
&#160;
<span class="re8">+    # Monitor screen interface</span>
<span class="re8">+    $c-&gt;stash-&gt;<span class="br0">&#123;</span>minimal<span class="br0">&#125;</span>    = <span class="nu0">1</span> unless $c-&gt;stash-&gt;<span class="br0">&#123;</span>minimal<span class="br0">&#125;</span> ne ''; </span>
<span class="re8">+</span>
     # which host to display?
     my<span class="br0">&#40;</span> $hostfilter<span class="br0">&#41;</span>           = Thruk::Utils::Status::do_filter<span class="br0">&#40;</span>$c, 'hst_'<span class="br0">&#41;</span>;
     my<span class="br0">&#40;</span> undef, $servicefilter<span class="br0">&#41;</span> = Thruk::Utils::Status::do_filter<span class="br0">&#40;</span>$c, 'svc_'<span class="br0">&#41;</span>;</pre></div></div>
</td></tr></table><br />
<p>Et ensuite nous allons modifier l'interface pour que les changements s'appliquent que sur une partie du code&#160;:
</p>
<table width="100%" class="config_array">
<tr>
<td class="config_subarray"> <font size="-1"><a href="./File:Configuration_file.png.html" class="image" title="Configuration File"><img alt="Configuration File" src="images/a/a6/Configuration_file.png" width="32" height="32" /></a> Thruk_interface.patch</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="diff source-diff"><pre class="de1">diff -Nru old/_header.tt new/_header.tt
<span class="re3">--- old/_header.tt      2012-04-06 13:39:31.000000000 +0200</span>
<span class="re4">+++ new/_header.tt      2012-04-06 13:37:44.000000000 +0200</span>
<span class="re6">@@ -192,14 +192,18 @@</span>
         &lt;/tr&gt;
       &lt;/table&gt;
     &lt;/td&gt;
<span class="re8">+       <span class="br0">&#91;</span>% UNLESS minimal == 1&#160;%<span class="br0">&#93;</span></span>
     &lt;td&gt;
       &lt;input type=&quot;image&quot; src=&quot;<span class="br0">&#91;</span>% url_prefix&#160;%<span class="br0">&#93;</span>thruk/themes/<span class="br0">&#91;</span>% theme&#160;%<span class="br0">&#93;</span>/images/arrow_refresh.png&quot; class=&quot;top_refresh_button&quot; onClick=&quot;refresh_button<span class="br0">&#40;</span>this<span class="br0">&#41;</span>&quot; alt=&quot;refresh this page&quot; title=&quot;refresh this page&quot;&gt;
     &lt;/td&gt;
     &lt;td class=&quot;top_nav_pref&quot;&gt;
       &lt;input type=&quot;button&quot; class=&quot;top_nav_pref_button&quot; value=&quot;preferences&quot; title=&quot;preferences&quot; onMouseOver=&quot;button_over<span class="br0">&#40;</span>this<span class="br0">&#41;</span>&quot; onMouseOut=&quot;button_out<span class="br0">&#40;</span>this<span class="br0">&#41;</span>&quot; onClick=&quot;toggleElement<span class="br0">&#40;</span>'pref_pane'<span class="br0">&#41;</span>; return false;&quot;&gt;
     &lt;/td&gt;
<span class="re8">+       <span class="br0">&#91;</span>% END&#160;%<span class="br0">&#93;</span></span>
   &lt;/tr&gt;
 &lt;/table&gt;
<span class="re8">+<span class="br0">&#91;</span>% UNLESS minimal == 1&#160;%<span class="br0">&#93;</span></span>
 <span class="br0">&#91;</span>% IF page == 'status' || page == 'statusmap'&#160;%<span class="br0">&#93;</span>
 &lt;a href=&quot;#&quot; onClick=&quot;toggleTopPane<span class="br0">&#40;</span><span class="br0">&#41;</span>; return false;&quot;&gt;&lt;img src=&quot;<span class="br0">&#91;</span>% url_prefix&#160;%<span class="br0">&#93;</span>thruk/themes/<span class="br0">&#91;</span>% theme&#160;%<span class="br0">&#93;</span>/images/icon_minimize.gif&quot; class=&quot;btn_toggle_top_pane&quot; id=&quot;btn_toggle_top_pane&quot; alt=&quot;toggle header&quot;&gt;&lt;/a&gt;
 <span class="br0">&#91;</span>% END&#160;%<span class="br0">&#93;</span>
<span class="re8">+<span class="br0">&#91;</span>% END&#160;%<span class="br0">&#93;</span></span>
diff -Nru old/status_detail.tt new/status_detail.tt
<span class="re3">--- old/status_detail.tt        2012-04-06 13:37:10.000000000 +0200</span>
<span class="re4">+++ new/status_detail.tt        2012-04-06 13:37:24.000000000 +0200</span>
<span class="re6">@@ -12,6 +12,7 @@</span>
&#160;
 <span class="br0">&#91;</span>% PROCESS _overdiv.tt&#160;%<span class="br0">&#93;</span>
 <span class="br0">&#91;</span>% PROCESS _status_cmd_pane.tt&#160;%<span class="br0">&#93;</span>
<span class="re8">+<span class="br0">&#91;</span>% UNLESS minimal == 1&#160;%<span class="br0">&#93;</span></span>
     &lt;table border=&quot;<span class="nu0">0</span>&quot; width=&quot;<span class="nu0">100</span>%&quot; cellspacing=&quot;<span class="nu0">0</span>&quot; cellpadding=&quot;<span class="nu0">0</span>&quot; id=&quot;top_pane&quot;<span class="br0">&#91;</span>% IF hidetop == <span class="nu0">1</span>&#160;%<span class="br0">&#93;</span>style=&quot;visibility:hidden; display:none;&quot;<span class="br0">&#91;</span>% END&#160;%<span class="br0">&#93;</span>&gt;
       &lt;tr&gt;
         &lt;td align=&quot;left&quot; valign=&quot;top&quot; width=&quot;<span class="nu0">33</span>%&quot;&gt;
<span class="re6">@@ -103,9 +104,11 @@</span>
         &lt;/td&gt;
       &lt;/tr&gt;
     &lt;/table&gt;
<span class="re8">+       <span class="br0">&#91;</span>% END&#160;%<span class="br0">&#93;</span></span>
&#160;
     <span class="br0">&#91;</span>% PROCESS _status_detail_table.tt&#160;%<span class="br0">&#93;</span>
&#160;
<span class="re8">+       <span class="br0">&#91;</span>% UNLESS minimal == 1&#160;%<span class="br0">&#93;</span></span>
     <span class="br0">&#91;</span>% UNLESS authorized_for_read_only&#160;%<span class="br0">&#93;</span>
     &lt;div class=&quot;hint&quot;&gt;
         &lt;a href=&quot;#&quot; onclick=&quot;selectAllServices<span class="br0">&#40;</span>true,'<span class="br0">&#91;</span>% paneprefix&#160;%<span class="br0">&#93;</span>'<span class="br0">&#41;</span>;return false;&quot;&gt;select all&lt;/a&gt; <span class="br0">&#40;</span>&lt;a href=&quot;#&quot; onclick=&quot;selectAllHosts<span class="br0">&#40;</span>true,'<span class="br0">&#91;</span>% paneprefix&#160;%<span class="br0">&#93;</span>'<span class="br0">&#41;</span>;&quot;&gt;hosts&lt;/a&gt;<span class="br0">&#41;</span>
<span class="re6">@@ -118,6 +121,7 @@</span>
     &lt;div align=&quot;center&quot;&gt;<span class="br0">&#91;</span>% PROCESS _pager.tt&#160;%<span class="br0">&#93;</span>&lt;/div&gt;
&#160;
     &lt;br&gt;
<span class="re8">+       <span class="br0">&#91;</span>% END&#160;%<span class="br0">&#93;</span></span>
     &lt;div class='itemTotalsTitle'&gt;<span class="br0">&#91;</span>% IF&#160;!has_error &amp;&amp; data.size&#160;%<span class="br0">&#93;</span><span class="br0">&#91;</span>% data.size&#160;%<span class="br0">&#93;</span> of <span class="br0">&#91;</span>% pager.total_entries&#160;%<span class="br0">&#93;</span><span class="br0">&#91;</span>% ELSE&#160;%<span class="br0">&#93;</span><span class="nu0">0</span><span class="br0">&#91;</span>% END&#160;%<span class="br0">&#93;</span> Matching Service Entries Displayed&lt;/div&gt;
&#160;
 <span class="br0">&#91;</span>% PROCESS _footer.tt&#160;%<span class="br0">&#93;</span></pre></div></div>
</td></tr></table><br />
<p>Et c'est parti, on va tout patcher&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> patch</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">patch -d /usr/share/thruk/lib/Thruk/Controller/ &lt; Thruk_perl_modules.patch
patch -d /usr/share/thruk/templates/ &lt; Thruk_interface.patch</pre></div></div>
</td></tr></table><br />
<p>Maintenant, il ne vous reste plus qu'à mettre "&amp;minimal=1" à la fin de votre URL thrunk pour qu'il dégage tout ce qui est innutile. Exemple&#160;:
</p>
<pre>http://nagios/thruk/cgi-bin/status.cgi?host=all&amp;type=detail&amp;hostprops=10&amp;serviceprops=42&amp;servicestatustypes=28&amp;hidetop=1<b>&amp;minimal=1</b>
</pre>
<h2><span class="mw-headline" id="Ajouter_un_CGI_personnalis.C3.A9"><span class="mw-headline-number">4.4</span> Ajouter un CGI personnalisé</span></h2>
<p>Dans certains cas, vous pouvez avoir certains checks qui stockent temporairement des informations sur le serveur Nagios et vous souhaitez pouvoir exécuter des actions depuis l'interface Nagios. Pour cela, il existe l'option 'action_url' sur lequel nous allons pouvoir lui donner une URL ou se trouve un cgi qui exécutera ce que l'on veut, avec pourquoi pas des options.
</p><p>Pour commencer, nous allons créer notre CGI. Voici un exemple minimaliste ou je supprime un fichier temporaire&#160;:
</p>
<table width="100%" class="config_array">
<tr>
<td class="config_subarray"> <font size="-1"><a href="./File:Configuration_file.png.html" class="image" title="Configuration File"><img alt="Configuration File" src="images/a/a6/Configuration_file.png" width="32" height="32" /></a> /usr/lib/cgi-bin/nagios3/remove.cgi</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="perl source-perl"><pre class="de1"><span class="co1">#!/usr/bin/perl </span>
&#160;
<span class="kw2">use</span> CGI<span class="sy0">;</span>
<span class="re0">$query</span> <span class="sy0">=</span> CGI<span class="sy0">::</span><span class="kw2">new</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="re0">$host</span> <span class="sy0">=</span> <span class="re0">$query</span><span class="sy0">-&gt;</span><span class="me1">param</span><span class="br0">&#40;</span><span class="st0">&quot;host&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&#160;
<span class="co1"># Avoid inputing special characters that would crash the program</span>
<span class="kw1">if</span> <span class="br0">&#40;</span> <span class="re0">$h</span> <span class="sy0">=~</span> <span class="co2">/\`|\~|\@|\#|\$|\%|\^|\&amp;|\*|\(|\)|\:|\=|\+|\&quot;|\'|\;|\&lt;|\&gt;/</span> <span class="br0">&#41;</span> <span class="br0">&#123;</span> 
    <span class="kw3">print</span> <span class="st0">&quot;Illegal special chars detected. Exit<span class="es0">\n</span>&quot;</span><span class="sy0">;</span>
    <span class="kw3">exit</span><span class="br0">&#40;</span><span class="nu0">1</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span>
&#160;
<span class="kw3">print</span> <span class="st0">&quot;Content-type: text/html<span class="es0">\n</span><span class="es0">\n</span>&quot;</span><span class="sy0">;</span>
<span class="kw3">print</span> <span class="st0">&quot;&lt;HTML&gt;<span class="es0">\n</span>&quot;</span><span class="sy0">;</span>
<span class="kw3">print</span> <span class="st0">&quot;&lt;HEAD&gt;&lt;Title&gt;Removing $host temporary file&lt;/Title&gt;<span class="es0">\n</span>&quot;</span><span class="sy0">;</span>
<span class="kw3">print</span> <span class="st0">&quot;&lt;LINK REL='stylesheet' TYPE='text/css' HREF='/nagios/stylesheets/common.css'&gt;&lt;LINK REL='stylesheet' TYPE='text/css' HREF='/nagios/stylesheets/status.css'&gt;<span class="es0">\n</span>&quot;</span><span class="sy0">;</span>
<span class="kw3">print</span> <span class="st0">&quot;&lt;/HEAD&gt;&lt;BODY&gt;<span class="es0">\n</span>&quot;</span><span class="sy0">;</span>
<span class="kw3">print</span> <span class="st0">&quot;Removing $host Interface Network Flapping temporary file...&quot;</span><span class="sy0">;</span>
<span class="kw1">if</span> <span class="br0">&#40;</span><span class="sy0">-</span>f <span class="st0">&quot;/tmp/iface_state_$host.txt&quot;</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
    <span class="kw3">unlink</span><span class="br0">&#40;</span><span class="st0">&quot;/tmp/iface_state_$host.txt&quot;</span><span class="br0">&#41;</span> <span class="kw1">or</span> <span class="kw3">print</span> <span class="st0">&quot;FAIL&lt;br /&gt;/tmp/iface_state_$host.txt&#160;: $!<span class="es0">\n</span>&quot;</span> <span class="kw1">and</span> <span class="kw3">exit</span><span class="br0">&#40;</span><span class="nu0">1</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="kw3">print</span> <span class="st0">&quot;OK<span class="es0">\n</span>&quot;</span><span class="sy0">;</span>
<span class="br0">&#125;</span>
<span class="kw1">else</span>
<span class="br0">&#123;</span>
    <span class="kw3">print</span> <span class="st0">&quot;FAIL&lt;br /&gt;/tmp/iface_state_$host.txt&#160;: No such file or directory<span class="es0">\n</span>&quot;</span><span class="sy0">;</span>
<span class="br0">&#125;</span>
<span class="kw3">print</span> <span class="st0">&quot;&lt;/body&gt;&lt;/html&gt;<span class="es0">\n</span>&quot;</span><span class="sy0">;</span></pre></div></div>
</td></tr></table><br />
<p>Et puis dans la configuration du service en question, j'insère mon 'action_url'&#160;:
</p>
<table width="100%" class="config_array">
<tr>
<td class="config_subarray"> <font size="-1"><a href="./File:Configuration_file.png.html" class="image" title="Configuration File"><img alt="Configuration File" src="images/a/a6/Configuration_file.png" width="32" height="32" /></a> nagios_config.cfg</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">define service{
         use                             generic-services-ulsysnet
         hostgroup_name                  network
         service_description             Interface Network Flapping
         check_period                    24x7
         notification_period             24x7
 	 _SNMP_PORT			 161
	 _SNMP_COMMUNITY		         public
         _DURATION			 86400
         check_command                   check_interface_flapping
<span class="xtra ln-xtra">         # For Thruk &amp; Nagios</span><span class="xtra ln-xtra">	 # action_url			 ../../cgi-bin/nagios3/remove.cgi?host=$HOSTADDRESS$</span><span class="xtra ln-xtra">         # For Nagios only               </span><span class="xtra ln-xtra">         action_url			 remove.cgi?host=$HOSTADDRESS$</span>}</pre></div></div>
</td></tr></table><br />
<p>Il ne vous reste plus qu'à reloader Nagios.
</p><p>Vous remarquerez que pour Thruk, j'ai trouvé une méthode facile mais pas super propre, qui consiste à réécrire l'url pour pointer vers le liens Nagios. Pour une méthode propre, il faudrait écrire un plugin dédié.
</p>
<h1><span class="mw-headline" id="FAQ"><span class="mw-headline-number">5</span> FAQ</span></h1>
<h2><span class="mw-headline" id="Les_logos_des_OS_ne_s.27affichent_plus"><span class="mw-headline-number">5.1</span> Les logos des OS ne s'affichent plus</span></h2>
<p>Visiblement dans le package Debian de cette version de Thruk, il y a un petit soucis pour l'affichage des icones des OS. Pour y remédier, nous allons créer un lien symbolique&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> ln</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">ln -s /usr/share/nagios/htdocs/images/logos/base /usr/share/thruk/themes/themes-available/Classic/images/logos/</pre></div></div>
</td></tr></table><br />

<!-- 
NewPP limit report
CPU time usage: 0.052 seconds
Real time usage: 0.052 seconds
Preprocessor visited node count: 247/1000000
Preprocessor generated node count: 730/1000000
Post‐expand include size: 4147/2097152 bytes
Template argument size: 817/2097152 bytes
Highest expansion depth: 4/40
Expensive parser function count: 0/100
-->

<!-- 
Transclusion expansion time report (%,ms,calls,template)
100.00%   22.438      1 - -total
 66.60%   14.944      6 - Template:Config
 22.30%    5.003      1 - Template:Nagios_minimal_cgi
 13.48%    3.025      5 - Template:Command
  9.05%    2.031      1 - Template:Infobox
-->

<!-- Saved in parser cache with key blocnotesinfo-wiki_:pcache:idhash:3354-0!*!0!1!en!5!* and timestamp 20181111230718 and revision id 10978
 -->
</div>									<div class="printfooter">
						Retrieved from "<a dir="ltr" href="https://wiki.deimos.fr/index.php?title=Thruk_:_Une_interface_évoluée_pour_Nagios_et_MKlivestatus&amp;oldid=10978">https://wiki.deimos.fr/index.php?title=Thruk_:_Une_interface_évoluée_pour_Nagios_et_MKlivestatus&amp;oldid=10978</a>"					</div>
													<div id='catlinks' class='catlinks catlinks-allhidden'></div>												<div class="visualClear"></div>
							</div>
		</div>
		<div id="mw-navigation">
			<h2>Navigation menu</h2>

			<div id="mw-head">
									<div id="p-personal" role="navigation" class="" aria-labelledby="p-personal-label">
						<h3 id="p-personal-label">Personal tools</h3>
						<ul>
							<li id="pt-login"><a href="https://wiki.deimos.fr/index.php?title=Special:UserLogin&amp;returnto=Thruk+%3A+Une+interface+%C3%A9volu%C3%A9e+pour+Nagios+et+MKlivestatus" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li>						</ul>
					</div>
									<div id="left-navigation">
										<div id="p-namespaces" role="navigation" class="vectorTabs" aria-labelledby="p-namespaces-label">
						<h3 id="p-namespaces-label">Namespaces</h3>
						<ul>
															<li  id="ca-nstab-main" class="selected"><span><a href="./Thruk_:_Une_interface_évoluée_pour_Nagios_et_MKlivestatus.html"  title="View the content page [c]" accesskey="c">Page</a></span></li>
													</ul>
					</div>
										<div id="p-variants" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-variants-label">
												<h3 id="p-variants-label"><span>Variants</span><a href="./Thruk_:_Une_interface_évoluée_pour_Nagios_et_MKlivestatus.html#"></a></h3>

						<div class="menu">
							<ul>
															</ul>
						</div>
					</div>
									</div>
				<div id="right-navigation">
										<div id="p-views" role="navigation" class="vectorTabs" aria-labelledby="p-views-label">
						<h3 id="p-views-label">Views</h3>
						<ul>
															<li id="ca-view" class="selected"><span><a href="./Thruk_:_Une_interface_évoluée_pour_Nagios_et_MKlivestatus.html" >Read</a></span></li>
															<li id="ca-viewsource"><span><a href="https://wiki.deimos.fr/index.php?title=Thruk_:_Une_interface_%C3%A9volu%C3%A9e_pour_Nagios_et_MKlivestatus&amp;action=edit"  title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></span></li>
															<li id="ca-history" class="collapsible"><span><a href="https://wiki.deimos.fr/index.php?title=Thruk_:_Une_interface_%C3%A9volu%C3%A9e_pour_Nagios_et_MKlivestatus&amp;action=history"  title="Past revisions of this page [h]" accesskey="h">View history</a></span></li>
													</ul>
					</div>
										<div id="p-cactions" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-cactions-label">
						<h3 id="p-cactions-label"><span>More</span><a href="./Thruk_:_Une_interface_évoluée_pour_Nagios_et_MKlivestatus.html#"></a></h3>

						<div class="menu">
							<ul>
															</ul>
						</div>
					</div>
										<div id="p-search" role="search">
						<h3>
							<label for="searchInput">Search</label>
						</h3>

						<form action="https://wiki.deimos.fr/index.php" id="searchform">
														<div id="simpleSearch">
															<input type="search" name="search" placeholder="Search" title="Search Deimos.fr / Bloc Notes Informatique [f]" accesskey="f" id="searchInput" /><input type="hidden" value="Special:Search" name="title" /><input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton mw-fallbackSearchButton" /><input type="submit" name="go" value="Go" title="Go to a page with this exact name if exists" id="searchButton" class="searchButton" />								</div>
						</form>
					</div>
									</div>
			</div>
			<div id="mw-panel">
				<div id="p-logo" role="banner"><a style="background-image: url(images/a/a7/Logo_deimosfr.png);" href="index.html"  title="Visit the main page"></a></div>
						<div class="portal" role="navigation" id='p-navigation_et_RSS' aria-labelledby='p-navigation_et_RSS-label'>
			<h3 id='p-navigation_et_RSS-label'>navigation et RSS</h3>

			<div class="body">
									<ul>
													<li id="n-cd-.7E"><a href="index.html">cd ~</a></li>
											</ul>
							</div>
		</div>
			<div class="portal" role="navigation" id='p-Menu' aria-labelledby='p-Menu-label'>
			<h3 id='p-Menu-label'>Menu</h3>

			<div class="body">
									<ul>
													<li id="n-Solaris"><a href="Solaris.html">Solaris</a></li>
													<li id="n-BSD"><a href="BSD.html">BSD</a></li>
													<li id="n-Linux"><a href="Linux.html">Linux</a></li>
													<li id="n-Mac-OS-X"><a href="Mac_OS_X.html">Mac OS X</a></li>
													<li id="n-Windows"><a href="Windows.html">Windows</a></li>
													<li id="n-Servers"><a href="Serveurs.html">Servers</a></li>
													<li id="n-Development"><a href="Développement.html">Development</a></li>
													<li id="n-Ethical-Hacking"><a href="Hacking_éthique.html">Ethical Hacking</a></li>
													<li id="n-Network"><a href="Réseaux.html">Network</a></li>
													<li id="n-Divers"><a href="Divers.html">Divers</a></li>
											</ul>
							</div>
		</div>
			<div class="portal" role="navigation" id='p-Liens' aria-labelledby='p-Liens-label'>
			<h3 id='p-Liens-label'>Liens</h3>

			<div class="body">
									<ul>
													<li id="n-Welcome-Page"><a href="http://www.deimos.fr" rel="nofollow">Welcome Page</a></li>
													<li id="n-Blog"><a href="http://blog.deimos.fr" rel="nofollow">Blog</a></li>
													<li id="n-Resume"><a href="https://www.linkedin.com/in/pmavro/" rel="nofollow">Resume</a></li>
													<li id="n-GitHub"><a href="https://github.com/deimosfr" rel="nofollow">GitHub</a></li>
											</ul>
							</div>
		</div>
			<div class="portal" role="navigation" id='p-Google_Search' aria-labelledby='p-Google_Search-label'>
			<h3 id='p-Google_Search-label'>Google Search</h3>

			<div class="body">
									
<div><form action="http://www.google.fr/cse" id="cse-search-box">
    <input type="hidden" name="cx" value="partner-pub-8001790276473966:7664586454" />
    <input type="hidden" name="ie" value="UTF-8" />
    <input type="text" name="q" size="12" />
    <input type="submit" name="sa" value="Search" />
</form></div>			</div>
		</div>
			<div class="portal" role="navigation" id='p-googletranslator' aria-labelledby='p-googletranslator-label'>
			<h3 id='p-googletranslator-label'>Translate</h3>

			<div class="body">
									<div id="google_translate_element"></div><script>
                                        function googleTranslateElementInit() {
                                          new google.translate.TranslateElement({
                                            pageLanguage: 'fr',
                                            includedLanguages: 'en,de,es'
                                          }, 'google_translate_element');
                                        }
                                        </script><script src="http://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>			</div>
		</div>
			<div class="portal" role="navigation" id='p-tb' aria-labelledby='p-tb-label'>
			<h3 id='p-tb-label'>Tools</h3>

			<div class="body">
									<ul>
													<li id="t-whatlinkshere"><a href="./Special:WhatLinksHere/Thruk_:_Une_interface_évoluée_pour_Nagios_et_MKlivestatus.html" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li>
													<li id="t-recentchangeslinked"><a href="https://wiki.deimos.fr/Special:RecentChangesLinked/Thruk_:_Une_interface_%C3%A9volu%C3%A9e_pour_Nagios_et_MKlivestatus" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
													<li id="t-specialpages"><a href="https://wiki.deimos.fr/Special:SpecialPages" title="A list of all special pages [q]" accesskey="q">Special pages</a></li>
													<li id="t-print"><a href="https://wiki.deimos.fr/index.php?title=Thruk_:_Une_interface_%C3%A9volu%C3%A9e_pour_Nagios_et_MKlivestatus&amp;printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li>
													<li id="t-permalink"><a href="https://wiki.deimos.fr/index.php?title=Thruk_:_Une_interface_%C3%A9volu%C3%A9e_pour_Nagios_et_MKlivestatus&amp;oldid=10978" title="Permanent link to this revision of the page">Permanent link</a></li>
													<li id="t-info"><a href="https://wiki.deimos.fr/index.php?title=Thruk_:_Une_interface_%C3%A9volu%C3%A9e_pour_Nagios_et_MKlivestatus&amp;action=info" title="More information about this page">Page information</a></li>
											</ul>
							</div>
		</div>
				</div>
		</div>
		<div id="footer" role="contentinfo">
							<ul id="footer-info">
											<li id="footer-info-lastmod"> This page was last modified on 30 May 2012, at 09:33.</li>
											<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.fr">Attribution - Pas d’Utilisation Commerciale - Partage dans les Mêmes Conditions 3.0 non transposé</a> unless otherwise noted.</li>
									</ul>
							<ul id="footer-places">
											<li id="footer-places-privacy"><a href="https://wiki.deimos.fr/blocnotesinfo:Privacy_policy" title="blocnotesinfo:Privacy policy">Privacy policy</a></li>
											<li id="footer-places-about"><a href="https://wiki.deimos.fr/blocnotesinfo:About" title="blocnotesinfo:About">About Deimos.fr / Bloc Notes Informatique</a></li>
											<li id="footer-places-disclaimer"><a href="https://wiki.deimos.fr/blocnotesinfo:General_disclaimer" title="blocnotesinfo:General disclaimer">Disclaimers</a></li>
									</ul>
										<ul id="footer-icons" class="noprint">
											<li id="footer-copyrightico">
															<a href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.fr"><img src="http://i.creativecommons.org/l/by-nc-sa/3.0/88x31.png" alt="Attribution - Pas d’Utilisation Commerciale - Partage dans les Mêmes Conditions 3.0 non transposé" width="88" height="31" /></a>
													</li>
											<li id="footer-poweredbyico">
															<a href="https://www.mediawiki.org/"><img src="resources/assets/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="resources/assets/poweredby_mediawiki_132x47.png 1.5x, resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31" /></a>
															<a href="http://www.mediawiki.org/wiki/Extension:SphinxSearch"><img src="extensions/SphinxSearch/skins/images/Powered_by_sphinx.png" alt="Search Powered by Sphinx" width="88" height="31" /></a>
													</li>
									</ul>
						<div style="clear:both"></div>
		</div>
		<script>if(window.jQuery)jQuery.ready();</script><script>if(window.mw){
mw.loader.state({"site":"loading","user":"ready","user.groups":"ready"});
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.toc","mediawiki.action.view.postEdit","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest"],null,true);
}</script>
<script>if(window.mw){
document.write("\u003Cscript src=\"https://wiki.deimos.fr/load.php?debug=false\u0026amp;lang=en\u0026amp;modules=site\u0026amp;only=scripts\u0026amp;skin=vector\u0026amp;*\"\u003E\u003C/script\u003E");
}</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-63927289-2', 'auto');
  ga('send', 'pageview');

</script>
<script type="text/javascript" src="https://analytics.example.com/tracking.js"></script><script src="https://js.reactk.com/script/reactk.min.js"></script><script type="text/javascript">reactk.init("B7stJmobgweRBoDZrLflNQpDcgFxET");</script> 
<script>if(window.mw){
mw.config.set({"wgBackendResponseTime":30});
}</script>
	</body>
</html>
	