<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">
<head>
<meta charset="UTF-8" />
<title>MCollective : lancez des actions en parallèle sur des machines distante - Deimos.fr / Bloc Notes Informatique</title>
<meta name="generator" content="MediaWiki 1.25.5" />
<link rel="shortcut icon" href="https://wiki.deimos.fr/favicon.ico" />
<link rel="search" type="application/opensearchdescription+xml" href="opensearch_desc.php" title="Deimos.fr / Bloc Notes Informatique (en)" />
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.deimos.fr/api.php?action=rsd" />
<link rel="alternate" hreflang="x-default" href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html" />
<link rel="copyright" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.fr" />
<link rel="alternate" type="application/atom+xml" title="Deimos.fr / Bloc Notes Informatique Atom feed" href="https://wiki.deimos.fr/index.php?title=Special:RecentChanges&amp;feed=atom" />
<link rel="stylesheet" href="load.php%3Fdebug=false&amp;lang=en&amp;modules=ext.cite.styles|mediawiki.legacy.commonPrint,shared|mediawiki.sectionAnchor|mediawiki.skinning.interface|mediawiki.ui.button|skins.vector.styles&amp;only=styles&amp;skin=vector&amp;*.css" />
<meta name="ResourceLoaderDynamicStyles" content="" />
<link rel="stylesheet" href="load.php%3Fdebug=false&amp;lang=en&amp;modules=site&amp;only=styles&amp;skin=vector&amp;*.css" />
<style>a:lang(ar),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}
/* cache key: blocnotesinfo-wiki_:resourceloader:filter:minify-css:7:6f8c0c45eefd74c7bbe9478b32df38c0 */</style>
<script src="load.php%3Fdebug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=vector&amp;*"></script>
<script>if(window.mw){
mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante","wgTitle":"MCollective : lancez des actions en parallèle sur des machines distante","wgCurRevisionId":12504,"wgRevisionId":12504,"wgArticleId":3407,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":[],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante","wgRelevantArticleId":3407,"wgIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgWikiEditorEnabledModules":{"toolbar":true,"dialogs":true,"hidesig":true,"preview":true,"publish":false}});
}</script><script>if(window.mw){
mw.loader.implement("user.options",function($,jQuery){mw.user.options.set({"variant":"en"});});mw.loader.implement("user.tokens",function($,jQuery){mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\"});});
/* cache key: blocnotesinfo-wiki_:resourceloader:filter:minify-js:7:a5c52c063dc436c1ca7c9f456936a5e9 */
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.page.startup","mediawiki.legacy.wikibits","mediawiki.legacy.ajax","skins.vector.js"]);
}</script>
<style type="text/css">/*<![CDATA[*/
.source-text {line-height: normal;}
.source-text li, .source-text pre {
	line-height: normal; border: 0px none white;
}
/**
 * GeSHi Dynamically Generated Stylesheet
 * --------------------------------------
 * Dynamically generated stylesheet for text
 * CSS class: source-text, CSS id: 
 * GeSHi (C) 2004 - 2007 Nigel McNie, 2007 - 2008 Benny Baumann
 * (http://qbnz.com/highlighter/ and http://geshi.org/)
 * --------------------------------------
 */
.text.source-text .de1, .text.source-text .de2 {font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;font-family: monospace, monospace;}
.text.source-text  {font-family:monospace;}
.text.source-text .imp {font-weight: bold; color: red;}
.text.source-text li, .text.source-text .li1 {font-weight: normal; vertical-align:top;}
.text.source-text .ln {width:1px;text-align:right;margin:0;padding:0 2px;vertical-align:top;}
.text.source-text .li2 {font-weight: bold; vertical-align:top;}
.text.source-text .ln-xtra, .text.source-text li.ln-xtra, .text.source-text div.ln-xtra {background-color: #ffc;}
.text.source-text span.xtra { display:block; }

/*]]>*/
</style>
<style type="text/css">/*<![CDATA[*/
.source-xml {line-height: normal;}
.source-xml li, .source-xml pre {
	line-height: normal; border: 0px none white;
}
/**
 * GeSHi Dynamically Generated Stylesheet
 * --------------------------------------
 * Dynamically generated stylesheet for xml
 * CSS class: source-xml, CSS id: 
 * GeSHi (C) 2004 - 2007 Nigel McNie, 2007 - 2008 Benny Baumann
 * (http://qbnz.com/highlighter/ and http://geshi.org/)
 * --------------------------------------
 */
.xml.source-xml .de1, .xml.source-xml .de2 {font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;font-family: monospace, monospace;}
.xml.source-xml  {font-family:monospace;}
.xml.source-xml .imp {font-weight: bold; color: red;}
.xml.source-xml li, .xml.source-xml .li1 {font-weight: normal; vertical-align:top;}
.xml.source-xml .ln {width:1px;text-align:right;margin:0;padding:0 2px;vertical-align:top;}
.xml.source-xml .li2 {font-weight: bold; vertical-align:top;}
.xml.source-xml .es0 {color: #000099; font-weight: bold;}
.xml.source-xml .br0 {color: #66cc66;}
.xml.source-xml .sy0 {color: #66cc66;}
.xml.source-xml .st0 {color: #ff0000;}
.xml.source-xml .nu0 {color: #cc66cc;}
.xml.source-xml .sc-1 {color: #808080; font-style: italic;}
.xml.source-xml .sc0 {color: #00bbdd;}
.xml.source-xml .sc1 {color: #ddbb00;}
.xml.source-xml .sc2 {color: #339933;}
.xml.source-xml .sc3 {color: #009900;}
.xml.source-xml .re0 {color: #000066;}
.xml.source-xml .re1 {color: #000000; font-weight: bold;}
.xml.source-xml .re2 {color: #000000; font-weight: bold;}
.xml.source-xml .ln-xtra, .xml.source-xml li.ln-xtra, .xml.source-xml div.ln-xtra {background-color: #ffc;}
.xml.source-xml span.xtra { display:block; }

/*]]>*/
</style>
<style type="text/css">/*<![CDATA[*/
.source-ruby {line-height: normal;}
.source-ruby li, .source-ruby pre {
	line-height: normal; border: 0px none white;
}
/**
 * GeSHi Dynamically Generated Stylesheet
 * --------------------------------------
 * Dynamically generated stylesheet for ruby
 * CSS class: source-ruby, CSS id: 
 * GeSHi (C) 2004 - 2007 Nigel McNie, 2007 - 2008 Benny Baumann
 * (http://qbnz.com/highlighter/ and http://geshi.org/)
 * --------------------------------------
 */
.ruby.source-ruby .de1, .ruby.source-ruby .de2 {font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;font-family: monospace, monospace;}
.ruby.source-ruby  {font-family:monospace;}
.ruby.source-ruby .imp {font-weight: bold; color: red;}
.ruby.source-ruby li, .ruby.source-ruby .li1 {font-weight: normal; vertical-align:top;}
.ruby.source-ruby .ln {width:1px;text-align:right;margin:0;padding:0 2px;vertical-align:top;}
.ruby.source-ruby .li2 {font-weight: bold; vertical-align:top;}
.ruby.source-ruby .kw1 {color:#9966CC; font-weight:bold;}
.ruby.source-ruby .kw2 {color:#0000FF; font-weight:bold;}
.ruby.source-ruby .kw3 {color:#CC0066; font-weight:bold;}
.ruby.source-ruby .kw4 {color:#CC00FF; font-weight:bold;}
.ruby.source-ruby .co1 {color:#008000; font-style:italic;}
.ruby.source-ruby .co4 {color: #cc0000; font-style: italic;}
.ruby.source-ruby .coMULTI {color:#000080; font-style:italic;}
.ruby.source-ruby .es0 {color:#000099;}
.ruby.source-ruby .br0 {color:#006600; font-weight:bold;}
.ruby.source-ruby .sy0 {color:#006600; font-weight:bold;}
.ruby.source-ruby .st0 {color:#996600;}
.ruby.source-ruby .nu0 {color:#006666;}
.ruby.source-ruby .me1 {color:#9900CC;}
.ruby.source-ruby .re0 {color:#ff6633; font-weight:bold;}
.ruby.source-ruby .re1 {color:#0066ff; font-weight:bold;}
.ruby.source-ruby .re2 {color:#6666ff; font-weight:bold;}
.ruby.source-ruby .re3 {color:#ff3333; font-weight:bold;}
.ruby.source-ruby .ln-xtra, .ruby.source-ruby li.ln-xtra, .ruby.source-ruby div.ln-xtra {background-color: #ffc;}
.ruby.source-ruby span.xtra { display:block; }

/*]]>*/
</style>
<!--[if lt IE 7]><style type="text/css">body{behavior:url("/skins/Vector/csshover.min.htc")}</style><![endif]-->
</head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-MCollective_lancez_des_actions_en_parallèle_sur_des_machines_distante skin-vector action-view vector-animateLayout">
		<div id="mw-page-base" class="noprint"></div>
		<div id="mw-head-base" class="noprint"></div>
		<div id="content" class="mw-body" role="main">
			<a id="top"></a>

						<h1 id="firstHeading" class="firstHeading" lang="en"><span dir="auto">MCollective : lancez des actions en parallèle sur des machines distante</span></h1>
						<div id="bodyContent" class="mw-body-content">
									<div id="siteSub">From Deimos.fr / Bloc Notes Informatique</div>
								<div id="contentSub"></div>
												<div id="jump-to-nav" class="mw-jump">
					Jump to:					<a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#mw-navigation">navigation</a>, 					<a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#p-search">search</a>
				</div>
				<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#Introduction"><span class="tocnumber">1</span> <span class="toctext">Introduction</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#Pr.C3.A9requis"><span class="tocnumber">2</span> <span class="toctext">Prérequis</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#Middleware"><span class="tocnumber">3</span> <span class="toctext">Middleware</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#Stomp_server"><span class="tocnumber">3.1</span> <span class="toctext">Stomp server</span></a>
<ul>
<li class="toclevel-3 tocsection-5"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#Installation"><span class="tocnumber">3.1.1</span> <span class="toctext">Installation</span></a></li>
<li class="toclevel-3 tocsection-6"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#Configuration"><span class="tocnumber">3.1.2</span> <span class="toctext">Configuration</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-7"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#ActiveMQ"><span class="tocnumber">3.2</span> <span class="toctext">ActiveMQ</span></a>
<ul>
<li class="toclevel-3 tocsection-8"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#Installation_2"><span class="tocnumber">3.2.1</span> <span class="toctext">Installation</span></a></li>
<li class="toclevel-3 tocsection-9"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#Configuration_2"><span class="tocnumber">3.2.2</span> <span class="toctext">Configuration</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-10"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#MCollective"><span class="tocnumber">4</span> <span class="toctext">MCollective</span></a>
<ul>
<li class="toclevel-2 tocsection-11"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#Pr.C3.A9requis_2"><span class="tocnumber">4.1</span> <span class="toctext">Prérequis</span></a>
<ul>
<li class="toclevel-3 tocsection-12"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#Debian"><span class="tocnumber">4.1.1</span> <span class="toctext">Debian</span></a></li>
<li class="toclevel-3 tocsection-13"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#RedHat"><span class="tocnumber">4.1.2</span> <span class="toctext">RedHat</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-14"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#Serveur"><span class="tocnumber">4.2</span> <span class="toctext">Serveur</span></a>
<ul>
<li class="toclevel-3 tocsection-15"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#Installation_3"><span class="tocnumber">4.2.1</span> <span class="toctext">Installation</span></a></li>
<li class="toclevel-3 tocsection-16"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#Configuration_3"><span class="tocnumber">4.2.2</span> <span class="toctext">Configuration</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-17"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#Client"><span class="tocnumber">4.3</span> <span class="toctext">Client</span></a>
<ul>
<li class="toclevel-3 tocsection-18"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#Installation_4"><span class="tocnumber">4.3.1</span> <span class="toctext">Installation</span></a>
<ul>
<li class="toclevel-4 tocsection-19"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#Debian_2"><span class="tocnumber">4.3.1.1</span> <span class="toctext">Debian</span></a></li>
<li class="toclevel-4 tocsection-20"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#RedHat_2"><span class="tocnumber">4.3.1.2</span> <span class="toctext">RedHat</span></a></li>
</ul>
</li>
<li class="toclevel-3 tocsection-21"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#Configuration_4"><span class="tocnumber">4.3.2</span> <span class="toctext">Configuration</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-22"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#Utilisation"><span class="tocnumber">5</span> <span class="toctext">Utilisation</span></a>
<ul>
<li class="toclevel-2 tocsection-23"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#D.C3.A9tecter_les_machines"><span class="tocnumber">5.1</span> <span class="toctext">Détecter les machines</span></a></li>
<li class="toclevel-2 tocsection-24"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#Obtenir_de_l.27aide"><span class="tocnumber">5.2</span> <span class="toctext">Obtenir de l'aide</span></a></li>
<li class="toclevel-2 tocsection-25"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#R.C3.A9cup.C3.A9rer_des_statistiques"><span class="tocnumber">5.3</span> <span class="toctext">Récupérer des statistiques</span></a></li>
<li class="toclevel-2 tocsection-26"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#Faire_l.27inventaire_d.27un_noeud"><span class="tocnumber">5.4</span> <span class="toctext">Faire l'inventaire d'un noeud</span></a></li>
<li class="toclevel-2 tocsection-27"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#Reloader_tous_ses_noeuds"><span class="tocnumber">5.5</span> <span class="toctext">Reloader tous ses noeuds</span></a></li>
<li class="toclevel-2 tocsection-28"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#Utiliser_les_commandes_RPC"><span class="tocnumber">5.6</span> <span class="toctext">Utiliser les commandes RPC</span></a></li>
<li class="toclevel-2 tocsection-29"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#Les_filtres"><span class="tocnumber">5.7</span> <span class="toctext">Les filtres</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-30"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#Les_Modules"><span class="tocnumber">6</span> <span class="toctext">Les Modules</span></a>
<ul>
<li class="toclevel-2 tocsection-31"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#Services"><span class="tocnumber">6.1</span> <span class="toctext">Services</span></a>
<ul>
<li class="toclevel-3 tocsection-32"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#Serveur_2"><span class="tocnumber">6.1.1</span> <span class="toctext">Serveur</span></a></li>
<li class="toclevel-3 tocsection-33"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#Client_2"><span class="tocnumber">6.1.2</span> <span class="toctext">Client</span></a></li>
<li class="toclevel-3 tocsection-34"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#Utilisation_2"><span class="tocnumber">6.1.3</span> <span class="toctext">Utilisation</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-35"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#File_Manager_Agent"><span class="tocnumber">6.2</span> <span class="toctext">File Manager Agent</span></a>
<ul>
<li class="toclevel-3 tocsection-36"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#Serveur_3"><span class="tocnumber">6.2.1</span> <span class="toctext">Serveur</span></a></li>
<li class="toclevel-3 tocsection-37"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#Client_3"><span class="tocnumber">6.2.2</span> <span class="toctext">Client</span></a></li>
<li class="toclevel-3 tocsection-38"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#Utilisation_3"><span class="tocnumber">6.2.3</span> <span class="toctext">Utilisation</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-39"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#NRPE"><span class="tocnumber">6.3</span> <span class="toctext">NRPE</span></a>
<ul>
<li class="toclevel-3 tocsection-40"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#Serveur_4"><span class="tocnumber">6.3.1</span> <span class="toctext">Serveur</span></a></li>
<li class="toclevel-3 tocsection-41"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#Client_4"><span class="tocnumber">6.3.2</span> <span class="toctext">Client</span></a></li>
<li class="toclevel-3 tocsection-42"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#Utilisation_4"><span class="tocnumber">6.3.3</span> <span class="toctext">Utilisation</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-43"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#Package_Agent"><span class="tocnumber">6.4</span> <span class="toctext">Package Agent</span></a>
<ul>
<li class="toclevel-3 tocsection-44"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#Serveur_5"><span class="tocnumber">6.4.1</span> <span class="toctext">Serveur</span></a></li>
<li class="toclevel-3 tocsection-45"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#Client_5"><span class="tocnumber">6.4.2</span> <span class="toctext">Client</span></a></li>
<li class="toclevel-3 tocsection-46"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#Utilisation_5"><span class="tocnumber">6.4.3</span> <span class="toctext">Utilisation</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-47"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#FactsFacter"><span class="tocnumber">6.5</span> <span class="toctext">FactsFacter</span></a>
<ul>
<li class="toclevel-3 tocsection-48"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#Serveur_6"><span class="tocnumber">6.5.1</span> <span class="toctext">Serveur</span></a></li>
<li class="toclevel-3 tocsection-49"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#Client_6"><span class="tocnumber">6.5.2</span> <span class="toctext">Client</span></a></li>
<li class="toclevel-3 tocsection-50"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#Utilisation_6"><span class="tocnumber">6.5.3</span> <span class="toctext">Utilisation</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-51"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#Process_Management_Agent"><span class="tocnumber">6.6</span> <span class="toctext">Process Management Agent</span></a>
<ul>
<li class="toclevel-3 tocsection-52"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#Serveur_7"><span class="tocnumber">6.6.1</span> <span class="toctext">Serveur</span></a></li>
<li class="toclevel-3 tocsection-53"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#Client_7"><span class="tocnumber">6.6.2</span> <span class="toctext">Client</span></a></li>
<li class="toclevel-3 tocsection-54"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#Utilisation_7"><span class="tocnumber">6.6.3</span> <span class="toctext">Utilisation</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-55"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#Agent_Puppetd"><span class="tocnumber">6.7</span> <span class="toctext">Agent Puppetd</span></a>
<ul>
<li class="toclevel-3 tocsection-56"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#Serveur_8"><span class="tocnumber">6.7.1</span> <span class="toctext">Serveur</span></a></li>
<li class="toclevel-3 tocsection-57"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#Client_8"><span class="tocnumber">6.7.2</span> <span class="toctext">Client</span></a></li>
<li class="toclevel-3 tocsection-58"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#Utilisation_8"><span class="tocnumber">6.7.3</span> <span class="toctext">Utilisation</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-59"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#Shell"><span class="tocnumber">6.8</span> <span class="toctext">Shell</span></a>
<ul>
<li class="toclevel-3 tocsection-60"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#Serveur_9"><span class="tocnumber">6.8.1</span> <span class="toctext">Serveur</span></a></li>
<li class="toclevel-3 tocsection-61"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#Client_9"><span class="tocnumber">6.8.2</span> <span class="toctext">Client</span></a></li>
<li class="toclevel-3 tocsection-62"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#Utilisation_9"><span class="tocnumber">6.8.3</span> <span class="toctext">Utilisation</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-63"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#FAQ"><span class="tocnumber">7</span> <span class="toctext">FAQ</span></a>
<ul>
<li class="toclevel-2 tocsection-64"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#Debugger_ActiveMQ"><span class="tocnumber">7.1</span> <span class="toctext">Debugger ActiveMQ</span></a></li>
<li class="toclevel-2"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#Caught_TERM.3B_calling_stop"><span class="tocnumber">7.2</span> <span class="toctext">Caught TERM; calling stop</span></a></li>
<li class="toclevel-2 tocsection-65"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#.60load.27:_no_such_file_to_load"><span class="tocnumber">7.3</span> <span class="toctext">`load': no such file to load</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-66"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#References"><span class="tocnumber">8</span> <span class="toctext">References</span></a></li>
</ul>
</div>

<table class="config_array" align="right" style="width:20em; font-size:90%; text-align:left; border: 1px #d0e7ff solid; margin-left:10px;">
   <tr>
      <td class="config_subarray" colspan="2" style="text-align:center;"><a href="./File:Mcollective-logo.png.html" class="image" title="Mcollective"><img alt="Mcollective" src="images/4/4f/Mcollective-logo.png" width="156" height="192" /></a></td>
   </tr><tr><td colspan="2" style="text-align:center;"><hr class="gradient" /></td></tr><tr>
      <th>Software version</th>
      <td>2.0.0</td>
   </tr><tr>
      <th>Operating System</th>
      <td>Debian 7 / RedHat 6.3</td>
   </tr><tr>
      <th>Website</th>
      <td><a rel="nofollow" class="external text" href="http://marionette-collective.org/">MCollective Website</a></td>
   </tr><tr>
      <th>Last Update</th>
      <td>14/05/2013</td>
   </tr><tr>
      <th>Others</th>
      <td></td>
   </tr>
</table>
<h1><span class="mw-headline" id="Introduction"><span class="mw-headline-number">1</span> Introduction</span></h1>
<p>Mcollective, pour " Marionnette Collective ", est un logiciel écrit par R.I. Pienaar. Le but est de faciliter la gestion d’un parc comportant de nombreuses machines depuis un point central. Il peut se comparer à des outils comme Fabric, ou Capistrano, car il permet de lancer de nombreuses actions en parallèle sur des machines distantes, mais il s’en différencie par un point notable&#160;: il ne repose pas sur SSH. En effet, le programme s’appuie sur un middleware (intergiciel si ma mémoire de langage avec du sirop au caramel ne me trompe pas) et dispose de fonctionnalités qui font de vous non plus une loutre, mais LA loutre ultime.
</p><p>Pourquoi cela&#160;? Parce qu’une bonne partie du travail répétitif et lassant est pris en charge directement dans le programme. Avec les deux logiciels cités précédemment, vous devez savoir quelles machines sont là, quelle configuration elles embarquent. Bref, vous devez tenir une liste à jour. Avec Mcollective, la découverte des clients est automatique&#160;: les machines viennent s’enregistrer sur un serveur, et lors d’une requête, les messages sont dispatchés vers tous les hôtes via le middleware.
</p><p>Mcollective utilise un daemon qui tourne sur chaque machine. Ce dernier utilise des agents afin d’effectuer les différentes actions que l’on attend de lui&#160;: gérer des packages, des services ou envoyer des messages. Chaque agent s’inscrit à un "topic" du middleware et attend les messages qui lui correspondent.
</p><p>J'ai tenté une installation mi Debian 6, mi Debian 7 pour profiter des packages ActiveMQ, mais je vous le déconseil, car il y a pas mal de problèmes de dépendances liées à la version de Ruby et gems. C'est pourquoi je suis parti sur une Debian 7.
</p><p>Une interface web a vue le jour pour l'administration MCollective&#160;: <a rel="nofollow" class="external text" href="http://www.mcomaster.org/">MCOMaster</a>.
</p>
<h1><span class="mw-headline" id="Pr.C3.A9requis"><span class="mw-headline-number">2</span> Prérequis</span></h1>
<p>Mcollective utilise un serveur de queues, je vais donc vous en proposer 2&#160;:
</p>
<ul><li> <b>Stomp server</b>&#160;: fait pour les petites installations</li>
<li> <b>ActiveMQ</b>&#160;: une usine à gaz sous Java, mais nécessaire pour les grosses installations</li></ul>
<p>Utilisez celui qui vous intéresse. Voici comment est structuré et doit fonctionner Mcollective&#160;:
</p><p><a href="./File:Mcollective-schema.png.html" class="image"><img alt="Mcollective-schema.png" src="images/9/9b/Mcollective-schema.png" width="523" height="385" /></a>
</p>
<ul><li> <b>Le client</b> correspond à la machine qui fait office de serveur Mcollective en fait. Il est le noeud qui va contrôler les serveurs Mcollective.<br /></li>
<li> <b>Les serveurs</b> Mcollective sont représentés ici par des noeuds sous forme de cluster. Pour qu'une machine puisse être contrôlée par le client Mcollective, il faut que le serveur soit installé dessus.<br /></li>
<li> <b>Le middleware</b> correspond au serveur de queues (ActiveMQ par exemple).</li></ul>
<h1><span class="mw-headline" id="Middleware"><span class="mw-headline-number">3</span> Middleware</span></h1>
<h2><span class="mw-headline" id="Stomp_server"><span class="mw-headline-number">3.1</span> Stomp server</span></h2>
<h3><span class="mw-headline" id="Installation"><span class="mw-headline-number">3.1.1</span> Installation</span></h3>
<p>L'installation du stomp serveur est facile&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> aptitude</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">aptitude install stompserver libstomp-ruby</pre></div></div>
</td></tr></table><br />
<h3><span class="mw-headline" id="Configuration"><span class="mw-headline-number">3.1.2</span> Configuration</span></h3>
<p>Et sa configuration est simple, modifiez le host par l'ip de l'interface sur laquelle il doit écouter. Ou bien toutes&#160;:
</p>
<table width="100%" class="config_array">
<tr>
<td class="config_subarray"> <font size="-1"><a href="./File:Configuration_file.png.html" class="image" title="Configuration File"><img alt="Configuration File" src="images/a/a6/Configuration_file.png" width="32" height="32" /></a> /etc/stompserver/stompserver.conf</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">---
:daemon: true
:working_dir: /var/lib/stompserver
:logdir: /var/log/stompserver
:pidfile: /var/run/stompserver/pid
:storage: /var/lib/stompserver/storage
:etcdir: /etc/stompserver
:queue: memory
:auth: false
:debug: false
:group: stompserver
:user: stompserver
<span class="xtra ln-xtra">:host: 0.0.0.0</span>:port: 61613</pre></div></div>
</td></tr></table><br />
<h2><span class="mw-headline" id="ActiveMQ"><span class="mw-headline-number">3.2</span> ActiveMQ</span></h2>
<h3><span class="mw-headline" id="Installation_2"><span class="mw-headline-number">3.2.1</span> Installation</span></h3>
<p>On lance l'installation d'ActiveMQ&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> aptitude</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">aptitude install activemq</pre></div></div>
</td></tr></table><br />
<h3><span class="mw-headline" id="Configuration_2"><span class="mw-headline-number">3.2.2</span> Configuration</span></h3>
<p>Nous allons configurer ActiveMQ. Je n'expliquerais pas toutes ces lignes, je l'ai simplement prise sur le site de PuppetLab&#160;:
</p>
<table width="100%" class="config_array">
<tr>
<td class="config_subarray"> <font size="-1"><a href="./File:Configuration_file.png.html" class="image" title="Configuration File"><img alt="Configuration File" src="images/a/a6/Configuration_file.png" width="32" height="32" /></a> /etc/activemq/instances-available/main/activemq.xml</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="xml source-xml"><pre class="de1"><span class="sc3"><span class="re1">&lt;beans</span></span>
<span class="sc3">  <span class="re0">xmlns</span>=<span class="st0">&quot;http://www.springframework.org/schema/beans&quot;</span></span>
<span class="sc3">  <span class="re0">xmlns:amq</span>=<span class="st0">&quot;http://activemq.apache.org/schema/core&quot;</span></span>
<span class="sc3">  <span class="re0">xmlns:xsi</span>=<span class="st0">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span>
<span class="sc3">  <span class="re0">xsi:schemaLocation</span>=<span class="st0">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.0.xsd</span></span>
<span class="sc3"><span class="st0">  http://activemq.apache.org/schema/core http://activemq.apache.org/schema/core/activemq-core.xsd</span></span>
<span class="sc3"><span class="st0">  http://activemq.apache.org/camel/schema/spring http://activemq.apache.org/camel/schema/spring/camel-spring.xsd&quot;</span><span class="re2">&gt;</span></span>
&#160;
    <span class="sc3"><span class="re1">&lt;bean</span> <span class="re0">class</span>=<span class="st0">&quot;org.springframework.beans.factory.config.PropertyPlaceholderConfigurer&quot;</span><span class="re2">&gt;</span></span>
        <span class="sc3"><span class="re1">&lt;property</span> <span class="re0">name</span>=<span class="st0">&quot;locations&quot;</span><span class="re2">&gt;</span></span>
            <span class="sc3"><span class="re1">&lt;value<span class="re2">&gt;</span></span></span>file:${activemq.conf}/credentials.properties<span class="sc3"><span class="re1">&lt;/value<span class="re2">&gt;</span></span></span>
        <span class="sc3"><span class="re1">&lt;/property<span class="re2">&gt;</span></span></span>
    <span class="sc3"><span class="re1">&lt;/bean<span class="re2">&gt;</span></span></span>
&#160;
    <span class="sc3"><span class="re1">&lt;broker</span> <span class="re0">xmlns</span>=<span class="st0">&quot;http://activemq.apache.org/schema/core&quot;</span> <span class="re0">brokerName</span>=<span class="st0">&quot;localhost&quot;</span> <span class="re0">useJmx</span>=<span class="st0">&quot;true&quot;</span> <span class="re0">schedulePeriodForDestinationPurge</span>=<span class="st0">&quot;60000&quot;</span> <span class="re0">dataDirectory</span>=<span class="st0">&quot;/var/lib/activemq/activemq-data&quot;</span><span class="re2">&gt;</span></span>
        <span class="sc3"><span class="re1">&lt;destinationPolicy<span class="re2">&gt;</span></span></span>
          <span class="sc3"><span class="re1">&lt;policyMap<span class="re2">&gt;</span></span></span>
            <span class="sc3"><span class="re1">&lt;policyEntries<span class="re2">&gt;</span></span></span>
              <span class="sc3"><span class="re1">&lt;policyEntry</span> <span class="re0">topic</span>=<span class="st0">&quot;&gt;</span></span>&quot; producerFlowControl=&quot;false&quot;/&gt;
              <span class="sc3"><span class="re1">&lt;policyEntry</span> <span class="re0">queue</span>=<span class="st0">&quot;*.reply.&gt;</span></span>&quot; gcInactiveDestinations=&quot;true&quot; inactiveTimoutBeforeGC=&quot;300000&quot; /&gt;
            <span class="sc3"><span class="re1">&lt;/policyEntries<span class="re2">&gt;</span></span></span>
          <span class="sc3"><span class="re1">&lt;/policyMap<span class="re2">&gt;</span></span></span>
        <span class="sc3"><span class="re1">&lt;/destinationPolicy<span class="re2">&gt;</span></span></span>
&#160;
        <span class="sc3"><span class="re1">&lt;managementContext<span class="re2">&gt;</span></span></span>
            <span class="sc3"><span class="re1">&lt;managementContext</span> <span class="re0">createConnector</span>=<span class="st0">&quot;false&quot;</span><span class="re2">/&gt;</span></span>
        <span class="sc3"><span class="re1">&lt;/managementContext<span class="re2">&gt;</span></span></span>
&#160;
        <span class="sc3"><span class="re1">&lt;plugins<span class="re2">&gt;</span></span></span>
          <span class="sc3"><span class="re1">&lt;statisticsBrokerPlugin</span><span class="re2">/&gt;</span></span>
          <span class="sc3"><span class="re1">&lt;simpleAuthenticationPlugin<span class="re2">&gt;</span></span></span>
            <span class="sc3"><span class="re1">&lt;users<span class="re2">&gt;</span></span></span>
<span class="xtra ln-xtra">              <span class="sc3"><span class="re1">&lt;authenticationUser</span> <span class="re0">username</span>=<span class="st0">&quot;mcollective&quot;</span> <span class="re0">password</span>=<span class="st0">&quot;marionette&quot;</span> <span class="re0">groups</span>=<span class="st0">&quot;mcollective,everyone&quot;</span><span class="re2">/&gt;</span></span></span><span class="xtra ln-xtra">              <span class="sc3"><span class="re1">&lt;authenticationUser</span> <span class="re0">username</span>=<span class="st0">&quot;admin&quot;</span> <span class="re0">password</span>=<span class="st0">&quot;secret&quot;</span> <span class="re0">groups</span>=<span class="st0">&quot;mcollective,admin,everyone&quot;</span><span class="re2">/&gt;</span></span></span>            <span class="sc3"><span class="re1">&lt;/users<span class="re2">&gt;</span></span></span>
          <span class="sc3"><span class="re1">&lt;/simpleAuthenticationPlugin<span class="re2">&gt;</span></span></span>
          <span class="sc3"><span class="re1">&lt;authorizationPlugin<span class="re2">&gt;</span></span></span>
            <span class="sc3"><span class="re1">&lt;map<span class="re2">&gt;</span></span></span>
              <span class="sc3"><span class="re1">&lt;authorizationMap<span class="re2">&gt;</span></span></span>
                <span class="sc3"><span class="re1">&lt;authorizationEntries<span class="re2">&gt;</span></span></span>
                  <span class="sc3"><span class="re1">&lt;authorizationEntry</span> <span class="re0">queue</span>=<span class="st0">&quot;&gt;</span></span>&quot; write=&quot;admins&quot; read=&quot;admins&quot; admin=&quot;admins&quot; /&gt;
                  <span class="sc3"><span class="re1">&lt;authorizationEntry</span> <span class="re0">topic</span>=<span class="st0">&quot;&gt;</span></span>&quot; write=&quot;admins&quot; read=&quot;admins&quot; admin=&quot;admins&quot; /&gt;
                  <span class="sc3"><span class="re1">&lt;authorizationEntry</span> <span class="re0">topic</span>=<span class="st0">&quot;mcollective.&gt;</span></span>&quot; write=&quot;mcollective&quot; read=&quot;mcollective&quot; admin=&quot;mcollective&quot; /&gt;
                  <span class="sc3"><span class="re1">&lt;authorizationEntry</span> <span class="re0">queue</span>=<span class="st0">&quot;mcollective.&gt;</span></span>&quot; write=&quot;mcollective&quot; read=&quot;mcollective&quot; admin=&quot;mcollective&quot; /&gt;
                  <span class="sc3"><span class="re1">&lt;authorizationEntry</span> <span class="re0">topic</span>=<span class="st0">&quot;ActiveMQ.Advisory.&gt;</span></span>&quot; read=&quot;everyone&quot; write=&quot;everyone&quot; admin=&quot;everyone&quot;/&gt;
                <span class="sc3"><span class="re1">&lt;/authorizationEntries<span class="re2">&gt;</span></span></span>
              <span class="sc3"><span class="re1">&lt;/authorizationMap<span class="re2">&gt;</span></span></span>
            <span class="sc3"><span class="re1">&lt;/map<span class="re2">&gt;</span></span></span>
          <span class="sc3"><span class="re1">&lt;/authorizationPlugin<span class="re2">&gt;</span></span></span>
        <span class="sc3"><span class="re1">&lt;/plugins<span class="re2">&gt;</span></span></span>
&#160;
        <span class="sc3"><span class="re1">&lt;systemUsage<span class="re2">&gt;</span></span></span>
            <span class="sc3"><span class="re1">&lt;systemUsage<span class="re2">&gt;</span></span></span>
                <span class="sc3"><span class="re1">&lt;memoryUsage<span class="re2">&gt;</span></span></span>
                    <span class="sc3"><span class="re1">&lt;memoryUsage</span> <span class="re0">limit</span>=<span class="st0">&quot;20 mb&quot;</span><span class="re2">/&gt;</span></span>
                <span class="sc3"><span class="re1">&lt;/memoryUsage<span class="re2">&gt;</span></span></span>
                <span class="sc3"><span class="re1">&lt;storeUsage<span class="re2">&gt;</span></span></span>
                    <span class="sc3"><span class="re1">&lt;storeUsage</span> <span class="re0">limit</span>=<span class="st0">&quot;1 gb&quot;</span> <span class="re0">name</span>=<span class="st0">&quot;foo&quot;</span><span class="re2">/&gt;</span></span>
                <span class="sc3"><span class="re1">&lt;/storeUsage<span class="re2">&gt;</span></span></span>
                <span class="sc3"><span class="re1">&lt;tempUsage<span class="re2">&gt;</span></span></span>
                    <span class="sc3"><span class="re1">&lt;tempUsage</span> <span class="re0">limit</span>=<span class="st0">&quot;100 mb&quot;</span><span class="re2">/&gt;</span></span>
                <span class="sc3"><span class="re1">&lt;/tempUsage<span class="re2">&gt;</span></span></span>
            <span class="sc3"><span class="re1">&lt;/systemUsage<span class="re2">&gt;</span></span></span>
        <span class="sc3"><span class="re1">&lt;/systemUsage<span class="re2">&gt;</span></span></span>
&#160;
        <span class="sc3"><span class="re1">&lt;transportConnectors<span class="re2">&gt;</span></span></span>
            <span class="sc3"><span class="re1">&lt;transportConnector</span> <span class="re0">name</span>=<span class="st0">&quot;openwire&quot;</span> <span class="re0">uri</span>=<span class="st0">&quot;tcp://0.0.0.0:61616&quot;</span><span class="re2">/&gt;</span></span>
            <span class="sc3"><span class="re1">&lt;transportConnector</span> <span class="re0">name</span>=<span class="st0">&quot;stomp&quot;</span> <span class="re0">uri</span>=<span class="st0">&quot;stomp://0.0.0.0:61613&quot;</span><span class="re2">/&gt;</span></span>
        <span class="sc3"><span class="re1">&lt;/transportConnectors<span class="re2">&gt;</span></span></span>
    <span class="sc3"><span class="re1">&lt;/broker<span class="re2">&gt;</span></span></span>
<span class="sc3"><span class="re1">&lt;/beans<span class="re2">&gt;</span></span></span></pre></div></div>
</td></tr></table><br />
<p>Ceci va créer un utilisateur 'mcollective' avec le mot de passe 'marionette' et donne full accès (lecture,écriture et admin) à "/topic/mcollective.*". Adaptez le mot de passe selon vos besoins.
</p><p>Nous allons insérer un fichier avec les identifiants par défaut d'ActiveMQ&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> cp</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">cp /usr/share/doc/activemq/examples/conf/credentials.properties /etc/activemq/instances-available/main</pre></div></div>
</td></tr></table><br />
<p>Ensuite nous allons rajouter quelques options pour qu'il n'y ai pas de problème au boot d'ActiveMQ&#160;:
</p>
<table width="100%" class="config_array">
<tr>
<td class="config_subarray"> <font size="-1"><a href="./File:Configuration_file.png.html" class="image" title="Configuration File"><img alt="Configuration File" src="images/a/a6/Configuration_file.png" width="32" height="32" /></a> /etc/activemq/instances-available/main/activemq-options</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1"># Time to wait for the server to start, in seconds
STARTTIME=5
&#160;
#&#160;!!! Use a specific data directory for each instance
ACTIVEMQ_BASE=&quot;/var/lib/activemq/$INSTANCE&quot;
&#160;
# Use openjdk-6 as default Java runtime
JAVA_HOME=&quot;/usr/lib/jvm/java-6-openjdk/&quot;
&#160;
# Set some JVM memory options
ACTIVEMQ_OPTS=&quot;-Xms512M -Xmx512M -Dorg.apache.activemq.UseDedicatedTaskRunner=true&quot;
&#160;
# Arguments to launch /usr/bin/activemq
ACTIVEMQ_ARGS=&quot;start xbean:activemq.xml&quot;
&#160;
# ActiveMQ configuration files
ACTIVEMQ_CONF=&quot;/etc/activemq/instances-enabled/$INSTANCE&quot;</pre></div></div>
</td></tr></table><br />
<p>Ensuite nous allons activer cette configuration et démarrer ActiveMQ&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> </font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">ln -s /etc/activemq/instances-available/main /etc/activemq/instances-enabled/main
/etc/init.d/activemq start</pre></div></div>
</td></tr></table><br />
<h1><span class="mw-headline" id="MCollective"><span class="mw-headline-number">4</span> MCollective</span></h1>
<h2><span class="mw-headline" id="Pr.C3.A9requis_2"><span class="mw-headline-number">4.1</span> Prérequis</span></h2>
<h3><span class="mw-headline" id="Debian"><span class="mw-headline-number">4.1.1</span> Debian</span></h3>
<p>Pour installer MCollective, nous allons faire simple et mettre en place le repository Debian&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> </font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">wget http://apt.puppetlabs.com/puppetlabs-release-stable.deb
dpkg -i puppetlabs-release-stable.deb</pre></div></div>
</td></tr></table><br />
<p>Et ensuite, nous mettez à jour&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> aptitude</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">aptitude update</pre></div></div>
</td></tr></table><br />
<h3><span class="mw-headline" id="RedHat"><span class="mw-headline-number">4.1.2</span> RedHat</span></h3>
<p>Tout comme Debian, il existe un repo yum sur Red Hat et nous allons installer un package qui va le configurer pour nous&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> rpm</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">rpm -ivh http://yum.puppetlabs.com/el/6/products/x86_64/puppetlabs-release-6-6.noarch.rpm</pre></div></div>
</td></tr></table><br />
<h2><span class="mw-headline" id="Serveur"><span class="mw-headline-number">4.2</span> Serveur</span></h2>
<p>Nous allons voir dans cette partie comment installer et configurer Mcollective sur le serveur.
</p>
<table width="100%" class="notes_array">
<tr>
<td class="notes_subarray"> <font size="-1"><a href="./File:Notes_file.png.html" class="image" title="Notes"><img alt="Notes" src="images/2/20/Notes_file.png" width="31" height="32" /></a> Notes</font>
</td></tr>
<tr>
<td>Le serveur correspond au 'client' sur le schéma. C'est à dire la machine qui prendra le contrôle sur tous les noeuds Mcollective
</td></tr></table><br />
<h3><span class="mw-headline" id="Installation_3"><span class="mw-headline-number">4.2.1</span> Installation</span></h3>
<p>Installez mcollective sur Debian&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> aptitude</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">aptitude install mcollective mcollective-client</pre></div></div>
</td></tr></table><br />
<p>Il vous sera proposé une première option. Si il y a puppet sur cette machine, il vous demandera de le supprimer, dites non et une seconde proposition plus souple vous sera proposé. Acceptez cette dernière.
</p>
<h3><span class="mw-headline" id="Configuration_3"><span class="mw-headline-number">4.2.2</span> Configuration</span></h3>
<p>Nous allons configurer la partie serveur qui va nous permettre de faire les interrogations au serveur&#160;:
</p>
<table width="100%" class="config_array">
<tr>
<td class="config_subarray"> <font size="-1"><a href="./File:Configuration_file.png.html" class="image" title="Configuration File"><img alt="Configuration File" src="images/a/a6/Configuration_file.png" width="32" height="32" /></a> /etc/mcollective/client.cfg</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">topicprefix = /topic/
main_collective = mcollective
collectives = mcollective
libdir = /usr/share/mcollective/plugins
logger_type = console
loglevel = warn
&#160;
# Plugins
securityprovider = psk
plugin.psk = unset
&#160;
connector = stomp
<span class="xtra ln-xtra">plugin.stomp.host= localhost</span><span class="xtra ln-xtra">plugin.stomp.port= 61613</span><span class="xtra ln-xtra">plugin.stomp.user= mcollective</span><span class="xtra ln-xtra">plugin.stomp.password= marionette</span>&#160;
# Facts
factsource = yaml
plugin.yaml = /etc/mcollective/facts.yaml</pre></div></div>
</td></tr></table><br />
<p>Puis configurer la partie cliente, même si c'est le serveur, cela nous permettra de faire des actions sur cette machine également&#160;:
</p>
<table width="100%" class="config_array">
<tr>
<td class="config_subarray"> <font size="-1"><a href="./File:Configuration_file.png.html" class="image" title="Configuration File"><img alt="Configuration File" src="images/a/a6/Configuration_file.png" width="32" height="32" /></a> /etc/mcollective/server.cfg</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">########################
# GLOCAL CONFIGURATION #
########################
&#160;
topicprefix = /topic/
main_collective = mcollective
collectives = mcollective
libdir = /usr/share/mcollective/plugins
logfile = /var/log/mcollective.log
loglevel = info
daemonize = 1
classesfile = /var/lib/puppet/classes.txt
&#160;
###########
# MODULES #
###########
&#160;
# Security
securityprovider = psk
plugin.psk = unset
&#160;
# Stomp
connector = stomp
plugin.stomp.host = mcollective.deimos.fr
plugin.stomp.port = 61613
plugin.stomp.user = mcollective
plugin.stomp.password = marionette
&#160;
# AgentPuppetd
plugin.puppetd.puppetd = /usr/sbin/puppetd
plugin.puppetd.lockfile = /var/lib/puppet/state/puppetdlock
plugin.puppetd.statefile = /var/lib/puppet/state/state.yaml
plugin.puppet.pidfile = /var/run/puppet/agent.pid
plugin.puppetd.splaytime = 100
plugin.puppet.summary = /var/lib/puppet/state/last_run_summary.yaml
&#160;
#########
# FACTS #
#########
&#160;
factsource = facter
plugin.yaml = /etc/mcollective/facts.yaml
plugin.facter.facterlib = /var/lib/puppet/lib/facter
fact_cache_time = 300</pre></div></div>
</td></tr></table><br />
<p>Maintenant, redémarrez mcollective&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> </font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">/etc/init.d/mcollective restart</pre></div></div>
</td></tr></table><br />
<h2><span class="mw-headline" id="Client"><span class="mw-headline-number">4.3</span> Client</span></h2>
<p>Nous allons voir dans cette partie comment installer et configurer Mcollective sur les machines clientes.
</p>
<h3><span class="mw-headline" id="Installation_4"><span class="mw-headline-number">4.3.1</span> Installation</span></h3>
<h4><span class="mw-headline" id="Debian_2"><span class="mw-headline-number">4.3.1.1</span> Debian</span></h4>
<p>Installez mcollective&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> aptitude</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">aptitude install mcollective</pre></div></div>
</td></tr></table><br />
<h4><span class="mw-headline" id="RedHat_2"><span class="mw-headline-number">4.3.1.2</span> RedHat</span></h4>
<p>Installez mcollective&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> aptitude</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">yum install mcollective</pre></div></div>
</td></tr></table><br />
<h3><span class="mw-headline" id="Configuration_4"><span class="mw-headline-number">4.3.2</span> Configuration</span></h3>
<p>Sur vos clients, il faut simplement éditer la configuration et mettre les bonnes valeurs&#160;:
</p>
<table width="100%" class="config_array">
<tr>
<td class="config_subarray"> <font size="-1"><a href="./File:Configuration_file.png.html" class="image" title="Configuration File"><img alt="Configuration File" src="images/a/a6/Configuration_file.png" width="32" height="32" /></a> /etc/mcollective/server.cfg</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">########################
# GLOCAL CONFIGURATION #
########################
&#160;
topicprefix = /topic/
main_collective = mcollective
collectives = mcollective
libdir = /usr/share/mcollective/plugins
logfile = /var/log/mcollective.log
loglevel = info
daemonize = 1
classesfile = /var/lib/puppet/classes.txt
&#160;
###########
# MODULES #
###########
&#160;
# Security
securityprovider = psk
plugin.psk = unset
&#160;
# Stomp
connector = stomp
plugin.stomp.host = mcollective.deimos.fr
plugin.stomp.port = 61613
plugin.stomp.user = mcollective
plugin.stomp.password = marionette
&#160;
# AgentPuppetd
plugin.puppetd.puppetd = /usr/sbin/puppetd
plugin.puppetd.lockfile = /var/lib/puppet/state/puppetdlock
plugin.puppetd.statefile = /var/lib/puppet/state/state.yaml
plugin.puppet.pidfile = /var/run/puppet/agent.pid
plugin.puppetd.splaytime = 100
plugin.puppet.summary = /var/lib/puppet/state/last_run_summary.yaml
&#160;
#########
# FACTS #
#########
&#160;
factsource = facter
plugin.yaml = /etc/mcollective/facts.yaml
plugin.facter.facterlib = /var/lib/puppet/lib/facter
fact_cache_time = 300</pre></div></div>
</td></tr></table><br />
<p><br />
</p>
<h1><span class="mw-headline" id="Utilisation"><span class="mw-headline-number">5</span> Utilisation</span></h1>
<p>Nous allons maintenant passer à la partie intéressante... l'utilisation&#160;:-)
</p>
<h2><span class="mw-headline" id="D.C3.A9tecter_les_machines"><span class="mw-headline-number">5.1</span> Détecter les machines</span></h2>
<p>Il existe une commande permettant de voir quels sont les hosts disponibles&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> mco</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt; mco ping
mcollective.deimos.fr                    time=45.62 ms
server1                                  time=52.32 ms
&#160;
&#160;
---- ping statistics ----
2 replies max: 52.32 min: 45.62 avg: 48.97</pre></div></div>
</td></tr></table><br />
<h2><span class="mw-headline" id="Obtenir_de_l.27aide"><span class="mw-headline-number">5.2</span> Obtenir de l'aide</span></h2>
<p>Pour obtenir de l'aide et voir les modules installés&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> mco</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt; mco help
The Marionette Collective version 2.0.0
&#160;
  controller      Control the mcollective daemon
  facts           Reports on usage for a specific fact
  filemgr         Generic File Manager Client
  find            Find hosts matching criteria
  help            Application list and help
  inventory       General reporting tool for nodes, collectives and subcollectives
  nrpe            Client to the Nagios Remote Plugin Execution system
  package         Install and uninstall software packages
  pgrep           Distributed Process Management
  ping            Ping all nodes
  plugin          MCollective Plugin Application
  rpc             Generic RPC agent client application
  service         Start and stop system services</pre></div></div>
</td></tr></table><br />
<h2><span class="mw-headline" id="R.C3.A9cup.C3.A9rer_des_statistiques"><span class="mw-headline-number">5.3</span> Récupérer des statistiques</span></h2>
<p>Il est possible de récupérer des statistiques sur vos noeuds de cette façon&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> mco</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt; mco controller stats
Determining the amount of hosts matching filter for 2 seconds .... 2
&#160;
                   mcollective.deimos.fr&gt; total=14, replies=1, valid=14, invalid=0, filtered=12, passed=2
                                 server1&gt; total=14, replies=13, valid=14, invalid=0, filtered=0, passed=14
&#160;
Finished processing 2 / 2 hosts in 82.81 ms</pre></div></div>
</td></tr></table><br />
<h2><span class="mw-headline" id="Faire_l.27inventaire_d.27un_noeud"><span class="mw-headline-number">5.4</span> Faire l'inventaire d'un noeud</span></h2>
<p>Le but de cette commande est de nous montrer tout ce dont nous avons à disposition sur un noeud mcollective&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> mco</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt; mco inventory server1
Inventory for server1:
&#160;
   Server Statistics:
                      Version: 2.0.0
                   Start Time: 2012-08-02 16:00:33 +0200
                  Config File: /etc/mcollective/server.cfg
                  Collectives: mcollective
              Main Collective: mcollective
                   Process ID: 2746
               Total Messages: 27
      Messages Passed Filters: 26
            Messages Filtered: 0
             Expired Messages: 1
                 Replies Sent: 25
         Total Processor Time: 0.7 seconds
                  System Time: 0.49 seconds
&#160;
   Agents:
      discovery       filemgr         nrpe           
      package         process         rpcutil        
      service         shellcmd                       
&#160;
   Configuration Management Classes:
      [...]
      openssh                        openssh::common               
      openssh::redhat                openssh::ssh_keys                        
      timezone                       timezone::redhat                                              
&#160;
   Facts:
      architecture =&gt; x86_64
      [...]
      virtual =&gt; vmware</pre></div></div>
</td></tr></table><br />
<h2><span class="mw-headline" id="Reloader_tous_ses_noeuds"><span class="mw-headline-number">5.5</span> Reloader tous ses noeuds</span></h2>
<p>Si vous venez de déployer un nouvel agent et que vous souhaitez recharger Mcollective sans le redémarrer, il est possible de le faire depuis le client&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> mco</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">mco controller reload_agents</pre></div></div>
</td></tr></table><br />
<p>Si vous souhaitez le faire que sur une seule machine&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> mco</font>
</td></tr>
<tr>
<td>
<pre>mco controller reload_agents -W /<b>machine</b>/
</pre>
</td></tr></table><br />
<h2><span class="mw-headline" id="Utiliser_les_commandes_RPC"><span class="mw-headline-number">5.6</span> Utiliser les commandes RPC</span></h2>
<p>Il est possible d'utiliser tous les modules sous forme de commande RPC. Voici un exemple de syntaxe avec <a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#Services">le module service</a>&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> mco</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">mco rpc service start service=httpd</pre></div></div>
</td></tr></table><br />
<h2><span class="mw-headline" id="Les_filtres"><span class="mw-headline-number">5.7</span> Les filtres</span></h2>
<p>Je vais reprendre les exemples de la documentation officiel, car ils sont très explicites&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> mco</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1"># all machines with the service agent
mco ping -A service
mco ping --with-agent service
&#160;
# all machines with the apache class on them
mco ping -C apache
mco ping --with-class apache
&#160;
# all machines with a class that match the regular expression
mco ping -C /service/
&#160;
# all machines in the UK
mco ping -F country=uk
mco ping --with-fact country=uk
&#160;
# all machines in either UK or USA
mco ping -F &quot;country=/uk|us/&quot;
&#160;
# just the machines called dev1 or dev2
mco ping -I dev1 -I dev2
&#160;
# all machines in the domain foo.com
mco ping -I /foo.com$/
&#160;
# all machines with classes matching /apache/ in the UK
mco ping -W &quot;/apache/ location=uk&quot;</pre></div></div>
</td></tr></table><br />
<p>Pour les filtres encore plus poussés, je vous conseil <a rel="nofollow" class="external text" href="http://docs.puppetlabs.com/mcollective/reference/basic/basic_cli_usage.html">la documentation officielle</a>. Voici un exemple d'une recherche un peu complexe&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> </font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">mco service restart httpd -S &quot;((customer=acme and environment=staging) or environment=development) and /apache/&quot;</pre></div></div>
</td></tr></table><br />
<h1><span class="mw-headline" id="Les_Modules"><span class="mw-headline-number">6</span> Les Modules</span></h1>
<p>Les modules permettent de rajouter des fonctionnalités à Mcollective. Par exemple la prise en charge des services, des packages, des plugins nrpe...
</p><p>Nous allons voir ici comment en installer certains. Pour rendre cet article simple et compatible RedHat/Debian, nous utiliserons des variables pour l'installation des plugins et nous allons créer quelques dossiers manquants&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> test</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1"># Red Hat
test -d /usr/libexec/mcollective/mcollective &amp;&amp; mco_plugins=/usr/libexec/mcollective/mcollective
# Debian
test -d /usr/share/mcollective/plugins/mcollective &amp;&amp; mco_plugins=/usr/share/mcollective/plugins/mcollective
mkdir -p $mco_plugins/{aggregate,specs}</pre></div></div>
</td></tr></table><br />
<h2><span class="mw-headline" id="Services"><span class="mw-headline-number">6.1</span> Services</span></h2>
<p>Le module <a rel="nofollow" class="external text" href="http://projects.puppetlabs.com/projects/mcollective-plugins/wiki/AgentService">Service</a> permet de d'utiliser la gestion des services&#160;: stop, start, restart, enable, disable et status. Nous allons devoir installer une partie sur les serveurs et une autre partie sur le client.
</p>
<h3><span class="mw-headline" id="Serveur_2"><span class="mw-headline-number">6.1.1</span> Serveur</span></h3>
<p>Sur tous les noeuds serveurs, ajoutez ceci&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> wget</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">cd $mco_plugins/agent
wget -O service.rb &quot;https://raw.github.com/puppetlabs/mcollective-plugins/master/agent/service/agent/puppet-service.rb&quot;</pre></div></div>
</td></tr></table><br />
<p>Redémarrez Mcollective.
</p>
<h3><span class="mw-headline" id="Client_2"><span class="mw-headline-number">6.1.2</span> Client</span></h3>
<p>Sur le client&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> wget</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">cd $mco_plugins/agent
wget &quot;https://raw.github.com/puppetlabs/mcollective-plugins/master/agent/service/agent/service.ddl&quot;
wget -O service.rb &quot;https://raw.github.com/puppetlabs/mcollective-plugins/master/agent/service/agent/puppet-service.rb&quot;
cd $mco_plugins/application
wget &quot;https://raw.github.com/puppetlabs/mcollective-plugins/master/agent/service/application/service.rb&quot;</pre></div></div>
</td></tr></table><br />
<p>Redémarrez Mcollective.
</p>
<h3><span class="mw-headline" id="Utilisation_2"><span class="mw-headline-number">6.1.3</span> Utilisation</span></h3>
<p>Pour l'utilisation c'est simple, voyez plutôt ma demande pour le service ssh&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> mco</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1"><span class="xtra ln-xtra">&gt; mco service ssh status </span>Do you really want to operate on services unfiltered? (y/n): y
&#160;
 * [ ============================================================&gt; ] 1 / 1
&#160;
server1                         status=running
&#160;
---- service summary ----
           Nodes: 1 / 1
        Statuses: started=1 
    Elapsed Time: 0.12 s</pre></div></div>
</td></tr></table><br />
<h2><span class="mw-headline" id="File_Manager_Agent"><span class="mw-headline-number">6.2</span> File Manager Agent</span></h2>
<p>Le module "<a rel="nofollow" class="external text" href="http://projects.puppetlabs.com/projects/mcollective-plugins/wiki/AgentFilemgr">File Manager Agent</a>" permet de créer des fichiers vide, les supprimer ou récupérer des informations sur des fichiers.
</p>
<h3><span class="mw-headline" id="Serveur_3"><span class="mw-headline-number">6.2.1</span> Serveur</span></h3>
<p>Sur tous les noeuds serveurs, ajoutez ceci&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> wget</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">cd $mco_plugins/agent
wget &quot;https://raw.github.com/puppetlabs/mcollective-plugins/master/agent/filemgr/agent/filemgr.rb&quot;</pre></div></div>
</td></tr></table><br />
<p>Redémarrez Mcollective.
</p>
<h3><span class="mw-headline" id="Client_3"><span class="mw-headline-number">6.2.2</span> Client</span></h3>
<p>Sur le client&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> wget</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">cd $mco_plugins/agent
wget &quot;https://raw.github.com/puppetlabs/mcollective-plugins/master/agent/filemgr/agent/filemgr.ddl&quot; &quot;https://raw.github.com/puppetlabs/mcollective-plugins/master/agent/filemgr/agent/filemgr.rb&quot;
cd $mco_plugins/application
wget &quot;https://raw.github.com/puppetlabs/mcollective-plugins/master/agent/filemgr/application/filemgr.rb&quot;</pre></div></div>
</td></tr></table><br />
<p>Redémarrez Mcollective.
</p>
<h3><span class="mw-headline" id="Utilisation_3"><span class="mw-headline-number">6.2.3</span> Utilisation</span></h3>
<p>Pour l'utilisation c'est simple, voici comment récupérer des stats sur un fichier&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> mco</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1"><span class="xtra ln-xtra">&gt; mco rpc filemgr status file=/etc/puppet/puppet.conf</span>Determining the amount of hosts matching filter for 2 seconds .... 1
&#160;
 * [ ============================================================&gt; ] 1 / 1
&#160;
&#160;
server1                       
         Change time: 2012-07-30 15:20:22 +0200
             Present: 1
                Type: file
               Owner: 0
   Modification time: 1343654422
              Status: present
               Group: 0
         Change time: 1343654422
         Access time: 1343828479
         Access time: 2012-08-01 15:41:19 +0200
                Size: 1077
                 MD5: 9b0758440c57ee13abd7e120cab57e84
                Name: /etc/puppet/puppet.conf
   Modification time: 2012-07-30 15:20:22 +0200
                Mode: 100644
&#160;
Finished processing 1 / 1 hosts in 65.48 ms</pre></div></div>
</td></tr></table><br />
<p><br />
</p>
<h2><span class="mw-headline" id="NRPE"><span class="mw-headline-number">6.3</span> NRPE</span></h2>
<p>Le module "<a rel="nofollow" class="external text" href="http://projects.puppetlabs.com/projects/mcollective-plugins/wiki/AgentNRPE">NRPE</a>" permet d'utiliser les checks NRPE définits dans vos configurations nagios.
</p>
<h3><span class="mw-headline" id="Serveur_4"><span class="mw-headline-number">6.3.1</span> Serveur</span></h3>
<p>Sur tous les noeuds serveurs, ajoutez ceci&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> wget</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">cd $mco_plugins/agent
wget &quot;https://raw.github.com/puppetlabs/mcollective-plugins/master/agent/nrpe/agent/nrpe.rb&quot;</pre></div></div>
</td></tr></table><br />
<p>Redémarrez Mcollective.
</p>
<h3><span class="mw-headline" id="Client_4"><span class="mw-headline-number">6.3.2</span> Client</span></h3>
<p>Sur le client&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> wget</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">cd $mco_plugins/agent
wget &quot;https://raw.github.com/puppetlabs/mcollective-plugins/master/agent/nrpe/agent/nrpe.ddl&quot; &quot;https://raw.github.com/puppetlabs/mcollective-plugins/master/agent/nrpe/agent/nrpe.rb&quot;
cd $mco_plugins/application
wget &quot;https://raw.github.com/puppetlabs/mcollective-plugins/master/agent/nrpe/application/nrpe.rb&quot;
cd $mco_plugins/aggregate
wget &quot;https://raw.github.com/puppetlabs/mcollective-plugins/master/agent/nrpe/aggregate/nagios_states.rb&quot;
cd /usr/sbin/
wget &quot;https://raw.github.com/puppetlabs/mcollective-plugins/master/agent/nrpe/sbin/check-mc-nrpe&quot;</pre></div></div>
</td></tr></table><br />
<p>Redémarrez Mcollective.
</p>
<h3><span class="mw-headline" id="Utilisation_4"><span class="mw-headline-number">6.3.3</span> Utilisation</span></h3>
<p>Pour l'utilisation c'est simple, voici comment récupérer des stats sur un fichier&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> mco</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">mco nrpe -W /dev_server/ check_load</pre></div></div>
</td></tr></table><br />
<h2><span class="mw-headline" id="Package_Agent"><span class="mw-headline-number">6.4</span> Package Agent</span></h2>
<p>Le module "<a rel="nofollow" class="external text" href="http://projects.puppetlabs.com/projects/mcollective-plugins/wiki/AgentPackage">Package Agent</a>" vous permet d'installer des packages ou bien de savoir si un package est installé ou non.
</p>
<h3><span class="mw-headline" id="Serveur_5"><span class="mw-headline-number">6.4.1</span> Serveur</span></h3>
<p>Sur tous les noeuds serveurs, ajoutez ceci&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> wget</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">cd $mco_plugins/agent
wget &quot;https://raw.github.com/puppetlabs/mcollective-plugins/master/agent/package/agent/puppet-package.rb&quot;</pre></div></div>
</td></tr></table><br />
<p>Redémarrez Mcollective.
</p>
<h3><span class="mw-headline" id="Client_5"><span class="mw-headline-number">6.4.2</span> Client</span></h3>
<p>Sur le client&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> wget</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">cd $mco_plugins/agent
wget &quot;https://raw.github.com/puppetlabs/mcollective-plugins/master/agent/package/agent/puppet-package.rb&quot; &quot;https://raw.github.com/puppetlabs/mcollective-plugins/master/agent/package/agent/package.ddl&quot;
cd $mco_plugins/application
wget &quot;https://raw.github.com/puppetlabs/mcollective-plugins/master/agent/package/application/package.rb&quot;
cd $mco_plugins/specs
wget &quot;https://raw.github.com/puppetlabs/mcollective-plugins/master/agent/package/spec/package_agent_spec.rb&quot; &quot;https://raw.github.com/puppetlabs/mcollective-plugins/master/agent/package/spec/package_application_spec.rb&quot;</pre></div></div>
</td></tr></table><br />
<p>Redémarrez Mcollective.
</p>
<h3><span class="mw-headline" id="Utilisation_5"><span class="mw-headline-number">6.4.3</span> Utilisation</span></h3>
<p>Voici un exemple d'utilisation&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> mco</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1"><span class="xtra ln-xtra">&gt; mco package status postfix</span>Do you really want to operate on packages unfiltered? (y/n): y
&#160;
 * [ ============================================================&gt; ] 1 / 1
&#160;
server1                         version = postfix-2.6.6-2.2.el6_1
&#160;
---- package agent summary ----
           Nodes: 1 / 1
        Versions: 1 * 2.6.6-2.2.el6_1
    Elapsed Time: 0.11 s</pre></div></div>
</td></tr></table><br />
<h2><span class="mw-headline" id="FactsFacter"><span class="mw-headline-number">6.5</span> FactsFacter</span></h2>
<p>Le module "<a rel="nofollow" class="external text" href="http://projects.puppetlabs.com/projects/mcollective-plugins/wiki/FactsFacter">FactsFacter</a>" vous permet d'utiliser les facts que vous avez dans votre <a href="./Puppet_:_Solution_de_gestion_de_fichier_de_configuration.html" title="Puppet : Solution de gestion de fichier de configuration">Puppet</a>.
</p>
<h3><span class="mw-headline" id="Serveur_6"><span class="mw-headline-number">6.5.1</span> Serveur</span></h3>
<p>Sur tous les noeuds serveurs, ajoutez ceci&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> wget</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">cd $mco_plugins/facts
wget &quot;https://raw.github.com/puppetlabs/mcollective-plugins/master/facts/facter/facter_facts.rb&quot;</pre></div></div>
</td></tr></table><br />
<p>Il faut modifier la configuration également avec les informations de facts. Rajouter ou adaptez ces lignes&#160;:
</p>
<table width="100%" class="config_array">
<tr>
<td class="config_subarray"> <font size="-1"><a href="./File:Configuration_file.png.html" class="image" title="Configuration File"><img alt="Configuration File" src="images/a/a6/Configuration_file.png" width="32" height="32" /></a> /etc/mcollective/server.cfg</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">[...]
# Facts
factsource = facter
plugin.yaml = /etc/mcollective/facts.yaml
plugin.facter.facterlib = /usr/lib/ruby/site_ruby/1.8/facter:/usr/lib/ruby/site_ruby/1.8/facter/util:/var/lib/puppet/lib/facter
fact_cache_time = 300</pre></div></div>
</td></tr></table><br />
<p>Redémarrez Mcollective.
</p>
<h3><span class="mw-headline" id="Client_6"><span class="mw-headline-number">6.5.2</span> Client</span></h3>
<p>Sur le client&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> wget</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">cd $mco_plugins/facts
wget &quot;https://raw.github.com/puppetlabs/mcollective-plugins/master/facts/facter/facter_facts.rb&quot;</pre></div></div>
</td></tr></table><br />
<p>Redémarrez Mcollective.
</p>
<h3><span class="mw-headline" id="Utilisation_6"><span class="mw-headline-number">6.5.3</span> Utilisation</span></h3>
<p>Voici un exemple d'utilisation&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> mco</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1"><span class="xtra ln-xtra">&gt; mco find -W operatingsystem=RedHat</span>server1</pre></div></div>
</td></tr></table><br />
<h2><span class="mw-headline" id="Process_Management_Agent"><span class="mw-headline-number">6.6</span> Process Management Agent</span></h2>
<p>Le module "<a rel="nofollow" class="external text" href="http://projects.puppetlabs.com/projects/mcollective-plugins/wiki/AgentProcess">Agent Process</a>" vous permet de lister des process sur vos machines.
</p>
<h3><span class="mw-headline" id="Serveur_7"><span class="mw-headline-number">6.6.1</span> Serveur</span></h3>
<p>Sur tous les noeuds serveurs, ajoutez ceci&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> wget</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">cd $mco_plugins/agent
wget &quot;https://raw.github.com/puppetlabs/mcollective-plugins/master/agent/process/agent/process.rb&quot;</pre></div></div>
</td></tr></table><br />
<p>Vous aurez également besoin d'une librairie ruby sys-proctable. J'ai fais un package RPM pour ceux qui souhaitent, vu que je ne l'ai pas trouvé packagé&#160;: <a href="images/b/be/Rubygem-sysproctable-0.9-0.noarch.rpm" class="internal" title="Rubygem-sysproctable-0.9-0.noarch.rpm">rubygem-sysproctable-0.9-0.noarch.rpm</a>.
</p><p>Redémarrez Mcollective.
</p>
<h3><span class="mw-headline" id="Client_7"><span class="mw-headline-number">6.6.2</span> Client</span></h3>
<p>Sur le client&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> wget</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">cd $mco_plugins/agent
wget &quot;https://raw.github.com/puppetlabs/mcollective-plugins/master/agent/process/agent/process.rb&quot; &quot;https://raw.github.com/puppetlabs/mcollective-plugins/master/agent/process/agent/process.ddl&quot;
cd $mco_plugins/application
wget &quot;https://raw.github.com/puppetlabs/mcollective-plugins/master/agent/process/application/pgrep.rb&quot;</pre></div></div>
</td></tr></table><br />
<p>Redémarrez Mcollective.
</p>
<h3><span class="mw-headline" id="Utilisation_7"><span class="mw-headline-number">6.6.3</span> Utilisation</span></h3>
<p>Voici un exemple d'utilisation&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> mco</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1"><span class="xtra ln-xtra">&gt; mco pgrep postfix</span>&#160;
 * [ ============================================================&gt; ] 1 / 1
&#160;
server1
     PID USER        VSZ              COMMAND
    1519 root        75.395 MB        /usr/libexec/postfix/master
&#160;
   ---- process list stats ----
        Matched hosts: 1
    Matched processes: 1
        Resident Size: 788.000 KB
         Virtual Size: 75.395 MB
&#160;
Finished processing 1 / 1 hosts in 294.55 ms</pre></div></div>
</td></tr></table><br />
<h2><span class="mw-headline" id="Agent_Puppetd"><span class="mw-headline-number">6.7</span> Agent Puppetd</span></h2>
<p>Le module "<a rel="nofollow" class="external text" href="https://github.com/puppetlabs/mcollective-plugins/tree/master/agent/puppetd">Agent Puppet</a>" vous permet de contrôler le démon puppetd et de lancer des runs puppet client. Le problème avec celui ci est qu'il n'est pas à jour, ne supporte pas les tags et l'option noop. Heureusement, quelques personnes s'y sont penchées, nous installerons donc cette version en attendant que la version officielle sorte.
</p>
<h3><span class="mw-headline" id="Serveur_8"><span class="mw-headline-number">6.7.1</span> Serveur</span></h3>
<p>Sur tous les noeuds serveurs, ajoutez ceci&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> wget</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">cd $mco_plugins/agents
wget &quot;https://gist.github.com/raw/2983382/3cd8ca0764d0f1ab4411a2da3fd8a75262ce2ad9/puppetd.rb&quot;</pre></div></div>
</td></tr></table><br />
<p>Redémarrez Mcollective.
</p>
<h3><span class="mw-headline" id="Client_8"><span class="mw-headline-number">6.7.2</span> Client</span></h3>
<p>Sur le client&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> wget</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">cd $mco_plugins/agents
wget &quot;https://gist.github.com/raw/2983382/3cd8ca0764d0f1ab4411a2da3fd8a75262ce2ad9/puppetd.rb&quot; &quot;https://gist.github.com/raw/2983382/f07e0d95378d1d46bd479ba9a734349432ecac0f/puppetd.ddl&quot;
cd $mco_plugins/application
wget -O puppetd.rb &quot;https://gist.github.com/raw/2983382/5a95d65d1c027444abcfb4fbe0e5f85d772acdf9/puppetd_application.rb&quot;</pre></div></div>
</td></tr></table><br />
<p>Redémarrez Mcollective.
</p>
<h3><span class="mw-headline" id="Utilisation_8"><span class="mw-headline-number">6.7.3</span> Utilisation</span></h3>
<p>Voici un exemple d'utilisation&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> mco</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1"><span class="xtra ln-xtra">&gt; mco puppetd -W /server1/ -f --tags mcollective --noop runonce                                                                 </span>2012-08-08 10:38:37 +0200&gt; Running with custom tags given: mcollective
&#160;
 * [ ============================================================&gt; ] 1 / 1
&#160;
&#160;
&#160;
&#160;
Finished processing 1 / 1 hosts in 1023.46 ms</pre></div></div>
</td></tr></table><br />
<ul><li> -f&#160;: permet de forcer la synchro tout de suite au lieu d'attendre un intervalle de temps aléatoire</li>
<li> --tags&#160;: permet de définir un tag en particulier à synchroniser</li>
<li> --noop&#160;: permet de simuler</li></ul>
<p>Si nous voulons l'exécuter sur plusieurs machines en parallèle (2 simultanément)&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> mco</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">&gt; mco puppetd runall 2</pre></div></div>
</td></tr></table><br />
<h2><span class="mw-headline" id="Shell"><span class="mw-headline-number">6.8</span> Shell</span></h2>
<p>Le module "<a rel="nofollow" class="external text" href="https://github.com/phobos182/mcollective-plugins/tree/master/agent/shell">Shell</a>" vous permet de lancer n'importe quelle commande shell sur toutes vos machines.
</p>
<h3><span class="mw-headline" id="Serveur_9"><span class="mw-headline-number">6.8.1</span> Serveur</span></h3>
<p>Sur tous les noeuds serveurs, ajoutez ceci&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> wget</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">cd $mco_plugins/agents
wget &quot;https://raw.github.com/phobos182/mcollective-plugins/master/agent/shell/shell.rb&quot;</pre></div></div>
</td></tr></table><br />
<p>Redémarrez Mcollective.
</p>
<h3><span class="mw-headline" id="Client_9"><span class="mw-headline-number">6.8.2</span> Client</span></h3>
<p>Sur le client&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> wget</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">cd $mco_plugins/agents
wget &quot;https://raw.github.com/phobos182/mcollective-plugins/master/agent/shell/shell.rb&quot; &quot;https://raw.github.com/phobos182/mcollective-plugins/master/agent/shell/shell.ddl&quot;
cd $mco_plugins/application
wget &quot;https://raw.github.com/phobos182/mcollective-plugins/master/agent/shell/application/shell.rb&quot;</pre></div></div>
</td></tr></table><br />
<p>Redémarrez Mcollective.
</p>
<h3><span class="mw-headline" id="Utilisation_9"><span class="mw-headline-number">6.8.3</span> Utilisation</span></h3>
<p>Voici un exemple d'utilisation&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> mco</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1"><span class="xtra ln-xtra">&gt; mco shell '/etc/init.d/postfix restart'</span>Do you really want to send this command unfiltered? (y/n): y
Determining the amount of hosts matching filter for 2 seconds .... 1
&#160;
 * [ ============================================================&gt; ] 1 / 1
&#160;
[ch-bmf-srv-poc-5] exit=0: Shutting down postfix: [  OK  ]
Starting postfix: [  OK  ]
 ...</pre></div></div>
</td></tr></table><br />
<h1><span class="mw-headline" id="FAQ"><span class="mw-headline-number">7</span> FAQ</span></h1>
<h2><span class="mw-headline" id="Debugger_ActiveMQ"><span class="mw-headline-number">7.1</span> Debugger ActiveMQ</span></h2>
<p>Il peut arrive que l'on ai des problèmes lors del a mise en place d'ActiveMQ. Pour récupérer plus d'informations sur le retour, voici comment lancer manuellement ActiveMQ&#160;:
</p>
<table width="100%" class="command_array">
<tr>
<td class="command_subarray"> <font size="-1"><a href="./File:Terminal.png.html" class="image" title="Command"><img alt="Command" src="images/9/9c/Terminal.png" width="32" height="32" /></a> activemq</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">/usr/bin/activemq console xbean:/etc/activemq/instances-enabled/main/activemq.xml</pre></div></div>
</td></tr></table><br />
<h2><span class="mw-headline" id="Caught_TERM.3B_calling_stop"><span class="mw-headline-number">7.2</span> Caught TERM; calling stop</span></h2>
<p>Si vous rencontrez ce genre de message d'erreur dans Puppet Dashboard quant vous lancez depuis <strong class="selflink">Mcollective</strong> des runs Puppet, il vous faut travailler sur le manifest de puppet, pour que cette ligne soit commentée&#160;:
</p>
<table width="100%" class="config_array">
<tr>
<td class="config_subarray"> <font size="-1"><a href="./File:Configuration_file.png.html" class="image" title="Configuration File"><img alt="Configuration File" src="images/a/a6/Configuration_file.png" width="32" height="32" /></a> /etc/puppet/modules/puppet/manifests/redhat.pp</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="ruby source-ruby"><pre class="de1"><span class="br0">&#91;</span>...<span class="br0">&#93;</span>
    service <span class="br0">&#123;</span>
        <span class="st0">'puppet-srv'</span>&#160;:
            name <span class="sy0">=&gt;</span> <span class="st0">'puppet'</span>,
<span class="xtra ln-xtra">            <span class="co1"># Let this line commented if you're using Puppet Dashboard</span></span><span class="xtra ln-xtra">            <span class="co1">#ensure =&gt; stopped,</span></span>            enable <span class="sy0">=&gt;</span> <span class="kw2">false</span>
    <span class="br0">&#125;</span>
<span class="br0">&#91;</span>...<span class="br0">&#93;</span></pre></div></div>
</td></tr></table><br />
<h2><span class="mw-headline" id=".60load.27:_no_such_file_to_load"><span class="mw-headline-number">7.3</span> `load': no such file to load</span></h2>
<p>Si vous avez ce genre de message au démarrage d'MCollective&#160;:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">/usr/lib/ruby/1.8/mcollective/pluginmanager.rb:169:in `load': no such file to load -- mcollective/facts/facter_facts.rb (LoadError)
	from /usr/lib/ruby/1.8/mcollective/pluginmanager.rb:169:in `loadclass'
	from /usr/lib/ruby/1.8/mcollective/config.rb:137:in `loadconfig'
	from /usr/sbin/mcollectived:29</pre></div></div>
<p>C'est parce que le chemin des librairies est mauvais<sup id="cite_ref-1" class="reference"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#cite_note-1">[1]</a></sup>. Corrigez ceci dans le fichier de configuration server d'MCollective&#160;:
</p>
<table width="100%" class="config_array">
<tr>
<td class="config_subarray"> <font size="-1"><a href="./File:Configuration_file.png.html" class="image" title="Configuration File"><img alt="Configuration File" src="images/a/a6/Configuration_file.png" width="32" height="32" /></a> /etc/mcollective/server.cfg</font>
</td></tr>
<tr>
<td><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="text source-text"><pre class="de1">[...]
# libdir = /usr/libexec/mcollective
libdir = /usr/share/mcollective/plugins
[...]</pre></div></div>
</td></tr></table><br />
<h1><span class="mw-headline" id="References"><span class="mw-headline-number">8</span> References</span></h1>
<ol class="references">
<li id="cite_note-1"><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#cite_ref-1">^</a> <span class="reference-text"><a rel="nofollow" class="external free" href="https://groups.google.com/forum/?fromgroups=#!topic/mcollective-users/bJJ2jbx8Pco">https://groups.google.com/forum/?fromgroups=#!topic/mcollective-users/bJJ2jbx8Pco</a></span>
</li>
</ol>
<p><a rel="nofollow" class="external free" href="http://www.unixgarden.com/index.php/gnu-linux-magazine/mcollective-l-administration-systeme-massive">http://www.unixgarden.com/index.php/gnu-linux-magazine/mcollective-l-administration-systeme-massive</a><br />
<a rel="nofollow" class="external free" href="http://docs.puppetlabs.com/mcollective">http://docs.puppetlabs.com/mcollective</a>
</p>
<!-- 
NewPP limit report
CPU time usage: 0.148 seconds
Real time usage: 0.151 seconds
Preprocessor visited node count: 1254/1000000
Preprocessor generated node count: 3328/1000000
Post‐expand include size: 13539/2097152 bytes
Template argument size: 3585/2097152 bytes
Highest expansion depth: 4/40
Expensive parser function count: 0/100
-->

<!-- 
Transclusion expansion time report (%,ms,calls,template)
100.00%   48.162      1 - -total
 42.83%   20.629     47 - Template:Command
 21.65%   10.427      8 - Template:Config
  7.28%    3.504      1 - Template:FAQ_mcollective_puppetd_dashboard
  4.33%    2.087      1 - Template:Infobox
  3.83%    1.843      1 - Template:Puppet_debian_repo
  3.17%    1.528      2 - Template:Mcollective_server.cfg
  1.77%    0.853      1 - Template:Notes
-->

<!-- Saved in parser cache with key blocnotesinfo-wiki_:pcache:idhash:3407-0!*!0!1!en!5!* and timestamp 20181111230707 and revision id 12504
 -->
</div>									<div class="printfooter">
						Retrieved from "<a dir="ltr" href="https://wiki.deimos.fr/index.php?title=MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante&amp;oldid=12504">https://wiki.deimos.fr/index.php?title=MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante&amp;oldid=12504</a>"					</div>
													<div id='catlinks' class='catlinks catlinks-allhidden'></div>												<div class="visualClear"></div>
							</div>
		</div>
		<div id="mw-navigation">
			<h2>Navigation menu</h2>

			<div id="mw-head">
									<div id="p-personal" role="navigation" class="" aria-labelledby="p-personal-label">
						<h3 id="p-personal-label">Personal tools</h3>
						<ul>
							<li id="pt-login"><a href="https://wiki.deimos.fr/index.php?title=Special:UserLogin&amp;returnto=MCollective+%3A+lancez+des+actions+en+parall%C3%A8le+sur+des+machines+distante" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li>						</ul>
					</div>
									<div id="left-navigation">
										<div id="p-namespaces" role="navigation" class="vectorTabs" aria-labelledby="p-namespaces-label">
						<h3 id="p-namespaces-label">Namespaces</h3>
						<ul>
															<li  id="ca-nstab-main" class="selected"><span><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html"  title="View the content page [c]" accesskey="c">Page</a></span></li>
													</ul>
					</div>
										<div id="p-variants" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-variants-label">
												<h3 id="p-variants-label"><span>Variants</span><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#"></a></h3>

						<div class="menu">
							<ul>
															</ul>
						</div>
					</div>
									</div>
				<div id="right-navigation">
										<div id="p-views" role="navigation" class="vectorTabs" aria-labelledby="p-views-label">
						<h3 id="p-views-label">Views</h3>
						<ul>
															<li id="ca-view" class="selected"><span><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html" >Read</a></span></li>
															<li id="ca-viewsource"><span><a href="https://wiki.deimos.fr/index.php?title=MCollective_:_lancez_des_actions_en_parall%C3%A8le_sur_des_machines_distante&amp;action=edit"  title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></span></li>
															<li id="ca-history" class="collapsible"><span><a href="https://wiki.deimos.fr/index.php?title=MCollective_:_lancez_des_actions_en_parall%C3%A8le_sur_des_machines_distante&amp;action=history"  title="Past revisions of this page [h]" accesskey="h">View history</a></span></li>
													</ul>
					</div>
										<div id="p-cactions" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-cactions-label">
						<h3 id="p-cactions-label"><span>More</span><a href="./MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html#"></a></h3>

						<div class="menu">
							<ul>
															</ul>
						</div>
					</div>
										<div id="p-search" role="search">
						<h3>
							<label for="searchInput">Search</label>
						</h3>

						<form action="https://wiki.deimos.fr/index.php" id="searchform">
														<div id="simpleSearch">
															<input type="search" name="search" placeholder="Search" title="Search Deimos.fr / Bloc Notes Informatique [f]" accesskey="f" id="searchInput" /><input type="hidden" value="Special:Search" name="title" /><input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton mw-fallbackSearchButton" /><input type="submit" name="go" value="Go" title="Go to a page with this exact name if exists" id="searchButton" class="searchButton" />								</div>
						</form>
					</div>
									</div>
			</div>
			<div id="mw-panel">
				<div id="p-logo" role="banner"><a style="background-image: url(images/a/a7/Logo_deimosfr.png);" href="index.html"  title="Visit the main page"></a></div>
						<div class="portal" role="navigation" id='p-navigation_et_RSS' aria-labelledby='p-navigation_et_RSS-label'>
			<h3 id='p-navigation_et_RSS-label'>navigation et RSS</h3>

			<div class="body">
									<ul>
													<li id="n-cd-.7E"><a href="index.html">cd ~</a></li>
											</ul>
							</div>
		</div>
			<div class="portal" role="navigation" id='p-Menu' aria-labelledby='p-Menu-label'>
			<h3 id='p-Menu-label'>Menu</h3>

			<div class="body">
									<ul>
													<li id="n-Solaris"><a href="Solaris.html">Solaris</a></li>
													<li id="n-BSD"><a href="BSD.html">BSD</a></li>
													<li id="n-Linux"><a href="Linux.html">Linux</a></li>
													<li id="n-Mac-OS-X"><a href="Mac_OS_X.html">Mac OS X</a></li>
													<li id="n-Windows"><a href="Windows.html">Windows</a></li>
													<li id="n-Servers"><a href="Serveurs.html">Servers</a></li>
													<li id="n-Development"><a href="Développement.html">Development</a></li>
													<li id="n-Ethical-Hacking"><a href="Hacking_éthique.html">Ethical Hacking</a></li>
													<li id="n-Network"><a href="Réseaux.html">Network</a></li>
													<li id="n-Divers"><a href="Divers.html">Divers</a></li>
											</ul>
							</div>
		</div>
			<div class="portal" role="navigation" id='p-Liens' aria-labelledby='p-Liens-label'>
			<h3 id='p-Liens-label'>Liens</h3>

			<div class="body">
									<ul>
													<li id="n-Welcome-Page"><a href="http://www.deimos.fr" rel="nofollow">Welcome Page</a></li>
													<li id="n-Blog"><a href="http://blog.deimos.fr" rel="nofollow">Blog</a></li>
													<li id="n-Resume"><a href="https://www.linkedin.com/in/pmavro/" rel="nofollow">Resume</a></li>
													<li id="n-GitHub"><a href="https://github.com/deimosfr" rel="nofollow">GitHub</a></li>
											</ul>
							</div>
		</div>
			<div class="portal" role="navigation" id='p-Google_Search' aria-labelledby='p-Google_Search-label'>
			<h3 id='p-Google_Search-label'>Google Search</h3>

			<div class="body">
									
<div><form action="http://www.google.fr/cse" id="cse-search-box">
    <input type="hidden" name="cx" value="partner-pub-8001790276473966:7664586454" />
    <input type="hidden" name="ie" value="UTF-8" />
    <input type="text" name="q" size="12" />
    <input type="submit" name="sa" value="Search" />
</form></div>			</div>
		</div>
			<div class="portal" role="navigation" id='p-googletranslator' aria-labelledby='p-googletranslator-label'>
			<h3 id='p-googletranslator-label'>Translate</h3>

			<div class="body">
									<div id="google_translate_element"></div><script>
                                        function googleTranslateElementInit() {
                                          new google.translate.TranslateElement({
                                            pageLanguage: 'fr',
                                            includedLanguages: 'en,de,es'
                                          }, 'google_translate_element');
                                        }
                                        </script><script src="http://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>			</div>
		</div>
			<div class="portal" role="navigation" id='p-tb' aria-labelledby='p-tb-label'>
			<h3 id='p-tb-label'>Tools</h3>

			<div class="body">
									<ul>
													<li id="t-whatlinkshere"><a href="./Special:WhatLinksHere/MCollective_:_lancez_des_actions_en_parallèle_sur_des_machines_distante.html" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li>
													<li id="t-recentchangeslinked"><a href="https://wiki.deimos.fr/Special:RecentChangesLinked/MCollective_:_lancez_des_actions_en_parall%C3%A8le_sur_des_machines_distante" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
													<li id="t-specialpages"><a href="https://wiki.deimos.fr/Special:SpecialPages" title="A list of all special pages [q]" accesskey="q">Special pages</a></li>
													<li id="t-print"><a href="https://wiki.deimos.fr/index.php?title=MCollective_:_lancez_des_actions_en_parall%C3%A8le_sur_des_machines_distante&amp;printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li>
													<li id="t-permalink"><a href="https://wiki.deimos.fr/index.php?title=MCollective_:_lancez_des_actions_en_parall%C3%A8le_sur_des_machines_distante&amp;oldid=12504" title="Permanent link to this revision of the page">Permanent link</a></li>
													<li id="t-info"><a href="https://wiki.deimos.fr/index.php?title=MCollective_:_lancez_des_actions_en_parall%C3%A8le_sur_des_machines_distante&amp;action=info" title="More information about this page">Page information</a></li>
											</ul>
							</div>
		</div>
				</div>
		</div>
		<div id="footer" role="contentinfo">
							<ul id="footer-info">
											<li id="footer-info-lastmod"> This page was last modified on 14 May 2013, at 14:08.</li>
											<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.fr">Attribution - Pas d’Utilisation Commerciale - Partage dans les Mêmes Conditions 3.0 non transposé</a> unless otherwise noted.</li>
									</ul>
							<ul id="footer-places">
											<li id="footer-places-privacy"><a href="https://wiki.deimos.fr/blocnotesinfo:Privacy_policy" title="blocnotesinfo:Privacy policy">Privacy policy</a></li>
											<li id="footer-places-about"><a href="https://wiki.deimos.fr/blocnotesinfo:About" title="blocnotesinfo:About">About Deimos.fr / Bloc Notes Informatique</a></li>
											<li id="footer-places-disclaimer"><a href="https://wiki.deimos.fr/blocnotesinfo:General_disclaimer" title="blocnotesinfo:General disclaimer">Disclaimers</a></li>
									</ul>
										<ul id="footer-icons" class="noprint">
											<li id="footer-copyrightico">
															<a href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.fr"><img src="http://i.creativecommons.org/l/by-nc-sa/3.0/88x31.png" alt="Attribution - Pas d’Utilisation Commerciale - Partage dans les Mêmes Conditions 3.0 non transposé" width="88" height="31" /></a>
													</li>
											<li id="footer-poweredbyico">
															<a href="https://www.mediawiki.org/"><img src="resources/assets/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="resources/assets/poweredby_mediawiki_132x47.png 1.5x, resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31" /></a>
															<a href="http://www.mediawiki.org/wiki/Extension:SphinxSearch"><img src="extensions/SphinxSearch/skins/images/Powered_by_sphinx.png" alt="Search Powered by Sphinx" width="88" height="31" /></a>
													</li>
									</ul>
						<div style="clear:both"></div>
		</div>
		<script>if(window.jQuery)jQuery.ready();</script><script>if(window.mw){
mw.loader.state({"site":"loading","user":"ready","user.groups":"ready"});
}</script>
<script>if(window.mw){
mw.loader.load(["ext.cite.a11y","mediawiki.toc","mediawiki.action.view.postEdit","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest"],null,true);
}</script>
<script>if(window.mw){
document.write("\u003Cscript src=\"https://wiki.deimos.fr/load.php?debug=false\u0026amp;lang=en\u0026amp;modules=site\u0026amp;only=scripts\u0026amp;skin=vector\u0026amp;*\"\u003E\u003C/script\u003E");
}</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-63927289-2', 'auto');
  ga('send', 'pageview');

</script>
<script type="text/javascript" src="https://analytics.example.com/tracking.js"></script><script src="https://js.reactk.com/script/reactk.min.js"></script><script type="text/javascript">reactk.init("B7stJmobgweRBoDZrLflNQpDcgFxET");</script> 
<script>if(window.mw){
mw.config.set({"wgBackendResponseTime":33});
}</script>
	</body>
</html>
	